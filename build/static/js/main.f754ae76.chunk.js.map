{"version":3,"sources":["styles/layout.module.css","constants/Colors.js","constants/images/loading-circle.gif","components/LoadingCircle/LoadingCircleStyles.js","components/LoadingCircle/LoadingCircle.js","store/actions/selectedSongActions.js","store/actions/authActions.js","util.js","store/actions/songsActions.js","components/Button/Button.js","screens/Auth/Auth.js","screens/ConfirmEmail/ConfirmEmail.js","components/DropMenu/DropMenu.js","components/LogoutButton/LogoutButton.js","components/Options/Options.js","components/CustomSlider/CustomSlider.js","components/AutoScroll/AutoScroll.js","components/NavContent/NavContent.js","components/CustomSideBar/CustomSidebar.js","components/Error/Error.js","screens/Help/Help.js","screens/Home/Home.js","constants/images/menu.png","components/MenuBar/MenuBar.js","components/NavBar/NavBar.js","components/SongBlock/SongBlock.js","components/SearchBar/SearchBar.js","screens/PublicList/PublicList.js","screens/PasswordReset/PasswordReset.js","screens/PasswordChange/PasswordChange.js","components/CapitalText/CapitalText.js","components/TextArea/TextArea.js","screens/Profile/Profile.js","components/AddSongButton/AddSongButton.js","screens/SongList/SongList.js","store/actions/commentActions.js","components/NewComment/NewComment.js","components/CommentsBlock/CommentsBlock.js","components/Comments/Comments.js","components/SideBarWrapper/SideBarWrapper.js","components/CopyButton/CopyButton.js","components/HelpButton/HelpButton.js","components/InfoBar/InfoBar.js","components/LyricsBlock/LyricsBlock.js","components/PulledLyricsBlock/PulledLyricsBlock.js","components/SaveBar/SaveBar.js","components/StrummingPatternBlock/StrummingPatternBlock.js","screens/Song/Song.js","components/Router/Router.js","store/reducers/songsReducer.js","store/reducers/selectedSongReducer.js","store/reducers/authReducer.js","store/reducers/commentReducers.js","store/store.js","App.js","index.js","components/NavContent/NavContent.module.css","components/SongBlock/SongBlock.module.css","screens/Auth/Auth.module.css","styles/ui.module.css","components/CommentsBlock/CommentsBlock.module.css","screens/Help/Help.module.css","screens/Profile/Profile.module.css","components/DropMenu/DropMenu.module.css","screens/PasswordChange/PasswordChange.module.css","components/LyricsBlock/LyricsBlock.module.css","components/LogoutButton/LogoutButton.module.css","components/MenuBar/MenuBar.module.css","screens/PasswordReset/PasswordReset.module.css","components/NewComment/NewComment.module.css","components/Button/ButtonStyle.module.css","components/SearchBar/SearchBar.module.css","components/CapitalText/CapitalText.module.css","components/TextArea/TextArea.module.css","components/InfoBar/InfoBar.module.css","screens/Song/Song.module.css"],"names":["module","exports","Colors","styles","container","position","fontSize","top","left","transform","image","width","LoadingCircle","style","src","loadingCircle","alt","SET_FETCHING","SET_IS_SONG_PAGE","SET_IS_SONG_PAGE_VIEW","SET_SONG_LINK","setFetching","value","type","setIsSongPage","setIsSongPageView","setSongLink","link","SET_USERNAME","SET_ADMIN","setUsername","username","setAdmin","admin","cookie","Cookie","getToken","cookieValue","name","document","cookies","split","i","length","trim","substring","decodeURIComponent","getUsername","a","existingUsername","get","axios","withCredentials","response","data","set","path","getEmail","existingEmail","alert","sortSongsById","list","sort","b","id","updateSongAttributeToDatabase","patch","headers","sz","obj","Object","keys","compareSongsByValue","song1","song2","item","getActivationStatus","console","log","confirmed_email","activated","incrementViewCount","post","songId","ADD_SONG","GET_USER_SONGS","GET_PUBLIC_SONGS","DELETE_SONG","UPDATE_SONG","REPLACE_SONG","SET_FILTERED_PUBLIC_SONGS","SET_FILTERED_USER_SONGS","SET_VIEWS","INCREMENT_VIEW","getUserSongs","dispatch","userSongs","addSong","song","localStorage","removeItem","deleteSong","delete","updateSong","updateType","setFilteredPublicSongs","songs","setFilteredUserSongs","setViews","views","incrementView","Button","props","className","onClick","btn","children","Auth","useState","email","setEmail","password","setPassword","repeatedPassword","setRepeatedPassword","login","setLogin","isLoading","setIsLoading","useDispatch","history","useHistory","event","preventDefault","state","indexOf","queriedUsername","queriedEmail","queriedAdmin","is_superuser","queriedActivated","authActions","songsActions","push","message","layout","ui","title","label","htmlFor","field","onChange","e","target","replace","pointer","ConfirmEmail","determiningActivated","setDeterminingActivated","useEffect","emailQuery","activationHandler","subtitle","emphasis","err","defaults","xsrfCookieName","xsrfHeaderName","DropMenu","menuOpen","setMenuOpen","relative","onMouseEnter","onMouseLeave","option","items","map","idx","condition","white","text","menuOption","LogoutButton","useSelector","auth","isLoggingOut","setIsLoggingOut","profileRedirectHandler","logoutHandler","remove","content","full","design","Options","isSongPage","selectedSong","songLink","find","getLyrics","selectedSongActions","pulledLyrics","errorText","lyrics","pulled_lyrics","transferLyricsHandler","theme","createMuiTheme","overrides","MuiSlider","thumb","color","track","rail","CustomSlider","existingValue","onChangeCommitted","ThemeProvider","Slider","defaultValue","step","marks","min","max","AutoScroll","scrollTimeout","useRef","scrollSpeed","pageScroll","window","scrollBy","current","setTimeout","Math","sqrt","clearTimeoutHandler","clearTimeout","removeEventListener","_","val","addEventListener","NavContent","isAdmin","isSongPageView","containerStyle","direction","leftDivStyle","linkStyle","loginStyle","to","view","CustomSideBar","sidebar","open","onSetOpen","changeSidebar","SongPage","Help","border","italic","href","Home","MenuBar","onMenuClick","NavBar","SongBlock","location","pathname","nameRef","createRef","artistRef","redirectHandler","artist","editable","creator","inputBlur","choice","preventEnterHandler","key","blur","Star","starProps","is_favourite","Eye","eyeProps","public","inputKwargs","readOnly","eye","placeholder","onBlur","onKeyDown","ref","arrow","SearchBar","setOpen","searchText","setSearchText","filterFunction","publicSongs","songList","unlisten","listen","resetFilter","searchButtonHandler","result","FuzzySearch","caseSensitive","search","filterList","input","PublicList","filteredPublicSongs","database","ids","kwargs","PasswordReset","resetHandler","button","PasswordChange","retypedPassword","changePasswordHandler","params","match","uid","token","pswd","retypedPswd","CapitalText","toUpperCase","TextArea","noLines","rows","lineCount","maxLength","refName","Profile","realUsername","songCount","setSongCount","active","setActive","about","setAbout","imgUrl","setImgUrl","aboutRef","url","getImage","getAbout","getItem","cnt","setItem","getCount","submitHandler","inputAbout","imageChangeHandler","files","size","validExtensions","nameArray","extension","toLowerCase","formData","FormData","append","dir","menuButton","picture","class","AddSongButton","isAdding","setIsAdding","actions","SongList","isFavourites","setIsFavourites","all","filteredSongs","filteredUserSongs","filter","getSongList","ADD_COMMENTS","DELETE_COMMENT","EDIT_COMMENT","addComment","contents","parent","user","comment","comments","NewComment","heading","cancelHandler","CommentsBlock","editMode","setEditMode","replying","setReplying","editableRef","replyRef","commentUsername","date_of_creation","edited","nestedComments","grow","dateOfCreation","Date","currentDate","msDif","getDate","hourDif","minuteDif","round","dayDif","monthDif","getFullYear","getMonth","dateConverter","commentActions","trash","time","Comments","newCommentRef","newCommentHandler","SideBarWrapper","closeSidebarTimer","clearInterval","Component","WrappedComponent","backgroundColor","iconStyle","setInterval","CopyButton","isCopyMode","setIsCopyMode","IoIosCopy","SaveBar","BiHelpCircle","InfoBar","newSong","LyricsBlock","lastClicked","setLastClicked","clickedChords","setClickedChords","pasteMode","setPasteMode","chordRefs","setChordRefs","lyricRefs","setLyricRefs","arrLength","newRefs","Array","fill","setUnsavedChanges","substr","lyricsBlurHandler","innerText","addToList","selectHandler","altKey","selectMultipleHandler","sortedChords","start","range","chordRefsCopy","newId","copyFrom","copyTo","undefined","multiple","shouldBreak","bottomOption","chordStyles","chords","autoCorrect","contentEditable","suppressContentEditableWarning","spellCheck","PulledLyricsBlock","pulledLyricsRef","AiOutlineSave","StrummingPatternBlock","strummingPatternRef","strumming_pattern","Song","stateReceived","hasUnsavedChanges","isViewOnly","isFetching","originalSong","databaseCall","unblock","block","ogSong","confirm","componentCleanup","useCallback","returnValue","linkUsername","validateUsername","songExists","editableKwargs","containerStyles","newLyrics","newChords","len","newName","newArtist","newStrummingPattern","newPulledLyrics","songCopy","updateSongToDatabase","Router","menuClickHandler","queryUsername","updateRedux","URL","Body","exact","component","ErrorScreen","horizontal","initialStore","store","action","sortByViews","concat","updatedSong","updatedUserSongs","updatedFilteredUserSongs","updatedPublicSongs","updatedFilteredPublicSongs","sortedSongs","sortedFilteredSongs","newViews","newPublicSongs","newFilteredPublicSongs","flatComments","nestComments","commentListOriginal","commentMap","commentList","forEach","deleteHelper","flatList","rootId","q","toRemove","pop","rootReducer","combineReducers","songsReducer","filteredFlatComments","filteredComments","newComment","newFlatComments","newComments","persistConfig","storage","stateReconciler","autoMergeLevel1","blacklist","pReducer","persistReducer","createStore","applyMiddleware","thunk","persistor","persistStore","App","matchMedia","matches","orientation","setOrientation","iconSize","screen","height","iconValues","cursor","loading","Provider","ReactDOM","render","getElementById"],"mappings":"wFACAA,EAAOC,QAAU,CAAC,kBAAkB,gCAAgC,mBAAmB,iCAAiC,oBAAoB,kCAAkC,2BAA2B,yCAAyC,qBAAqB,mCAAmC,oBAAoB,kCAAkC,qBAAqB,mCAAmC,iBAAiB,+BAA+B,eAAe,6BAA6B,oBAAoB,kCAAkC,SAAW,yBAAyB,YAAY,0BAA0B,YAAY,0BAA0B,UAAY,0BAA0B,aAAa,6B,iHCDhsBC,EACH,UADGA,EAEE,UAFFA,EAGN,UAHMA,EAIJ,UAJIA,EAMF,UCNI,MAA0B,2CCA5BC,EAAS,CACrBC,UAAW,CACVC,SAAU,QACVC,SAAU,GACVC,IAAK,OACLC,KAAM,OACNC,UAAW,yBAEZC,MAAO,CACNC,MAAO,K,OCJM,SAASC,IACvB,OACC,qBAAKC,MAAOV,EAAOC,UAAnB,SACC,qBAAKU,IAAKC,EAAeC,IAAI,iBAAiBH,MAAOV,EAAOO,U,mCCRlDO,EAAe,eACfC,EAAmB,mBACnBC,EAAwB,wBACxBC,EAAgB,gBAGtB,SAASC,EAAYC,GAC3B,MAAO,CACNC,KAAMN,EACNK,MAAOA,GAKF,SAASE,EAAcF,GAC7B,MAAO,CACNC,KAAML,EACNI,MAAOA,GAKF,SAASG,EAAkBH,GACjC,MAAO,CACNC,KAAMJ,EACNG,MAAOA,GAKF,SAASI,EAAYC,GAC3B,MAAO,CACNJ,KAAMH,EACNO,KAAMA,GCjCD,IAAMC,EAAe,eACfC,EAAY,YAElB,SAASC,EAAYC,GAC3B,MAAO,CACNR,KAAMK,EACNG,SAAUA,GAIL,SAASC,EAASC,GAExB,MAAO,CACNV,KAAMM,EACNI,MAHqB,OAAVA,EAAiB,MAAkB,IAAVA,GAA4B,SAAVA,G,4CCRlDC,EAAS,IAAIC,IAGZ,SAASC,IACf,IAAIC,EAAc,KACZC,EAAO,YAEb,GAAIC,SAASL,QAA8B,KAApBK,SAASL,OAE/B,IADA,IAAMM,EAAUD,SAASL,OAAOO,MAAM,KAC7BC,EAAI,EAAGA,EAAIF,EAAQG,OAAQD,IAAK,CACxC,IAAMR,EAASM,EAAQE,GAAGE,OAC1B,GAAIV,EAAOW,UAAU,EAAGP,EAAKK,OAAS,KAAOL,EAAO,IAAK,CACxDD,EAAcS,mBACbZ,EAAOW,UAAUP,EAAKK,OAAS,IAEhC,OAIH,OAAON,EAID,SAAeU,IAAtB,+B,4CAAO,gCAAAC,EAAA,oEAGCC,EAAmBf,EAAOgB,IAAI,aAH/B,yCAKGD,GALH,uBASkBE,IAAMD,IAAI,iBAAkB,CAClDE,iBAAiB,IAVb,cASCC,EATD,OAYCtB,EAAWsB,EAASC,KAAKvB,SAC/BG,EAAOqB,IAAI,WAAYxB,EAAU,CAAEyB,KAAM,MAbpC,kBAeEzB,GAfF,2DAiBE,MAjBF,2D,sBAqBA,SAAe0B,IAAtB,+B,4CAAO,8BAAAT,EAAA,oEAGCU,EAAgBxB,EAAOgB,IAAI,UAH5B,yCAKGQ,GALH,uBASkBP,IAAMD,IAAI,kBAAmB,CACnDE,iBAAiB,IAVb,cASCC,EATD,OAYLnB,EAAOqB,IAAI,QAASF,EAASC,KAAM,CAAEE,KAAM,MAZtC,kBAcEH,EAASC,MAdX,yCAgBLK,MACC,gGAjBI,kBAoBE,MApBF,2D,sBAyBA,SAASC,EAAcC,GAC7BA,EAAKC,MAAK,SAACd,EAAGe,GAAJ,OAAUf,EAAEgB,GAAKD,EAAEC,MAgBvB,SAASC,EAA8BD,EAAIzC,EAAMD,GACvD6B,IAAMe,MAAN,qBACeF,EADf,oBAGGzC,EAAOD,GAET,CACC8B,iBAAiB,EACjBe,QAAS,CACR,eAAgB,mBAChB,cAAe/B,OAOnB,SAASgC,EAAGC,GACX,OAAOC,OAAOC,KAAKF,GAAK1B,OAIlB,SAAS6B,EAAoBC,EAAOC,GAC1C,IAAKD,IAAUC,EACd,OAAO,EAER,GAAIN,EAAGK,KAAWL,EAAGM,GACpB,OAAO,EAER,IAAK,IAAMC,KAAQF,EAElB,GAAa,SAATE,GAA4B,WAATA,GAA8B,UAATA,GAA6B,WAATA,GAG5DF,EAAME,KAAUD,EAAMC,GACzB,OAAO,EAGT,OAAO,EAID,SAAeC,IAAtB,+B,4CAAO,0CAAA5B,EAAA,2FACed,EAAOgB,IAAI,aAD1B,yCAE8B,SAA5BhB,EAAOgB,IAAI,cAFb,gCAMkBC,IAAMD,IAAI,iBAAkB,CAClDE,iBAAiB,IAPb,cAMCC,EAND,OASLwB,QAAQC,IAAIzB,EAASC,KAAKyB,iBACpBC,EAAY3B,EAASC,KAAKyB,gBAChC7C,EAAOqB,IAAI,YAAayB,EAAW,CAAExB,KAAM,MAXtC,kBAaEwB,GAbF,wG,sBAoBA,SAAeC,EAAtB,mC,8CAAO,WAAkCjB,GAAlC,SAAAhB,EAAA,+EAECG,IAAM+B,KACX,uBACA,CACCC,OAAQnB,GAET,CACCZ,iBAAiB,EACjBe,QAAS,CACR,eAAgB,mBAChB,cAAe/B,OAXb,0H,sBCpJA,IAAMgD,GAAW,WACXC,GAAiB,iBACjBC,GAAmB,mBACnBC,GAAc,cACdC,GAAc,cACdC,GAAe,eACfC,GAA4B,4BAC5BC,GAA0B,0BAC1BC,GAAY,YACZC,GAAiB,iBA8BvB,SAASC,KACf,8CAAO,WAAOC,GAAP,iBAAA/C,EAAA,+EAEkBG,IAAMD,IAAI,cAAe,CAC/CE,iBAAiB,IAHb,OAECC,EAFD,OAOLO,EADMoC,EAAY3C,EAASC,MAG3ByC,EAAS,CACRxE,KAAM8D,GACNW,UAAWA,IAXP,sDAcLrC,MAAM,0CAdD,8DAAP,sDAuCM,SAASsC,GAAQlE,GACvB,8CAAO,WAAOgE,GAAP,eAAA/C,EAAA,+EAEkBG,IAAM+B,KAC5B,cACA,GACA,CACC9B,iBAAiB,EACjBe,QAAS,CACR,cAAe/B,OARb,OAECiB,EAFD,OAaL0C,EAAS,CACRxE,KAAM6D,GACNc,KAAM7C,EAASC,OAGhB6C,aAAaC,WAAWrE,GAlBnB,sDAoBL4B,MAAM,uBApBD,8DAAP,sDA0BM,SAAS0C,GAAWrC,GAC1B,8CAAO,WAAO+B,GAAP,SAAA/C,EAAA,+DAEL+C,EAAS,CACRxE,KAAMgE,GACNvB,GAAIA,IAGLb,IAAMmD,OAAN,qBAA2BtC,EAA3B,KAAkC,CACjCZ,iBAAiB,EACjBe,QAAS,CACR,cAAe/B,OAVZ,qDAcLuB,MAAM,yCAdD,6DAAP,sDAoBM,SAAS4C,GAAWvC,EAAIzC,EAAMD,GACpC,MAAO,CACNC,KAAMiE,GACNxB,GAAIA,EACJwC,WAAYjF,EACZD,MAAOA,GAYF,SAASmF,GAAuBC,GACtC,MAAO,CACNnF,KAAMmE,GACNgB,MAAOA,GAIF,SAASC,GAAqBD,GACpC,MAAO,CACNnF,KAAMoE,GACNe,MAAOA,GAIF,SAASE,GAASC,GACxB,MAAO,CACNtF,KAAMqE,GACNiB,MAAOA,GAIF,SAASC,GAAc9C,GAC7B,MAAO,CACNzC,KAAMsE,GACN7B,GAAIA,G,wBCvKS,SAAS+C,GAAOC,GAAQ,IAC9BC,EAAcD,EAAdC,UAER,OACC,wBAAQC,QAASF,EAAME,QAASD,UAAS,UAAK9G,KAAOgH,IAAZ,YAAmBF,GAA5D,SACED,EAAMI,W,+DCMJlF,GAAS,IAAIC,IAKJ,SAASkF,KAAQ,IAAD,EACEC,mBAAS,IADX,mBACvBvF,EADuB,KACbD,EADa,OAEJwF,mBAAS,IAFL,mBAEvBC,EAFuB,KAEhBC,EAFgB,OAGEF,mBAAS,IAHX,mBAGvBG,EAHuB,KAGbC,EAHa,OAIkBJ,mBAAS,IAJ3B,mBAIvBK,EAJuB,KAILC,EAJK,OAKJN,oBAAS,GALL,mBAKvBO,EALuB,KAKhBC,EALgB,OAMIR,oBAAS,GANb,mBAMvBS,EANuB,KAMZC,EANY,KAQxBjC,EAAWkC,cACXC,EAAUC,cATc,4CAgC9B,WAA6BC,GAA7B,2BAAApF,EAAA,6DACCoF,EAAMC,iBADP,SAEOlF,IAAMD,IAAI,iBAAkB,CACjCE,iBAAiB,IAHnB,UASe,YAHRkF,EAAQT,EAAQ,QAAU,WAGNF,IAAqBF,EAThD,uBAUE9D,MAAM,iDAVR,6BAee,WAAV2E,IAA8C,IAAxBf,EAAMgB,QAAQ,KAfzC,wBAgBE5E,MAAM,4CAhBR,gCAqBqB,CAAC,WAAY,QAAS,OAAQ,OAAQ,OAC1C4E,QAAQxG,IAAa,GAtBtC,wBAuBE4B,MAAM,wDAvBR,wCA4BEqE,GAAa,GAGF,WAAVM,EA/BH,kCAgCYnF,IAAM+B,KAAN,oBACOoD,GACb,CACCvG,SAAUA,EACVwF,MAAOA,EACPE,SAAUA,GAEX,CACCrE,iBAAiB,EACjBe,QAAS,CACR,cAAe/B,OA1CvB,6DA8CYe,IAAM+B,KAAN,oBACOoD,GACb,CACCvG,SAAUA,EACV0F,SAAUA,GAEX,CACCrE,iBAAiB,EACjBe,QAAS,CACR,cAAe/B,OAvDvB,4BA8BQiB,EA9BR,KA4DEwB,QAAQC,IAAIzB,EAASC,MACfkF,EAAkBnF,EAASC,KAAKvB,SAChC0G,EAAepF,EAASC,KAAKiE,MAC7BmB,EAAerF,EAASC,KAAKqF,aAC7BC,EAAmBvF,EAASC,KAAKyB,gBAEvC7C,GAAOqB,IAAI,WAAYiF,EAAiB,CAAEhF,KAAM,MAChDtB,GAAOqB,IAAI,QAASkF,EAAc,CAAEjF,KAAM,MAC1CtB,GAAOqB,IAAI,YAAaqF,EAAkB,CAAEpF,KAAM,MAElDuC,EAAS8C,EAAwBL,IACjCzC,EAAS8C,EAAqBH,IAG9B3C,EAAS+C,MACTd,GAAa,GAETH,EACHK,EAAQa,KAAR,iBAAuBP,IAEvBN,EAAQa,KAAK,2BAhFhB,mDAmFEf,GAAa,GACTgB,EAAU,gDACV,KAAI3F,UAAY,KAAIA,SAASC,OAChC0F,EAAU,KAAI3F,SAASC,MAExBK,MAAMqF,GAxFR,4DAhC8B,sBA4H9B,OACC,sBAAK/B,UAAWgC,KAAO7I,UAAvB,UACE2H,GAAa,cAACnH,EAAD,IAEd,gCACC,oBAAIqG,UAAWiC,KAAGC,MAAlB,SAA0BtB,EAAQ,QAAU,YAC5C,iCAEC,uBAAOZ,UAAW9G,KAAOiJ,MAAOC,QAAQ,WAAxC,SACExB,EAAQ,iBAAmB,aAE7B,uBACA,uBACC7D,GAAG,WACHiD,UAAW9G,KAAOmJ,MAClBhI,MAAOS,EACPwH,SAAU,SAACC,GAAD,OAAO1H,EAAY0H,EAAEC,OAAOnI,UAEvC,wBAEEuG,GACD,gCACC,uBAAOZ,UAAW9G,KAAOiJ,MAAOC,QAAQ,QAAxC,mBAGA,uBACA,uBACCrF,GAAG,QACHiD,UAAW9G,KAAOmJ,MAClBhI,MAAOiG,EACPgC,SAAU,SAACC,GAAD,OAAOhC,EAASgC,EAAEC,OAAOnI,UAEpC,0BAKF,uBAAO2F,UAAW9G,KAAOiJ,MAAOC,QAAQ,WAAxC,sBAGA,uBACA,uBACC9H,KAAK,WACLyC,GAAG,WACHiD,UAAW9G,KAAOmJ,MAClBhI,MAAOmG,EACP8B,SAAU,SAACC,GAAD,OAAO9B,EAAY8B,EAAEC,OAAOnI,UAEvC,wBAGEuG,GACD,gCACC,uBACCZ,UAAW9G,KAAOiJ,MAClBC,QAAQ,oBAFT,oCAMA,uBACA,uBACC9H,KAAK,WACLyC,GAAG,oBACHiD,UAAW9G,KAAOmJ,MAClBhI,MAAOqG,EACP4B,SAAU,SAACC,GAAD,OACT5B,EAAoB4B,EAAEC,OAAOnI,UAG/B,0BAKF,sBAAK2F,UAAW9G,KAAO,oBAAvB,UACC,cAAC4G,GAAD,CAAQG,QAvMiB,4CAuMzB,oBACA,eAACH,GAAD,CAAQG,QAvLa,SAACsC,GAC1BA,EAAEnB,iBACFP,GAAS,SAACQ,GAAD,OAAYA,KAEjBT,GAAS9F,EAASwG,QAAQ,MAAQ,GACrCf,EAASzF,GACTD,EAAY,KACD+F,GAAU9F,IAAYwF,GACjCzF,EAAYyF,GAGbW,EAAQwB,QAAQ7B,EAAQ,mBAAqB,oBA4KzC,uBACYA,EAAQ,UAAY,cAIhCA,GACA,mBACCZ,UAAS,UAAKiC,KAAG,cAAR,YAAyBA,KAAGS,SACrCzC,QApMwB,WAC7BgB,EAAQa,KAAK,6BAiMT,4CCxNS,SAASa,KAAgB,IAAD,EACZtC,qBADY,mBAC/BC,EAD+B,KACxBC,EADwB,OAEkBF,oBAAS,GAF3B,mBAE/BuC,EAF+B,KAETC,EAFS,KAIhC5B,EAAUC,cAEhB4B,qBAAU,WAMJxC,GALW,uCAAG,4BAAAvE,EAAA,sEACSS,IADT,OACZgF,EADY,OAElBjB,EAASiB,GAFS,2CAAH,oDAMfuB,KAEC,CAACzC,IAEJ,IAAM0C,EAAiB,uCAAG,4BAAAjH,EAAA,6DACzB8G,GAAwB,GADC,kBAGAlF,GAAoB,GAHpB,mDAMA7B,IANA,OAMjBhB,EANiB,OAOvBmG,EAAQa,KAAR,iBAAuBhH,IAPA,wBASvB4B,MAAM,2CATiB,0DAYxBA,MAAM,mCAZkB,QAczBmG,GAAwB,GAdC,0DAAH,qDA4BvB,OACC,sBAAK7C,UAAWgC,KAAO7I,UAAvB,YACImH,GAASsC,IAAyB,cAACjJ,EAAD,IACrC,oBAAIqG,UAAWiC,KAAGgB,SAAlB,0CACA,oBAAGjD,UAAWiC,KAAG,YAAjB,kEAEC,sBAAMjC,UAAWiC,KAAGiB,SAApB,SAA+B5C,IAFhC,4EAKA,sBAAKN,UAAWgC,KAAO,qBAAvB,UACC,cAAClC,GAAD,CAAQG,QAAS+C,EAAjB,mBACA,cAAClD,GAAD,CAAQG,QAtBW,WACrB,IACC/D,IAAMD,IAAI,oCAAqC,CAC9CE,iBAAiB,IAElBO,MAAM,qBACL,MAAOyG,GACRzG,MAAM,6CAeL,gCDjDJR,IAAMkH,SAASC,eAAiB,YAChCnH,IAAMkH,SAASE,eAAiB,c,qDEbjB,SAASC,GAASxD,GAAQ,IAAD,EACPM,oBAAS,GADF,mBAChCmD,EADgC,KACtBC,EADsB,KA6BvC,OACC,sBACCzD,UAAS,UAAKgC,KAAO,mBAAZ,YAAkCA,KAAO,gBAAzC,YAA4DA,KAAO0B,UAC5EC,aA7BsB,WACvBF,GAAY,IA6BXG,aA1BuB,WACxBH,GAAY,IAsBZ,UAKC,qBAAKzD,UAAS,UAAKiC,KAAG,gBAAR,YAA2BA,KAAG,kBAA5C,SACElC,EAAMmC,QAER,qBAAKlC,UAAS,UAAKgC,KAAO,mBAAZ,YAAkC9I,KAAO2K,QAAvD,SACEL,GACAzD,EAAM+D,OACN/D,EAAM+D,MAAMC,KACX,SAACrG,EAAMsG,GAAP,OAAetG,EAAKuG,WA7BN,SAACvG,EAAMsG,GACzB,OACC,qBAEC/D,QAASvC,EAAKuC,QACdD,UACCD,EAAMmE,MACHhL,KAAO,gBACPA,KAAO,mBANZ,SASEwE,EAAKyG,MARDH,GA0B8BI,CAAW1G,EAAMsG,W,wBCjClD/I,GAAS,IAAIC,IAEJ,SAASmJ,GAAatE,GACpC,IAAMjF,EAAWwJ,aAAY,SAACjD,GAAD,OAAWA,EAAMkD,KAAKzJ,YADR,EAEHuF,oBAAS,GAFN,mBAEpCmE,EAFoC,KAEtBC,EAFsB,KAIrCxD,EAAUC,cACVpC,EAAWkC,cAGX0D,EAAyB,WAC9BzD,EAAQa,KAAR,gBAAsBhH,KAIvBgI,qBAAU,WACJhI,GACJgB,MAEC,CAAChB,IAGJ,IAAM6J,EAAa,uCAAG,sBAAA5I,EAAA,6DACrBd,GAAO2J,OAAO,YACd3J,GAAO2J,OAAO,SACd3J,GAAO2J,OAAO,aAEdH,GAAgB,GALK,kBAOdvI,IAAM+B,KACX,mBACA,GACA,CACC9B,iBAAiB,EACjBe,QAAS,CACR,cAAe/B,OAbE,OAiBpB2D,EAAS8C,EAAqB,OAC9B9C,EAAS8C,EAAwB,OAEjCX,EAAQa,KAAK,mBApBO,kDAsBpBpF,MAAM,mCACN+H,GAAgB,GAvBI,0DAAH,qDA2BbX,EAAQ,CACb,CACCK,KAAM,+CACNlE,QAAS,kBAAM0E,KACfV,WAAW,IAYTY,EAAU,cAACtB,GAAD,CAAUrB,MAPvB,sBAAKjC,QAASyE,EAAd,4BAEC,sBAAM1E,UAAWiC,KAAGiB,SAApB,SAA+BpI,IAFhC,OAOyCgJ,MAAOA,IAsBjD,OAnBK/D,EAAM+E,OACVD,EACC,sBAAK7E,UAAW9G,KAAOC,UAAvB,UACC,sBACC6G,UAAS,UAAK+E,KAAO7B,SAAZ,YAAwB6B,KAAOrC,QAA/B,YAA0CxJ,KAAOmC,MAC1D4E,QAASyE,EAFV,SAIE5J,IAEF,sBACCmF,QAAS0E,EACT3E,UAAS,UAAK+E,KAAOrC,QAAZ,YAAuBT,KAAG,aAFpC,8BAWF,gCACEuC,GAAgB,cAAC7K,EAAD,IAChBkL,KC/FW,SAASG,KACvB,IAAMC,EAAaX,aAAY,SAACjD,GAAD,OAAWA,EAAM6D,aAAaD,cACvDE,EAAWb,aAAY,SAACjD,GAAD,OAAWA,EAAM6D,aAAaC,YAErDD,EAAeZ,aAAY,SAACjD,GACjC,OAAIA,EAAM5B,MAAMV,UACRsC,EAAM5B,MAAMV,UAAUqG,MAAK,SAACnG,GAAD,OAAUA,EAAKlC,MAAQoI,KAElD,MAIHlE,EAAUC,cACVpC,EAAWkC,cAGXqE,EAAS,uCAAG,gCAAAtJ,EAAA,sEAEhB+C,EAASwG,GAAgC,IAFzB,SAIOpJ,IAAMD,IAAN,qBACRiJ,EAAanI,GADL,aAJP,OAIVX,EAJU,OAOVmJ,EAAenJ,EAASC,KAAKV,OACnCmD,EACC+C,GACCqD,EAAanI,GACb,gBACAwI,IAZc,gDAgBVC,EAAY,KAAIpJ,SACnB,KAAIA,SAASC,KACb,qBACHyC,EACC+C,GACCqD,EAAanI,GACb,gBACAyI,IAvBc,yBA2BhB1G,EAASwG,GAAgC,IA3BzB,4EAAH,qDA0CTxB,EAAQ,CACb,CACCK,KAAM,eACNlE,QAAS,kBAAMoF,KACfpB,UAAWgB,GAEZ,CACCd,KAAM,kBACNlE,QAAS,kBAlBmB,WAC7B,IAAMwF,EAASP,EAAaQ,cAC5B5G,EAAS+C,GAAwBqD,EAAanI,GAAI,SAAU0I,IAgB5CE,IACf1B,UAAWgB,GAEZ,CACCd,KAAM,OACNlE,QAAS,WAhBVgB,EAAQa,KAAK,UAiBZmC,WAAW,IAIb,OAAO,cAACV,GAAD,CAAUrB,MAAM,UAAU4B,MAAOA,I,iCChFnC8B,GAAQC,aAAe,CAC5BC,UAAW,CACVC,UAAW,CACVC,MAAO,CACNC,MAAOhN,GAERiN,MAAO,CACND,MAAOhN,GAERkN,KAAM,CACLF,MAAO,aAMI,SAASG,GAAarG,GAAQ,IACpCsG,EAAqCtG,EAArCsG,cAAeC,EAAsBvG,EAAtBuG,kBAMvB,OACC,cAACC,GAAA,EAAD,CAAeX,MAAOA,GAAtB,SACC,cAACY,GAAA,EAAD,CACCF,kBAAmBA,EACnB1M,MARkB,CACpBF,MAAO,QAQL+M,aAAY,OAAEJ,QAAF,IAAEA,IAAiB,EAC/BK,KAAM,EACNC,OAAK,EACLC,IAAK,EACLC,IAAK,MChCM,SAASC,KACvB,IAAMC,EAAgBC,mBAChBC,EAAcD,iBAAO,GAUrBE,EAAa,SAAbA,IACLC,OAAOC,SAAS,EAAG,GACnBL,EAAcM,QAAUC,WACvBJ,EACA,GAAKK,KAAKC,KAAKP,EAAYI,WAKvBI,EAAsB,SAAtBA,IACLC,aAAaX,EAAcM,SAC3BF,OAAOQ,oBAAoB,YAAaF,IAGnC3D,EAAQ,CACb,CACCK,KACC,cAACiC,GAAD,CACCE,kBAzBwB,SAACsB,EAAGC,GAC/BZ,EAAYI,QAAUQ,EACtBX,IACAC,OAAOW,iBAAiB,YAAaL,IAuBlCpB,cAAeY,EAAYI,UAG7BpH,QAAS,aACTgE,WAAW,IAIb,OAAO,cAACV,GAAD,CAAUrB,MAAM,cAAc4B,MAAOA,EAAOI,OAAK,IClC1C,SAAS6D,GAAWhI,GAClC,IAAMjF,EAAWwJ,aAAY,SAACjD,GAAD,OAAWA,EAAMkD,KAAKzJ,YAC7CmK,EAAaX,aAAY,SAACjD,GAAD,OAAWA,EAAM6D,aAAaD,cACvD+C,EAAU1D,aAAY,SAACjD,GAAD,OAAWA,EAAMkD,KAAKvJ,SAC5CiN,EAAiB3D,aACtB,SAACjD,GAAD,OAAWA,EAAM6D,aAAa+C,kBAIzBC,EACLhP,KAAOC,UACP,KACqB,QAApB4G,EAAMoI,UACJjP,KAAO,wBACPA,KAAO,uBACLkP,EACLlP,KAAO,YACP,KACqB,QAApB6G,EAAMoI,UACJjP,KAAO,uBACPA,KAAO,sBAELmP,EACLpG,KAAG,gBACH,IACAA,KAAG,iBACH,KACqB,QAApBlC,EAAMoI,UACJjP,KAAO,mBACPA,KAAO,kBAELoP,EACLrG,KAAG,gBACH,KACqB,QAApBlC,EAAMoI,UACJjP,KAAO,aACPA,KAAO,iBAEP2L,EACH,sBAAK7E,UAAWkI,EAAhB,UACC,sBAAKlI,UAAWoI,EAAhB,WACGtN,GACD,cAAC,IAAD,CAAMyN,GAAG,IAAIvI,UAAWqI,EAAxB,kBAMAvN,GACA,cAAC,IAAD,CAAMyN,GAAE,iBAAYzN,GAAYkF,UAAWqI,EAA3C,uBAKD,cAAC,IAAD,CAAME,GAAG,gBAAgBvI,UAAWqI,EAApC,oBAICL,GACA,cAAC,IAAD,CAAMO,GAAG,aAAavI,UAAWqI,EAAjC,mBAKoB,QAApBtI,EAAMoI,WAAuB,cAACnD,GAAD,KAG5BC,GAAcgD,IACK,QAApBlI,EAAMoI,WAAuB,cAACrB,GAAD,OAG/B,8BACEhM,EACA,cAACuJ,GAAD,CAAcS,KAA0B,QAApB/E,EAAMoI,YAE1B,cAAC,IAAD,CAAMI,GAAG,kBAAkBvI,UAAWsI,EAAtC,wBAQJ,OAAOL,GAAsC,QAApBlI,EAAMoI,UAC9B,gCACEtD,EACD,qBAAK7E,UAAW9G,KAAOsP,KAAvB,+BAGD3D,EC9Fa,SAAS4D,GAAc1I,GACrC,IAAM8E,EACL,cAACkD,GAAD,CACCI,UAAU,WAIZ,OACC,cAAC,KAAD,CACCO,QAAS7D,EACT8D,KAAM5I,EAAMyD,SACZoF,UAAW7I,EAAM8I,cAHlB,SAKC,8BACE9I,EAAMI,aCjBI,SAAS2I,KACvB,OAAO,4E,wBCGO,SAASC,KACvB,OACC,sBAAK/I,UAAWgC,KAAO7I,UAAvB,UACC,oBAAI6G,UAAWiC,KAAGC,MAAlB,uBACA,oBAAIlC,UAAWiC,KAAGgB,SAAlB,4BACA,sBAAKjD,UAAW9G,KAAO8P,OAAvB,UACC,qFAEC,sBAAMhJ,UAAWiC,KAAGgH,OAApB,uBAFD,yEAIC,sBAAMjJ,UAAWiC,KAAGgH,OAApB,sBAJD,kMAO2D,OAE3D,uBACA,yHAKD,oBAAIjJ,UAAWiC,KAAGgB,SAAlB,uBACA,sBAAKjD,UAAW9G,KAAO8P,OAAvB,UACC,gQAKC,sBAAMhJ,UAAWiC,KAAGgH,OAApB,6BALD,2GAQC,sBAAMjJ,UAAWiC,KAAGgH,OAApB,2BARD,yIAWC,sBAAMjJ,UAAWiC,KAAGgH,OAApB,2BAXD,2BAcA,uBACA,oDAEC,sBAAMjJ,UAAWiC,KAAGgH,OAApB,6BAFD,2CAG+B,IAC9B,sBAAMjJ,UAAWiC,KAAGgH,OAApB,4BAJD,uDAOA,uBACA,o4BAiBA,uBACA,iOAMA,uBACA,kOAOD,oBAAIjJ,UAAWiC,KAAGgB,SAAlB,yBACA,sBAAKjD,UAAW9G,KAAO8P,OAAvB,4EAGC,sBAAMhJ,UAAWiC,KAAGgH,OAApB,oBAHD,+IAOA,oBAAIjJ,UAAWiC,KAAGgB,SAAlB,kBACA,sBAAKjD,UAAW9G,KAAO8P,OAAvB,wGAGC,mBAAGE,KAAK,mDAAR,yBAHD,UCvFY,SAASC,KACvB,IAAMlI,EAAUC,cAchB,OACC,sBAAKlB,UAAWgC,KAAO7I,UAAvB,UACC,qBAAI6G,UAAWiC,KAAG,YAAlB,qBACS,sBAAMjC,UAAWiC,KAAGiB,SAApB,iBADT,iCAIA,oBACClD,UAAS,UAAKiC,KAAG,YAAR,YAAuBA,KAAGiB,SAA1B,YAAsCjB,KAAGS,SAClDzC,QApBkB,WACpBgB,EAAQa,KAAK,oBAiBZ,0BAMA,mBAAG9B,UAAWiC,KAAG,YAAjB,+LAKA,oBAAGjC,UAAWiC,KAAG,YAAjB,0FAGC,sBACCjC,UAAS,UAAKiC,KAAGiB,SAAR,YAAoBjB,KAAGS,SAChCzC,QA9BkB,WACrBgB,EAAQa,KAAK,kBA2BX,oBAHD,iFAYA,oBAAG9B,UAAWiC,KAAG,YAAjB,0CAEC,sBACCjC,UAAS,UAAKiC,KAAGiB,SAAR,YAAoBjB,KAAGS,SAChCzC,QArCgB,WACnBgB,EAAQa,KAAK,UAkCX,kBAFD,4FClDY,I,oBCQA,SAASsH,GAAQrJ,GAC/B,IAAMkF,EAAaX,aAAY,SAACjD,GAAD,OAAWA,EAAM6D,aAAaD,cACvDgD,EAAiB3D,aACtB,SAACjD,GAAD,OAAWA,EAAM6D,aAAa+C,kBAG/B,OACC,8BACC,sBAAKjI,UAAW9G,KAAOC,UAAvB,UACC,qBACCU,IDlBU,63LCmBVE,IAAI,OACJiG,UAAW9G,KAAOO,MAClBwG,QAASF,EAAMsJ,cAEhB,gCACC,cAACrE,GAAD,KACEC,GAAcgD,IACf,cAACnB,GAAD,YCrBS,SAASwC,KACvB,OACC,qBAAKtJ,UAAWgC,KAAO,aAAvB,SACC,cAAC+F,GAAD,CAAYI,UAAU,U,0CCQV,SAASoB,GAAUxJ,GACjC,IAAMjB,EAAWkC,cACXC,EAAUC,cAEV3E,EAAO0E,EAAQuI,SAASC,SAASjO,MAAM,KACvCgO,EAAWjN,EAAKA,EAAKb,OAAS,GAE9BgO,EAAUC,sBACVC,EAAYD,sBARsB,4CAWxC,4BAAA5N,EAAA,sEAEE+C,EAAS+C,GAAwB9B,EAAMrC,KAAKX,KAF9C,SAKyBjB,IALzB,OAKQhB,EALR,OAMEoE,aAAaC,WAAWrE,GAN1B,gDAQE4B,MAAM,wCARR,0DAXwC,sBAwBxC,IAAMmN,EAAe,uCAAG,sBAAA9N,EAAA,yDACG,KAAtBgE,EAAMrC,KAAKoM,QAAqC,KAApB/J,EAAMrC,KAAKrC,KADpB,uBAEtBqB,MAAM,0DAFgB,0BAKvBuE,EAAQa,KACP/B,EAAMgK,SAAN,iBACahK,EAAMrC,KAAKsM,QADxB,YACmCjK,EAAMrC,KAAKX,IAD9C,iBAEagD,EAAMrC,KAAKsM,QAFxB,YAEmCjK,EAAMrC,KAAKX,GAF9C,UANsB,2CAAH,qDAmDfkN,EAAY,WACjB,IAAM5O,EAAOqO,EAAQrC,QAAQhN,MACvByP,EAASF,EAAUvC,QAAQhN,MAE3B0C,EAAKgD,EAAMrC,KAAKX,GAGtB,GAAIgD,EAAMrC,KAAKrC,OAASA,GAAQ0E,EAAMrC,KAAKoM,SAAWA,EAAtD,CAGA,IAAMI,EAAS7O,IAAS0E,EAAMrC,KAAKrC,KAAO,OAAS,SAC7CwM,EAAMxM,IAAS0E,EAAMrC,KAAKrC,KAAOA,EAAOyO,EAE9ChL,EAAS+C,GAAwB9E,EAAImN,EAAQrC,IAC7C7K,EAA8BD,EAAImN,EAAQrC,KAIrCsC,EAAsB,SAAChJ,GACV,UAAdA,EAAMiJ,MACTjJ,EAAMC,iBACND,EAAMqB,OAAO6H,SAKTC,EAAO,SAACC,GAAD,OACZxK,EAAMrC,KAAK8M,aACV,cAAC,KAAD,eAAgBD,IAEhB,cAAC,KAAD,eAAmBA,KAIfE,EAAM,SAACC,GAAD,OACX3K,EAAMrC,KAAKiN,OACV,cAAC,KAAD,eAAkBD,IAElB,cAAC,KAAD,eAA2BA,KAGvBE,EAAc7K,EAAMgK,SAAW,GAAK,CAAEc,UAAU,GAEtD,OACC,sBAAK7K,UAAW9G,KAAO,kBAAvB,UAEC,sBAAK8G,UAAWgC,KAAO,sBAAvB,UAEEjC,EAAMgK,UACN,sBACC/J,UAAW9G,KAAO,oBADnB,UAGC,cAACoR,EAAD,CAAMrK,QArEc,WACxBjD,EACC+C,EAAMrC,KAAKX,GACX,gBACCgD,EAAMrC,KAAK8M,cAGb1L,EACC+C,GACC9B,EAAMrC,KAAKX,GACX,gBACCgD,EAAMrC,KAAK8M,kBA2DV,cAACC,EAAD,CAAKxK,QA3FY,WACK,KAAtBF,EAAMrC,KAAKoM,QAAqC,KAApB/J,EAAMrC,KAAKrC,MAK3C2B,EACC+C,EAAMrC,KAAKX,GACX,UACCgD,EAAMrC,KAAKiN,QAGb7L,EACC+C,GAAwB9B,EAAMrC,KAAKX,GAAI,UAAWgD,EAAMrC,KAAKiN,SAI9D7L,EAAS+C,GAA2B9B,EAAMrC,KAAKX,MAf9CL,MAAM,4DAyF0BsD,UAAW9G,KAAO4R,MAC/C,cAAC,KAAD,CAAa7K,QAjIsB,gDAqIrC,sBAAKD,UAAWgC,KAAO,oBAAvB,UAEC,mCACChC,UAAW9G,KAAOmC,KAClBoL,aAAc1G,EAAMrC,KAAKrC,KACzB0P,YAAY,oBACZC,OAAQf,EACRgB,UAAWd,EACXe,IAAKxB,GACDkB,IAEL,mCACC5K,UAAW9G,KAAO4Q,OAClBrD,aAAc1G,EAAMrC,KAAKoM,OACzBiB,YAAY,kBACZC,OAAQf,EACRgB,UAAWd,EACXe,IAAKtB,GACDgB,IAIJ7K,EAAM4K,QACN,sBAAK3K,UAAW9G,KAAO8Q,QAAvB,2BAEC,sBAAMhK,UAAW9G,KAAO,gBAAxB,SACE6G,EAAMrC,KAAKsM,UAHd,aAYH,sBACChK,UAAW9G,KAAO,mBAClB+G,QAAS4J,EAFV,UAIC,qBACChQ,IAAI,+EACJE,IAAI,QACJiG,UAAW9G,KAAOiS,QAEL,WAAb3B,GAAyC,OAAhBzJ,EAAMH,OAC/B,mBAAGI,UAAW9G,KAAO0G,MAArB,SAA6BG,EAAMH,c,iCCpLzB,SAASwL,GAAUrL,GAAQ,IAAD,EAChBM,oBAAS,GADO,mBACjCsI,EADiC,KAC3B0C,EAD2B,OAEJhL,mBAAS,IAFL,mBAEjCiL,EAFiC,KAErBC,EAFqB,KAGlCC,EAAiBzL,EAAM4K,OAC1B,SAACtJ,GAAD,OAAWA,EAAM5B,MAAMgM,aACvB,SAACpK,GAAD,OAAWA,EAAM5B,MAAMV,WACpB2M,EAAWpH,YAAYkH,GAEvB1M,EAAWkC,cACXC,EAAUC,cAGhB4B,qBAAU,WACT,IAAM6I,EAAW1K,EAAQ2K,QAAO,WAC/BP,GAAQ,GACRE,EAAc,OAGf,OAAO,kBAAMI,OACX,CAAC1K,IAGJ,IAKM4K,EAAc,WACnBN,EAAc,IACVxL,EAAM4K,OACT7L,EAAS+C,GAAoC,UAE7C/C,EAAS+C,GAAkC,WAwBvCiK,EAAsB,WACtBnD,EAIc,KAAf2C,EAxBc,WAClB,IAQMS,EARW,IAAIC,KACpBN,EACA,CAAC,OAAQ,SAAU,WACnB,CACCO,eAAe,EACfpP,MAAM,IAGgBqP,OAAOZ,GAE3BvL,EAAM4K,OACT7L,EAAS+C,GAAoCkK,IAE7CjN,EAAS+C,GAAkCkK,IAe5CI,GAJCN,IAJAR,GAAQ,IAyBV,OACC,sBAAKrL,UAAWiC,KAAG,qBAAnB,UACE0G,GACA,cAAC,KAAD,CACC3I,UAAWiC,KAAG,gBACdhC,QAlBuB,WAC1BoL,GAAQ,MAoBN1C,GACA,uBACCtO,MAAOiR,EACPtL,UAAW9G,KAAOkT,MAClBrB,YAAY,cACZzI,SA1EuB,SAACC,GAC3BgJ,EAAchJ,EAAEC,OAAOnI,QA0EpB4Q,UAtBwB,SAAC1I,GACd,UAAVA,EAAE6H,MACL7H,EAAEC,OAAO6H,OACT9H,EAAEnB,iBACF0K,QAqBCnD,GACA,cAAC,KAAD,CACC3I,UAAWiC,KAAG,gBACdhC,QAAS4L,IAGX,cAAC,KAAD,CACC7L,UAAWiC,KAAG,gBACdhC,QAAS6L,EAFV,uBC5GY,SAASO,KACvB,IAAMrE,EAAU1D,aAAY,SAACjD,GAAD,OAAWA,EAAMkD,KAAKvJ,SAC5C4E,EAAQ0E,aAAY,SAACjD,GAAD,OAAWA,EAAM5B,MAAMG,SAC3C0M,EAAsBhI,aAC3B,SAACjD,GAAD,OAAWA,EAAM5B,MAAM6M,uBAElBxR,EAAWwJ,aAAY,SAACjD,GAAD,OAAWA,EAAMkD,KAAKzJ,YAE7CgE,EAAWkC,cA+BjB,OA7BA8B,qBAAU,WACT,IAAMyJ,EAAQ,uCAAG,8BAAAxQ,EAAA,6DACVyQ,EAAMF,EAAoBvI,KAAI,SAAC9E,GAAD,OAAUA,EAAKlC,MADnC,SAEOb,IAAM+B,KAC5B,uBACA,CACCuO,IAAKA,GAEN,CACCrQ,iBAAiB,EACjBe,QAAS,CACR,eAAgB,mBAChB,cAAe/B,OAXF,OAEViB,EAFU,OAgBhB0C,EAAS+C,GAAsBzF,EAASC,OAhBxB,2CAAH,qDAmBViQ,IAAwB1M,GAC3B2M,MAEC,CAACD,EAAqBxN,EAAUc,IAEnCkD,qBAAU,WACT,OAAO,kBAAMhE,EAAS+C,GAAoC,aACxD,CAAC/C,IAECwN,EAKJ,sBAAKtM,UAAWgC,KAAO7I,UAAvB,UACC,cAACiS,GAAD,CAAWT,QAAM,IAEjB,oBAAI3K,UAAWiC,KAAGC,MAAlB,0BAECoK,EAAoBvI,KAAI,SAAC9E,GACzB,IAAMwN,EACL3R,IAAamE,EAAK+K,SAAWhC,EAC1B,CAAE+B,UAAU,GACZ,GACJ,OACC,cAACR,GAAD,aAECxM,GAAIkC,EAAKlC,GACT6C,MAAOA,EAAQA,EAAMX,EAAKlC,IAAM,KAChCW,KAAMuB,EACN0L,QAAM,GACF8B,GALCxN,EAAKlC,UAhBP,cAACpD,EAAD,I,wBC3CM,SAAS+S,KACvB,IAAMN,EAAQzC,sBAGRgD,EAAY,uCAAG,gCAAA5Q,EAAA,6DACduE,EAAQ8L,EAAM/E,QAAQhN,MADR,kBAII6B,IAAM+B,KAC5B,iCACA,CACCqC,MAAOA,GAER,CACCpD,QAAS,CACR,eAAgB,mBAChB,cAAe/B,OAZC,OAIbiB,EAJa,OAiBnBM,MAAMN,EAASC,MAjBI,gDAmBnBK,MAAK,UAAC,KAAIN,SAASC,YAAd,QAAsB,yCAnBR,yDAAH,qDAuBlB,OACC,sBAAK2D,UAAWgC,KAAO7I,UAAvB,UACC,oBAAI6G,UAAWiC,KAAGC,MAAlB,4BACA,mBAAGlC,UAAWiC,KAAGgH,OAAjB,0HAIA,sBAAKjJ,UAAWgC,KAAO,sBAAvB,UACC,mBAAGhC,UAAW9G,KAAOiL,KAArB,4BACA,uBAAO+G,IAAKkB,EAAOpM,UAAWiC,KAAG,qBAElC,cAACnC,GAAD,CAAQG,QAAS0M,EAAc3M,UAAW9G,KAAO0T,OAAjD,mC,wBCnCY,SAASC,GAAe9M,GACtC,IAAMS,EAAWmJ,sBACXmD,EAAkBnD,sBAElB1I,EAAUC,cACVpC,EAAWkC,cAEX+L,EAAqB,uCAAG,wCAAAhR,EAAA,yDACvBiR,EAASjN,EAAMkN,MAAMD,OACrBE,EAAMF,EAAOE,IACbC,EAAQH,EAAOG,MAEfC,EAAO5M,EAAS6G,QAAQhN,MACxBgT,EAAcP,EAAgBzF,QAAQhN,MACxC+S,IAASC,EAPgB,uBAQ5B3Q,MAAM,0BARsB,oDAaLR,IAAM+B,KAC5B,kCACA,CACCiP,IAAKA,EACLC,MAAOA,EACP3M,SAAU4M,GAEX,CACClQ,QAAS,CACR,eAAgB,mBAChB,cAAe/B,OAvBU,QAatBiB,EAbsB,OA4B5BM,MAAMN,EAASC,MACfyC,EAAS8C,EAAqB,OAC9B9C,EAAS8C,EAAwB,OAEjCX,EAAQa,KAAK,mBAhCe,kDAkC5BlE,QAAQC,IAAI,KAAIzB,UAChBM,MAAK,UACJ,KAAIN,SAASC,YADT,QAEH,+CArC0B,0DAAH,qDA0C3B,OACC,sBAAK2D,UAAWgC,KAAO7I,UAAvB,UACC,oBAAI6G,UAAWiC,KAAGC,MAAlB,6BACA,sBAAKlC,UAAWgC,KAAO,sBAAvB,UACC,mBAAGhC,UAAW9G,KAAOiL,KAArB,uBACA,uBACCnE,UAAWiC,KAAG,gBACdiJ,IAAK1K,EACLlG,KAAK,gBAGP,sBAAK0F,UAAWgC,KAAO,sBAAvB,UACC,mBAAGhC,UAAW9G,KAAOiL,KAArB,8BACA,uBACCnE,UAAWiC,KAAG,gBACdiJ,IAAK4B,EACLxS,KAAK,gBAGP,cAACwF,GAAD,CAAQG,QAAS8M,EAAuB/M,UAAW9G,KAAO0T,OAA1D,uB,4CC5EY,SAASU,GAAYvN,GACnC,OACC,6CAAOA,GAAP,IAAcC,UAAW9G,KAAOiL,KAAhC,SACEpE,EAAMI,SAASoN,iB,wBCHJ,SAASC,GAASzN,GAAQ,IAAD,IACvC,OACC,iCACGA,EAAM0N,SAAW,uBACnB,0BACCC,KAAI,UAAE3N,EAAM4N,iBAAR,QAAqB,EACzB3N,UAAW9G,KAAOkT,MAClBwB,UAAW,IACXnH,aAAY,UAAE1G,EAAM0G,oBAAR,QAAwB,GACpCyE,IAAKnL,EAAM8N,WAEV9N,EAAM0N,SAAW,0BCFP,SAASK,GAAQ/N,GAC/B,IAAMjF,EAAWiF,EAAMkN,MAAMD,OAAOlS,SAE9BiT,EAAezJ,aAAY,SAACjD,GAAD,OAAWA,EAAMkD,KAAKzJ,YAHjB,EAIJuF,qBAJI,mBAI/B2N,EAJ+B,KAIpBC,EAJoB,OAKJ5N,oBAAS,GALL,mBAK/BS,EAL+B,KAKpBC,EALoB,OAMVV,mBAAS,SANC,mBAM/B6N,EAN+B,KAMvBC,EANuB,OAOZ9N,qBAPY,mBAO/B+N,EAP+B,KAOxBC,EAPwB,OAQVhO,qBARU,mBAQ/BiO,EAR+B,KAQvBC,EARuB,KAUhCC,EAAWxH,mBAEX/F,EAAUC,cAEhB4B,qBAAU,YACK,uCAAG,8BAAA/G,EAAA,+EAEQG,IAAMD,IAAN,qCACQnB,IAHhB,OAETsB,EAFS,OAMTqS,EAAMrS,EAASC,KACrBkS,EAAUE,GAPK,gDASf7Q,QAAQC,IAAI,KAAIkE,SATD,QAWhBhB,GAAa,GAXG,yDAAH,qDAcd2N,KACE,CAAC5T,IAEJgI,qBAAU,WACT,IAAM6I,EAAW1K,EAAQ2K,QAAO,WAC/BqC,EAAa,SAGd,OAAO,kBAAMtC,OACX,CAAC1K,IAEJ6B,qBAAU,YACK,uCAAG,4BAAA/G,EAAA,+EAEQG,IAAMD,IAAN,0BACHnB,GACnB,CACCqB,iBAAiB,IALJ,OAETC,EAFS,OASfiS,EAASjS,EAASC,MATH,gDAWfuB,QAAQC,IAAI,KAAIkE,SAXD,yDAAH,qDAed4M,KACE,CAAC7T,IAEJgI,qBAAU,YACK,uCAAG,gCAAA/G,EAAA,2DACVsK,EAAgBnH,aAAa0P,QAAQ9T,IAD3B,uBAIfmT,EAAa5H,GAJE,mDASQnK,IAAMD,IAAN,qBACRnB,EADQ,YATR,OASTsB,EATS,OAaTyS,EAAMzS,EAASC,KACrB4R,EAAaY,GAEb3P,aAAa4P,QAAQhU,EAAU+T,GAhBhB,kDAmBX,KAAIzS,UAAY,KAAIA,SAASC,KAChCK,MAAM,KAAIN,SAASC,MAEnBK,MAAM,wCAGPuE,EAAQa,KAAR,gBAAsBiM,IAzBP,0DAAH,qDA6BdgB,KACE,CAACjU,EAAUmG,EAAS8M,IAEvB,IAAMhB,EAAqB,uCAAG,8BAAAhR,EAAA,6DAC7BgF,GAAa,GADgB,SAEN7E,IAAMD,IAC5B,wCAH4B,OAEvBG,EAFuB,OAKvB1B,EAAO0B,EAASC,KACtB0E,GAAa,GAEbE,EAAQa,KAAKpH,GARgB,2CAAH,qDAWrBsU,EAAa,uCAAG,4BAAAjT,EAAA,6DACfkT,EAAaT,EAASnH,QAAQhN,MAEpCgU,EAASY,GAHY,kBAKd/S,IAAM+B,KACX,sBACA,CACCmQ,MAAOa,GAER,CACC9S,iBAAiB,EACjBe,QAAS,CACR,eAAgB,mBAChB,cAAe/B,OAdE,OAmBpBgT,EAAU,SAnBU,gDAqBpBvQ,QAAQC,IAAI,KAAIkE,SAChBrF,MAAM,4BAtBc,yDAAH,qDA0BbwS,EAAkB,uCAAG,WAAO3M,GAAP,2BAAAxG,EAAA,4DACpBtC,EAAQ8I,EAAEC,OAAO2M,MAAM,IAEnBC,KAAO,KAHS,uBAIzB1S,MACC,uEALwB,6BAUpB2S,EAAkB,CAAC,MAAO,OAE1BC,EAAY7V,EAAM4B,KAAKG,MAAM,MAC7B+T,EAAYD,EAAUA,EAAU5T,OAAS,GAAG8T,iBACQ,IAAxCH,EAAgB/N,QAAQiO,GAdhB,wBAezB7S,MAAM,sBACN6F,EAAEC,OAAOnI,MAAQ,GAhBQ,kCAoBpBoV,EAAW,IAAIC,UACZC,OAAO,QAASlW,GArBC,oBAwBFyC,IAAM+B,KAAK,oBAAqBwR,EAAU,CAChEtT,iBAAiB,EACjBe,QAAS,CACR,cAAe/B,OA3BQ,QAwBnBiB,EAxBmB,OA+BnBqS,EAAMrS,EAASC,KAAKoS,IAC1BF,EAAUE,GAhCe,mDAkCzB7Q,QAAQgS,IAAI,KAAIxT,UAlCS,2DAAH,sDAsCxB,IAAK4R,GAAuB,OAAVI,EACjB,OAAO,sBAGR,IAAMyB,EAAa,SAAC1L,EAAMlE,GACzB,IAAMD,EACL9G,KAAO,eACP,KACCgV,IAAW/J,EAAOjL,KAAO,sBAAwB,IASnD,OACC,mBAAG8G,UAAWA,EAAWC,QARL,WAChBA,GACHA,IAEDkO,EAAUhK,IAIV,SACEA,KAKJ,OAAIrD,EACI,sBAIP,sBAAKd,UAAWgC,KAAO7I,UAAvB,UACC,sBAAK6G,UAAS,UAAKgC,KAAO,mBAA1B,UACE6N,EAAW,SACXA,EAAW,mBAEb,oBAAI7P,UAAS,UAAKgC,KAAO,gBAEzB,sBAAKhC,UAAWgC,KAAO,4BAAvB,UACC,sBAAKhC,UAAWgC,KAAO,oBAAvB,UACC,qBACCnI,IAAG,OACFyU,QADE,IACFA,IACA,6EAEDvU,IAAI,cACJiG,UAAW9G,KAAO4W,UAEP,iBAAX5B,GACA,wBAAO6B,MAAO7W,KAAO,eAArB,0BAEC,uBACCoB,KAAK,OACLyC,GAAG,QACHuF,SAAU4M,UAKd,sBAAKlP,UAAWgC,KAAO,cAAvB,UACC,oBAAIhC,UAAS,UAAKiC,KAAG,YAAR,YAAuBA,KAAGgH,QAAvC,SACEnO,IAEF,8BACC,sBAAMkF,UAAWiC,KAAGgH,OAApB,iCADD,WAGE+E,KAEF,oBAAIhO,UAAWiC,KAAGgB,SAAlB,mBACY,iBAAXiL,EACA,gCACC,cAACV,GAAD,CACCK,QAASW,EACTb,UAAW,GACXF,SAAO,EACPhH,aAAc2H,IAEf,cAACtO,GAAD,CACCG,QAAS+O,EACThP,UAAWgC,KAAO,qBAFnB,qBAQD,mBAAGhC,UAAWiC,KAAG,eAAjB,SACY,KAAVmM,EAAe,gBAAkBA,UAKrCtT,IAAaiT,GAA2B,UAAXG,GAC7B,cAACZ,GAAD,CAAarN,QAAS8M,EAAtB,gCCvQW,SAASiD,KAAiB,IAAD,EACP3P,oBAAS,GADF,mBAChC4P,EADgC,KACtBC,EADsB,KAGjCpR,EAAWkC,cAHsB,4CAMvC,sBAAAjF,EAAA,sDACCmU,GAAY,GAEZpR,EAASqR,MAET7I,YAAW,kBAAM4I,GAAY,KAAQ,KALtC,4CANuC,sBAcvC,OACC,gCACED,GAAY,cAACtW,EAAD,IACb,cAAC2T,GAAD,CAAarN,QAjBwB,2CAiBrC,yBCVY,SAASmQ,GAASrQ,GAAQ,IAWpCkE,EAVInJ,EAAaiF,EAAMkN,MAAMD,OAAzBlS,SAD+B,EAGCuF,oBAAS,GAHV,mBAGhCgQ,EAHgC,KAGlBC,EAHkB,KAIjCtI,EAAU1D,aAAY,SAACjD,GAAD,OAAWA,EAAMkD,KAAKvJ,SAE5CiG,EAAUC,cAGVqP,EAAkB,QADXtP,EAAQuI,SAASC,SAASjO,MAAM,KAC5B,GAIhByI,EADGsM,EACS,SAAClP,GAAD,OACXgP,GAAgBhP,EAAM5B,MAAM+Q,cACzBnP,EAAM5B,MAAMgR,kBAAkBC,QAC9B,SAACzR,GAAD,OAAUA,EAAKuL,gBAEfnJ,EAAM5B,MAAMgR,mBAEJ,SAACpP,GACZ,OAAKA,EAAM5B,MAAMgR,kBAENJ,EACHhP,EAAM5B,MAAMgR,kBAAkBC,QACpC,SAACzR,GAAD,OAAUA,EAAKuL,cAAgBvL,EAAK+K,UAAYlP,KAG1CuG,EAAM5B,MAAMgR,kBAAkBC,QACpC,SAACzR,GAAD,OAAUA,EAAK+K,UAAYlP,KAPrB,MAaV,IAAM4Q,EAAWpH,YAAYL,GAEvBnF,EAAWkC,cAwCjB,GAtCA8B,qBAAU,YACM,uCAAG,sBAAA/G,EAAA,sEACc4B,IADd,wCAIhBsD,EAAQa,KAAK,2BAJG,8DAAH,qDASf/D,KACE,CAACkD,IAEJ6B,qBAAU,WACT,IAAM6I,EAAW1K,EAAQ2K,QAAO,WAC/B9M,EAAS+C,GAAkC,aAG5C,OAAO,kBAAM8J,OACX,CAAC7M,EAAUmC,IAGd6B,qBAAU,YAEQ,uCAAG,4BAAA/G,EAAA,sEACID,IADJ,OACbM,EADa,QAGH,IAAZ4L,GAAqB5L,IAAatB,GACrCmG,EAAQa,KACP1F,EAAQ,iBAAaA,GAAa,mBALjB,2CAAH,qDAUjBuU,KACE,CAAC7V,EAAUmG,EAASnC,EAAU4M,EAAU1D,KAGtC0D,EACJ,OAAO,cAAC/R,EAAD,IAQR,OACC,sBAAKqG,UAAWgC,KAAO7I,UAAvB,UACC,sBAAK6G,UAAWgC,KAAO,sBAAvB,WACGuO,GACD,cAACjD,GAAD,CAAarN,QARS,WACzBqQ,GAAgB,SAACjP,GAAD,OAAYA,MAOzB,SACEgP,EAAe,MAAQ,gBAGxBE,GAAO,cAACP,GAAD,OAEV,cAAC5E,GAAD,IAEA,oBAAIpL,UAAWiC,KAAGC,MAAlB,SACEqO,EACE,YACA,SAAWF,EAAe,aAAe,IAAM,UAGlD3E,EAAS3H,KAAI,SAACrG,GAAD,OACb,cAAC6L,GAAD,CAAyB7L,KAAMA,EAAMqM,UAAQ,GAA7BrM,EAAKX,UCnHlB,IAAM6T,GAAe,eACfC,GAAiB,iBACjBC,GAAe,eAsBfC,GAAa,SAAC7S,EAAQpD,EAAUkW,EAAUC,GACtD,8CAAO,WAAOnS,GAAP,iBAAA/C,EAAA,+EAEkBG,IAAM+B,KAC5B,iBACA,CACCC,OAAQA,EACRgT,KAAMpW,EACNkW,SAAUA,EACVC,OAAQA,GAET,CACC9U,iBAAiB,EACjBe,QAAS,CACR,cAAe/B,IACf,eAAgB,sBAdd,OAECiB,EAFD,OAmBC+U,EAAU/U,EAASC,KACzByC,EAAS,CACRxE,KAAMsW,GACN1S,OAAQA,EACRkT,SAAU,CAACD,KAvBP,gDA0BLzU,MAAM,+CACNkB,QAAQC,IAAI,KAAIkE,SA3BX,yDAAP,uD,6BCtBc,SAASsP,GAAWtR,GAClC,OACC,sBAAKC,UAAWD,EAAMiJ,OAAS9P,KAAOC,UAAY,GAAlD,UACE4G,EAAMmC,OAAS,oBAAIlC,UAAW9G,KAAOoY,QAAtB,SAAgCvR,EAAMmC,QACtD,cAACsL,GAAD,CACCK,QAAS9N,EAAM8N,QACfpH,aAAc1G,EAAM0G,eAEpB1G,EAAMwR,cACN,sBAAKvR,UAAWgC,KAAO,sBAAvB,UACC,cAAClC,GAAD,CAAQG,QAASF,EAAMwR,cAAvB,oBACA,cAACzR,GAAD,CAAQG,QAASF,EAAMiP,cAAvB,uBAGD,cAAClP,GAAD,CACCG,QAASF,EAAMiP,cACfhP,UAAWgC,KAAO,qBAFnB,uB,wBCVW,SAASwP,GAAczR,GACrC,IAAMjF,EAAWwJ,aAAY,SAACjD,GAAD,OAAWA,EAAMkD,KAAKzJ,YADP,EAEZuF,oBAAS,GAFG,mBAErCoR,EAFqC,KAE3BC,EAF2B,OAGZrR,oBAAS,GAHG,mBAGrCsR,EAHqC,KAG3BC,EAH2B,KAItCC,EAAc7K,mBACd8K,EAAW9K,mBAET9I,EAA4B6B,EAA5B7B,OAAQ6T,EAAoBhS,EAApBgS,gBAP4B,EAQiBhS,EAAMoR,QAA3DH,EARoC,EAQpCA,SAAUgB,EAR0B,EAQ1BA,iBAAkBjV,EARQ,EAQRA,GAAIkV,EARI,EAQJA,OAAQ9R,EARJ,EAQIA,SAE1CrB,EAAWkC,cAsFXkR,GAAkB/R,GAAY,IAAI4D,KAAI,SAACoN,GAAD,OAC3C,cAACK,GAAD,CAECtT,OAAQA,EACR6T,gBAAiBZ,EAAQrW,SACzBqW,QAASA,GAHJA,EAAQpU,OAOf,OACC,sBAAKiD,UAAW9G,KAAO,mBAAvB,UACC,sBAAK8G,UAAW9G,KAAOC,UAAvB,UACC,sBAAK6G,UAAW9G,KAAO,wBAAvB,UACC,sBAAK8G,UAAS,UAAKgC,KAAO,qBAAZ,YAAoCC,KAAG,YAAvC,YAAsD/I,KAAOiZ,MAA3E,UACC,qBAAKnS,UAAS,UAAKiC,KAAGiB,UAAtB,SACE6O,IAEF,sBAAK/R,UAAW9G,KAAOiZ,KAAvB,kBACSF,EAAS,SAAW,YAD7B,OArGiB,WACrB,IAAMG,EAAiB,IAAIC,KAAKL,GAC1BM,EAAc,IAAID,KAClBE,EAAQD,EAAcF,EAE5B,GAAIA,EAAeI,YAAcF,EAAYE,UAAW,CAEvD,IAAMC,EAAUF,EAAQ,KACxB,GAAIE,EAAU,EAAG,CAEhB,IAAMC,EAAYnL,KAAKoL,MAAgB,GAAVF,GAC7B,OAAkB,IAAdC,EACI,MAEa,IAAdA,EACJ,eADI,UAEDA,EAFC,gBAKP,OAA+B,IAAxBnL,KAAKoL,MAAMF,GACf,eADI,UAEDlL,KAAKoL,MAAMF,GAFV,cAMT,IAAMG,EAASrL,KAAKoL,MAAMJ,EAAQ,KAAU,IAC5C,GAAIK,GAAU,GACb,OAAkB,IAAXA,EAAe,YAAf,UAAgCA,EAAhC,aAGR,IAAMC,EAAWtL,KAAKoL,MAAMC,EAAS,IACrC,OAAIC,GAAY,GACK,IAAbA,EAAiB,cAAjB,UAAoCA,EAApC,eAED,MAAN,OAAaT,EAAeU,cAA5B,YAA6CV,EAAeW,WAA5D,YACCX,EAAeI,SAoEXQ,SAGH,sBAAKhT,UAAWgC,KAAO,qBAAvB,UACElH,IAAaiX,GACb,cAAC,KAAD,CACC9R,QArEa,WACnByR,GAAY,IAqEN1R,UAAS,UAAKiC,KAAGS,WAGlB5H,IAAaiX,GACb,cAAC,KAAD,CACC9R,QAvEe,WACrBnB,EFP2B,SAAC/B,EAAImB,GACjC,8CAAO,WAAOY,GAAP,SAAA/C,EAAA,sDACN,IACCG,IAAMmD,OAAN,wBAA8BtC,EAA9B,KAAqC,CACpCZ,iBAAiB,EACjBe,QAAS,CACR,cAAe/B,IACf,eAAgB,sBAIlB2D,EAAS,CACRxE,KAAMuW,GACN3S,OAAQA,EACRnB,GAAIA,IAEJ,MAAOoG,GACRzG,MAAM,6CAhBD,2CAAP,sDEMUuW,CAA6BlW,EAAImB,KAuEpC8B,UAAS,UAAKiC,KAAGS,QAAR,YAAmBxJ,KAAOga,SAGpCpY,GACA,cAAC,KAAD,CACCmF,QAzDc,WACpB2R,GAAY,IAyDN5R,UAAS,UAAKiC,KAAGS,iBAKpB+O,EACA,cAACJ,GAAD,CACCxD,QAASgE,EACT7C,cA9EqB,WACzB,IAAMnH,EAAMgK,EAAYxK,QAAQhN,MACpB,KAARwN,GAIAmJ,IAAanJ,GAChB/I,EFCwB,SAACZ,EAAQnB,EAAIiU,GACvC,8CAAO,WAAOlS,GAAP,iBAAA/C,EAAA,+EAEkBG,IAAMe,MAAN,wBACLF,EADK,KAEtB,CACCiU,SAAUA,GAEX,CACC7U,iBAAiB,EACjBe,QAAS,CACR,cAAe/B,IACf,eAAgB,sBAXd,OAECiB,EAFD,OAeC+W,EAAO/W,EAASC,KAAK2V,iBAE3BlT,EAAS,CACRxE,KAAMwW,GACN5S,OAAQA,EACR8S,SAAUA,EACVmC,KAAMA,EACNpW,GAAIA,IAtBA,gDAyBLL,MAAM,6CACNkB,QAAQC,IAAI,KAAIkE,SA1BX,yDAAP,sDEFWkR,CAA2B/U,EAAQnB,EAAI8K,IAEjD6J,GAAY,IANXhV,MAAM,6BA4EH6U,cAnFqB,WACzBG,GAAY,IAmFRjL,aAAcuK,IAGf,sBAAKhR,UAAWiC,KAAG,YAAnB,UACC,uBACC+O,QAIJ,qBAAKhR,UAAW9G,KAAOiH,SAAvB,SAAkC+R,IACjCP,GACA,qBAAK3R,UAAW9G,KAAO,mBAAvB,SACC,cAACmY,GAAD,CACCnP,MAAM,WACN2L,QAASiE,EACTP,cA/EsB,WAC1BK,GAAY,IA+ER5C,cA5EsB,WAC1BlQ,EACCmU,GACC/U,EACApD,EACAgX,EAASzK,QAAQhN,MACjB0C,IAGF6U,GAAY,IAoER5I,QAAM,QAvDsCjM,GC5GnC,SAASqW,GAASrT,GAChC,IAAMjF,EAAWwJ,aAAY,SAACjD,GAAD,OAAWA,EAAMkD,KAAKzJ,YAC7CuY,EAAgBrM,mBAFiB,EAGL3G,oBAAS,GAHJ,mBAGhCS,EAHgC,KAGrBC,EAHqB,KAKjCjC,EAAWkC,cAETjE,EAAOgD,EAAPhD,GAEFqU,EAAW9M,aAAY,SAACjD,GAAD,OAC5BtE,GAAMsE,EAAM+P,SAASA,UAAY/P,EAAM+P,SAASA,SAASrU,GACtDsE,EAAM+P,SAASA,SAASrU,GACxB,QAGJ+F,qBAAU,WACL/F,IAAOqU,GACVtS,EHlBwB,SAAC/B,GAC3B,8CAAO,WAAO+B,GAAP,iBAAA/C,EAAA,+EAEkBG,IAAMD,IAAN,wBACLc,EADK,wBAFlB,OAECX,EAFD,OAMCgV,EAAWhV,EAASC,KAE1ByC,EAAS,CACRxE,KAAMsW,GACN1S,OAAQnB,EACRqU,SAAUA,IAXN,gDAcL1U,MAAM,0DAdD,yDAAP,sDGiBWuW,CAA2BlW,MAEnC,CAAC+B,EAAUsS,EAAUrU,IAExB,IAAMuW,EAAiB,uCAAG,4BAAAvX,EAAA,yDAEX,MADR1B,EAAQgZ,EAAchM,QAAQhN,OADX,uBAGxBuD,QAAQC,IAAI,4BAHY,0BAOzBkD,GAAa,GACbjC,EACCmU,GACClW,EACAjC,EACAT,EACA,OAGFgZ,EAAchM,QAAQhN,MAAQ,GAC9BiN,YAAW,kBAAMvG,GAAa,KAAQ,KAjBb,2CAAH,qDAoBvB,OACCqQ,GACC,gCACC,oBAAIpR,UAAWiC,KAAG,iBAAlB,sBACqB,IAApBmP,EAAS1V,OACT,6CAEA0V,EAASrN,KAAI,SAACoN,GAAD,OACZ,cAACK,GAAD,CAECtT,OAAQnB,EACRgV,gBAAiBZ,EAAQrW,SACzBqW,QAASA,GAHJA,EAAQpU,OAOfjC,GACA,cAACuW,GAAD,CACCnP,MAAM,cACN2L,QAASwF,EACTrE,cAAesE,EACftK,QAAM,IAGPlI,GAAa,cAACnH,EAAD,O,aCtEH,SAAS4Z,GAAexT,GAAQ,IAAD,EACrBM,oBAAS,GADY,mBACtCsI,EADsC,KAChC0C,EADgC,KAEvCmI,EAAoBxM,mBAE1BlE,qBAAU,WACT,OAAO,WACN2Q,cAAcD,EAAkBnM,YAE/B,IAGH,IAgBMqM,EAAY3T,EAAM4T,iBAElBzL,EAAiB,CACtB5O,IAAKyG,EAAMzG,IACXsa,gBAAiB7T,EAAM6T,iBAGlBC,EAAY,CACjB5N,MAAOlG,EAAMkG,OAGd,OACC,sBACCjG,UAAWiC,KAAG,qBACdrI,MAAOsO,EACPjI,QA/BmB,WAChBuT,EAAkBnM,UAGtBgE,GAAQ,GAERoI,cAAcD,EAAkBnM,SAChCmM,EAAkBnM,QAAUyM,aAAY,WACvCzI,GAAQ,GACRoI,cAAcD,EAAkBnM,SAChCmM,EAAkBnM,QAAU,OAC1BtH,EAAMoT,MAETpT,EAAME,YAeN,UAKE0I,GAAQ,mBAAG3I,UAAWiC,KAAG,gBAAjB,SAAmClC,EAAMoE,OAClD,cAACuP,EAAD,CAAW1T,UAAWiC,KAAG,gBAAiBrI,MAAOia,OC3CrC,SAASE,GAAWhU,GAAQ,IAAD,EACLM,oBAAS,GADJ,mBAClC2T,EADkC,KACtBC,EADsB,KAQzC,OACC,cAACV,GAAD,CACCI,iBAAkBO,KAClB/P,KAAM6P,EAAa,aAAe,gBAClC1a,IAAK,IACL2G,QAVc,WACfF,EAAME,UACNgU,GAAc,SAAC5S,GAAD,OAAYA,MASzBuS,gBAAiB3a,EACjBgN,MAAM,QACNkN,KAAM,MCfM,SAASgB,KACvB,IAAMlT,EAAUC,cAMhB,OACC,cAACqS,GAAD,CACCI,iBAAkBS,KAClBjQ,KAAK,GACL7K,IAAK,IACL2G,QATc,WACfgB,EAAQa,KAAK,UASZ8R,gBAAiB3a,EACjBgN,MAAM,QACNkN,KAAM,I,iCCbM,SAASkB,GAAQtU,GAC/B,IAAMjF,EAAWwJ,aAAY,SAACjD,GAAD,OAAWA,EAAMkD,KAAKzJ,YAC7C4Q,EAAWpH,aAAY,SAACjD,GAAD,OAAWA,EAAM5B,MAAMV,aAFd,EAGJsB,oBAAS,GAHL,mBAG/BS,EAH+B,KAGpBC,EAHoB,KAKhCqO,EAAOpI,iBAAO0E,EAAWA,EAAShQ,OAAS,MAE3CuF,EAAUC,cAEhB4B,qBAAU,WACT,GAAI4I,GAAYA,EAAShQ,SAAW0T,EAAK/H,QAAS,CACjD+H,EAAK/H,QAAUqE,EAAShQ,OAExB,IACM0B,EADa,aAAIsO,GAAU7O,MAAK,SAACd,EAAGe,GAAJ,OAAUf,EAAEgB,GAAKD,EAAEC,MAClC,GACvBgE,GAAa,GAET3D,GACH6D,EAAQa,KAAR,iBAAuB1E,EAAI4M,QAA3B,YAAsC5M,EAAIL,QAG1C,CAAC2O,EAAUzK,IAEd,IAAMnC,EAAWkC,cAOjB,OAAKjB,EAAMmF,aAKV,gCACC,oBAAGlF,UAAW9G,KAAOiL,KAArB,UACEpE,EAAMmF,aAAa8E,QADrB,gBAGElP,GACA,sBAAMmF,QAfU,WlCpBd,IAAkBhB,EkCqBvB8B,GAAa,GACbjC,GlCtBuBG,EkCsBQc,EAAMmF,alCrBtC,uCAAO,WAAOpG,GAAP,iBAAA/C,EAAA,6EAECuY,EAFD,2BAGDrV,GAHC,IAIJ0L,QAAQ,EACRH,cAAc,KAED,UACP8J,EAAO,QART,SAUkBpY,IAAM+B,KAAK,cAAeqW,EAAS,CACzDnY,iBAAiB,EACjBe,QAAS,CACR,cAAe/B,OAbZ,OAUCiB,EAVD,OAiBL0C,EAAS,CACRxE,KAAM6D,GACNc,KAAM7C,EAASC,OAnBX,kDAsBLK,MAAM,4BAtBD,0DAAP,yDkCkCgCsD,UAAW+E,KAAOrC,QAA9C,2CAKD5B,GAAa,cAACnH,EAAD,OAdR,sB,iCChCM,SAAS4a,GAAYxU,GACnC,IAAMmF,EAAenF,EAAMmF,aADe,EAEJ7E,qBAFI,mBAEnCmU,EAFmC,KAEtBC,EAFsB,OAGApU,mBAAS,IAHT,mBAGnCqU,EAHmC,KAGpBC,EAHoB,OAIRtU,mBAAS,QAJD,mBAInCuU,EAJmC,KAIxBC,EAJwB,KAMlCC,EAAqD/U,EAArD+U,UAAWC,EAA0ChV,EAA1CgV,aAAcC,EAA4BjV,EAA5BiV,UAAWC,EAAiBlV,EAAjBkV,aAE5CnS,qBAAU,WACT,IAAMoS,EAAYhQ,EAAaO,OAAOjK,MAAM,MAAME,OAElD,IAAKoZ,GAAaI,IAAcJ,EAAUpZ,OAAQ,CACjD,IAAMyZ,EAAU,IAAIC,MAAMF,GAAWG,OAAOtR,KAAI,kBAAM4F,yBACtDoL,EAAaI,MAEZ,CAACjQ,EAAc4P,EAAWC,IAE7BjS,qBAAU,WACT,IAAMoS,EAAYhQ,EAAaO,OAAOjK,MAAM,MAAME,OAElD,IAAKsZ,GAAaE,IAAcF,EAAUtZ,OAAQ,CACjD,IAAMyZ,EAAU,IAAIC,MAAMF,GAAWG,OAAOtR,KAAI,kBAAM4F,yBACtDsL,EAAaE,MAEZ,CAACjQ,EAAc8P,EAAWC,IAE7B,IAAMhU,EAAUC,cAEhB4B,qBAAU,WACT,IAAM6I,EAAW1K,EAAQ2K,QAAO,kBAAM+I,EAAiB,OAEvD,OAAO,kBAAMhJ,OACX,CAAC1K,IAGJ,IAAMkJ,EAAsB,SAAChJ,GAG5B,GAFApB,EAAMuV,mBAAkB,GAEN,UAAdnU,EAAMiJ,IACTjJ,EAAMC,iBACND,EAAMqB,OAAO6H,YACP,GAAkB,MAAdlJ,EAAMiJ,IAChBjJ,EAAMC,iBACND,EAAMqB,OAAOnI,OAAS,YAChB,GAAkB,MAAd8G,EAAMiJ,IAAa,CAC7BjJ,EAAMC,iBACN,IAAMyG,EAAM1G,EAAMqB,OAAOnI,MACzB8G,EAAMqB,OAAOnI,MACZwN,EAAInM,QAAU,EAAI,GAAKmM,EAAI0N,OAAO,EAAG1N,EAAInM,OAAS,KAM/C8Z,EAAoB,SAACjT,GACC,KAAvBA,EAAEC,OAAOiT,YACZlT,EAAEC,OAAOiT,UAAY,MAIjBC,EAAY,SAAC3Y,GAClB4X,GAAiB,SAACtT,GAAD,OACO,IAAvBA,EAAMC,QAAQvE,GAAd,uBACOsE,GADP,CACctE,IACXsE,EAAMqP,QAAO,SAACrW,GAAD,OAAWA,IAAU0C,SAIjC4Y,EAAgB,SAACpT,GACtB,GAAKxC,EAAMiU,WAAX,CAIA,IAAMjX,GAAMwF,EAAEC,OAAOzF,GAGrB,GAAkB,SAAd6X,EAQH,OAPIrS,EAAEqT,OACLC,EAAsB9Y,GAEtB2Y,EAAU3Y,QAGX0X,EAAe1X,GAIhB,GAA6B,IAAzB2X,EAAchZ,OAAlB,CAMA,IAAMoa,EAAe,aAAIpB,GAAe7X,MAAK,SAACd,EAAGe,GAAJ,OAAUf,EAAIe,KACrDiZ,EAAQD,EAAa,GACrBE,EAAQF,EAAaA,EAAapa,OAAS,GAAKqa,EAAQ,EAE9DhW,EAAMuV,mBAAkB,GAExB,IAAMW,EAAgBnB,EAAU/Q,KAAI,SAACmH,GAAD,OAASA,EAAI7D,QAAQhN,SAEzD,GAAkB,UAAdua,EAAuB,CAAC,IAAD,iBACVkB,GADU,IAC1B,2BAA8B,CAAC,IAApBra,EAAmB,QACvBya,EAAQnZ,EAAKtB,EAAIsa,EACjBI,EAAWF,EAAcxa,GAEzB2a,EAAStB,EAAUoB,GACzB,IAAKE,QAA6BC,IAAnBD,EAAO/O,QACrB,MAED+O,EAAO/O,QAAQhN,MAAQ8b,GATE,oCAc1B,IAFA,IAAIG,EAAW,EACXC,GAAc,IACL,sBAEIT,GAFJ,IAEZ,2BAA8B,CAAC,IAApBra,EAAmB,QACvBya,EAAQnZ,EAAKtB,EAAIsa,EAAQO,EAAWN,EACpCG,EAAWF,EAAcxa,GAEzB2a,EAAStB,EAAUoB,GACzB,IAAKE,QAA6BC,IAAnBD,EAAO/O,QAAuB,CAC5CkP,GAAc,EACd,MAGDH,EAAO/O,QAAQhN,MAAQ8b,GAZZ,8BAcZ,GAAII,EACH,QAECD,EAGJ3J,SA/CCA,MAkDIkJ,EAAwB,SAAC9Y,GAC9B,GAAoB,OAAhByX,EACH,GAAIzX,EAAKyX,EACR,IAAK,IAAI/Y,EAAI+Y,EAAc,EAAG/Y,GAAKsB,IAAMtB,EACxCia,EAAUja,QAEL,GAAI+Y,EAAczX,EACxB,IAAK,IAAItB,EAAI+Y,EAAc,EAAG/Y,GAAKsB,IAAMtB,EACxCia,EAAUja,QAED+Y,IAAgBzX,GAC1B2Y,EAAU3Y,QAGX2Y,EAAU3Y,IAIN4P,EAAe,WACpBgI,EAAiB,IACjBF,EAAe,MACfI,EAAa,SAuER2B,EAAe,SAACrU,EAAOlC,GAC5B,OACC,uBAAMD,UAAWiC,KAAGS,QAASzC,QAASA,EAAtC,6BAC0BkC,EAD1B,uBAMF,OAAK2S,GAAcE,EAKlB,gCACEjV,EAAMiU,YACN,sBAAKhU,UAAW9G,KAAM,QAAtB,UACEsd,EAAa,QAAS7J,GADxB,IAEE6J,EAAa,QArFE,WACnB3B,EAAa,SACbJ,EAAe,SAiFb,IAGE+B,EAAa,kBAjFU,WAC3B3B,EAAa,iBACbJ,EAAe,SA4Eb,IAIE+B,EAAa,SA7EG,WAAO,IAAD,iBACV9B,GADU,IAC1B,2BAA+B,CAAC,IAArBjZ,EAAoB,QAC9BqZ,EAAUrZ,GAAG4L,QAAQhN,MAAQ,IAFJ,8BAI1BsS,UA4EC,oBAAI3M,UAAWiC,KAAG,iBAAlB,oBACyB,KAAxBiD,EAAaO,OACb,mBAAGzF,UAAW9G,KAAO,cAArB,8BAzEKgM,EAAaO,OAAOjK,MAAM,MAAMuI,KAAI,SAACrG,EAAMsG,GAAS,IAAD,EACrDyS,EAAc,GAelB,OAdI1W,EAAMiU,aACLhQ,IAAQwQ,EACXiC,EAAc,CAEb7C,gBAAiB3a,IAEwB,IAAhCyb,EAAcpT,QAAQ0C,KAChCyS,EAAc,CAEb7C,gBAAiB3a,KAMnB,gCACC,uBACCiS,IAAK4J,EAAU9Q,GACfjH,GAAIiH,EACJhE,UAAWiC,KAAG,gBACdrI,MAAO6c,EACPhQ,aAAY,UACXvB,EAAawR,OAAOlb,MAAM,MAAMwI,UADrB,QAC6B,GAEzCiH,UAAWd,EACXwM,YAAY,MACZ1W,QAAS0V,EACT9K,UAAW9K,EAAMgK,UAAYhK,EAAMiU,aAEpC,mBACC9I,IAAK8J,EAAUhR,GACfhE,UAAW9G,KAAO,cAClB0d,gBAAiB7W,EAAMgK,UAAYhK,EAAMiU,WACzC6C,+BACC9W,EAAMgK,UAAYhK,EAAMiU,WAEzB/I,UAAWd,EACXa,OAAQwK,EACRsB,YAAY,EATb,SAWEpZ,MAzBOsG,SAyCL,cAACrK,EAAD,IChPM,SAASod,GAAkBhX,GAAQ,IACzCmF,EAAkCnF,EAAlCmF,aAAc8R,EAAoBjX,EAApBiX,gBAEhBlY,EAAWkC,cAqBjB,OAAKgW,EAKJ,gCACC,oBAAIhX,UAAWiC,KAAG,iBAAlB,2BACA,mBACCiJ,IAAK8L,EACLhX,UAAWiC,KAAG,gBACd2U,iBAAiB,EACjBC,gCAAgC,EAChC5L,UA/BoB,WACtBlL,EAAMuV,mBAAkB,IA+BtBtK,OA1BiB,SAACzI,GAChBA,EAAEC,OAAOiT,YAAcvQ,EAAaQ,eAGxC5G,EACC+C,GACCqD,EAAanI,GACb,gBACAwF,EAAEC,OAAOiT,aAmBTqB,YAAY,EAPb,SASE5R,EAAaQ,cACXR,EAAaQ,cACb,qiBAjBE,cAAC/L,EAAD,IC1BM,SAASwa,GAAQpU,GAC/B,OACC,cAACwT,GAAD,CACCI,iBAAkBsD,KAClB9S,KAAK,SACL7K,IAAK,IACL2G,QAASF,EAAME,QACf2T,gBAAiB3a,EACjBgN,MAAM,QACNkN,KAAM,MCVM,SAAS+D,GAAsBnX,GAC7C,IAAMmF,EAAenF,EAAMmF,aAY3B,OAAKnF,EAAMoX,oBAKV,gCACC,oBAAInX,UAAWiC,KAAG,iBAAlB,+BACA,uBACCiJ,IAAKnL,EAAMoX,oBACXnX,UAAWiC,KAAG,gBACdwE,aAAcvB,EAAakS,kBAC3BnM,UApBoB,SAAC9J,GACL,UAAdA,EAAMiJ,MACTjJ,EAAMC,iBACND,EAAMqB,OAAO6H,QAGdtK,EAAMuV,mBAAkB,IAetBqB,YAAY,MACZ9L,UAAW9K,EAAMgK,cAZZ,cAACpQ,EAAD,I,wBCYM,SAAS0d,GAAKtX,GAC5B,IAAMuX,EAAgBtQ,kBAAO,GACvBuQ,EAAoBvQ,kBAAO,GAFE,EAGC3G,oBAAS,GAHV,mBAG5B2T,EAH4B,KAGhBC,EAHgB,KAM7BuD,EAAalT,aAClB,SAACjD,GAAD,OAAWA,EAAM6D,aAAa+C,kBAEzB9C,EAAWb,aAAY,SAACjD,GAAD,OAAWA,EAAM6D,aAAaC,YACrDsS,EAAanT,aAAY,SAACjD,GAAD,OAAWA,EAAM6D,aAAauS,cACvDzP,EAAU1D,aAAY,SAACjD,GAAD,OAAWA,EAAMkD,KAAKvJ,SAXf,EAcDqF,qBAdC,mBAc5ByU,EAd4B,KAcjBC,EAdiB,OAeD1U,qBAfC,mBAe5B2U,EAf4B,KAejBC,EAfiB,KAgB7BkC,EAAsBxN,sBACtBqN,EAAkBrN,sBAElB7K,EAAWkC,cACXC,EAAUC,cAGVwI,EAAUC,sBACVC,EAAYD,sBAEZpN,EAAO0E,EAAQuI,SAASC,SAASjO,MAAM,KAEvC0J,EAAeZ,aAAY,SAACjD,GACjC,IACMzE,EADmC,SAA1BL,EAAKA,EAAKb,OAAS,GACZ2F,EAAM5B,MAAMgM,YAAcpK,EAAM5B,MAAMV,UAG5D,IAAKnC,EACJ,OAAO,KAEP0a,EAAcjQ,SAAU,EAGzB,IAAMtK,GAAMgD,EAAMkN,MAAMD,OAAOjQ,GACzBjC,EAAWiF,EAAMkN,MAAMD,OAAOlS,SACpC,OAAO8B,EAAKwI,MAAK,SAACnG,GACjB,OAAOA,EAAKlC,KAAOA,GAAMkC,EAAK+K,UAAYlP,QAItC4c,EAAe1Q,iBAAO9B,GAE5BpC,qBAAU,WACLoC,IACHwE,EAAQrC,QAAQhN,MAAQ6K,EAAa7J,KACrCuO,EAAUvC,QAAQhN,MAAQ6K,EAAa4E,UAEtC,CAAC5E,EAAcwE,EAASE,IAG3B9G,qBAAU,WACT,IAAM6U,EAAY,uCAAG,sBAAA5b,EAAA,+EAEIiC,EAAmBkH,EAAanI,IAFpC,UAIG,6CAJH,OAINV,KAJM,iDASnByC,EAAS+C,GAA2BqD,EAAanI,KAT9B,gDAWnBa,QAAQC,IAAI,KAAIzB,SAAW,KAAIA,SAASC,KAAO,KAAI0F,SAXhC,yDAAH,qDAedmD,GAAgBA,EAAayF,QAChCgN,MAEC,CAACzS,EAAcpG,IAGlBgE,qBAAU,WACT,IAAK0U,EAAY,CAChB,IAAMI,EAAU3W,EAAQ4W,OAAM,WAC7B,IvC2BwB9a,EuC3BlB+a,EAASJ,EAAarQ,QAE5B,GACCkQ,EAAkBlQ,UACjB9J,EAAoBua,EAAQ5S,GAC5B,CAED,IAAM9I,EAAW+K,OAAO4Q,QACvB,6DAOD,OAHI3b,GACH0C,GvCcsB/B,EuCdY+a,EAAO/a,GvCevC,CACNzC,KAAMkE,GACNzB,GAAIA,EACJkC,KuClBiD6Y,KAEvC1b,EAGR,OAAO,KAGR,OAAO,kBAAMwb,QAEZ,CAAC1S,EAAcjE,EAASnC,EAAU0Y,EAAYE,IAIjD,IAAMM,EAAmBC,uBACxB,SAAC9W,IAECoW,EAAkBlQ,SACjB9J,EAAoB2H,EAAcwS,EAAarQ,WAEhDlG,EAAMC,iBACND,EAAM+W,YAAc,MAGtB,CAAChT,IAIFpC,qBAAU,WACT,IAAK0U,EAGJ,OAFArQ,OAAOW,iBAAiB,eAAgBkQ,GAEjC,kBACN7Q,OAAOQ,oBAAoB,eAAgBqQ,MAE3C,CAACA,EAAkBR,IAGtB1U,qBAAU,WAkBJkF,GAAYwP,GAjBK,uCAAG,gCAAAzb,EAAA,yDAEM,SAA1BQ,EAAKA,EAAKb,OAAS,GAFC,wDAMlByc,EAAepY,EAAMkN,MAAMD,OAAOlS,SANhB,SAQDgB,IARC,OAQlBhB,EARkB,OAUpBqd,IAAiBrd,IACdiC,EAAKgD,EAAMkN,MAAMD,OAAOjQ,GAE9BkE,EAAQa,KAAR,iBAAuBqW,EAAvB,YAAuCpb,EAAvC,WAbuB,2CAAH,oDAkBrBqb,KAEC,CACFrY,EAAMkN,MAAMD,OAAOlS,SACnBmG,EACAkE,EACA6C,EACAwP,EACAjb,EACAwD,EAAMkN,MAAMD,OAAOjQ,KAIpB+F,qBAAU,YACO,uCAAG,8BAAA/G,EAAA,yDAEY,SAA1BQ,EAAKA,EAAKb,OAAS,GAFL,uBAGZwJ,GAAgBoS,EAAcjQ,SAClCpG,EAAQa,KAAK,iBAJG,2BAWboD,GAAgBoS,EAAcjQ,SAC5B8Q,EAAepY,EAAMkN,MAAMD,OAAOlS,SAClCiC,EAAKgD,EAAMkN,MAAMD,OAAOjQ,GAG9BkE,EAAQa,KAAR,iBAAuBqW,EAAvB,YAAuCpb,EAAvC,WACUmI,IAAiBwS,EAAarQ,UACxCqQ,EAAarQ,QAAUnC,GAlBN,2CAAH,qDAuBhBmT,KACE,CACFnT,EACApG,EACAmC,EACAkE,EACApF,EAAMkN,MAAMD,OAAOlS,SACnBiF,EAAMkN,MAAMD,OAAOjQ,GACnBR,IAID,IAAM+Y,EAAoB,SAACjb,GACtBkd,EAAkBlQ,UAAYhN,IACjCkd,EAAkBlQ,QAAUhN,IAoExB8P,EAAsB,SAAChJ,GAC5BmU,GAAkB,GAEA,UAAdnU,EAAMiJ,MACTjJ,EAAMC,iBACND,EAAMqB,OAAO6H,SAKTJ,EAAY,WACjB,IAAM5O,EAAOqO,EAAQrC,QAAQhN,MACvByP,EAASF,EAAUvC,QAAQhN,MAE3B0C,EAAKmI,EAAanI,GAGxB,GAAImI,EAAa7J,OAASA,GAAQ6J,EAAa4E,SAAWA,EAA1D,CAGA,IAAMI,EAAS7O,IAAS6J,EAAa7J,KAAO,OAAS,SAC/CwM,EAAMxM,IAAS6J,EAAa7J,KAAOA,EAAOyO,EAEhDhL,EAAS+C,GAAwB9E,EAAImN,EAAQrC,MAO9C,IAAK3C,EACJ,OAAO,cAACvL,EAAD,IAGR,IAAI2e,EAAiB,CAAEvO,UAAU,EAAOiK,YAAY,GAC/CwD,IACJc,EAAc,UAAe,GAE1BtE,IACHsE,EAAc,YAAiB,GAEhC,IAAM1N,EAAc4M,EAAa,CAAE3M,UAAU,GAAS,GAEhD0N,EAAkB,CACvB3E,gBAAiBI,EAAa/a,EAAkB,IAGjD,OACC,sBAAK+G,UAAWgC,KAAO7I,UAAWS,MAAO2e,EAAzC,UACEd,GAAc,cAAC9d,EAAD,IAGf,cAAC0a,GAAD,CAASnP,aAAcA,KAGrBsS,GAAc,cAAC,GAAD,CAASvX,QAtHN,WAEpB,IAAIuY,EAAY,GACZC,EAAY,GAChB,GAA4B,KAAxBvT,EAAaO,OAChB+S,EAAY,GACZC,EAAY,QAGZ,IADA,IAAMC,EAAMxT,EAAaO,OAAOjK,MAAM,MAAME,OACnCD,EAAI,EAAGA,EAAIid,IAAOjd,EAAG,CAE7B+c,GADoBxD,EAAUvZ,GAAG4L,QACRoO,UACzB+C,GAAa/c,IAAMid,EAAM,EAAI,GAAK,KAGlCD,GADoB3D,EAAUrZ,GAAG4L,QACRhN,MACzBoe,GAAahd,IAAMid,EAAM,EAAI,GAAK,KAKpC,IAAMC,EAAUjP,EAAQrC,QAAQhN,MAC1Bue,EAAYhP,EAAUvC,QAAQhN,MAG9Bwe,EAAsB1B,EAAoB9P,QAAQhN,MAElDye,EAAkB9B,EAAgB3P,QAAQoO,UAEhDiC,EAAarQ,QAAb,2BACInC,GADJ,IAECO,OAAQ+S,EACR9B,OAAQ+B,EACRpd,KAAMsd,EACN7O,OAAQ8O,EACRxB,kBAAmByB,EACnBnT,cAAeoT,IxCrMX,SAA8Bpb,GACpC,IAAMqb,EAAQ,eAAQrb,UACfqb,EAAQ,QACf7c,IAAMe,MAAN,qBAA0BS,EAAKX,GAA/B,KAAsCgc,EAAU,CAC/C5c,iBAAiB,EACjBe,QAAS,CACR,eAAgB,mBAChB,cAAe/B,OwCkMhB6d,CAAqBtB,EAAarQ,SAClCvI,EAAS+C,GAAwBqD,EAAanI,GAAI,SAAUyb,IAC5D1Z,EAAS+C,GAAwBqD,EAAanI,GAAI,SAAU0b,IAC5D3Z,EAAS+C,GAAwBqD,EAAanI,GAAI,OAAQ4b,IAC1D7Z,EAAS+C,GAAwBqD,EAAanI,GAAI,SAAU6b,IAC5D9Z,EACC+C,GACCqD,EAAanI,GACb,oBACA8b,IAGF/Z,EACC+C,GACCqD,EAAanI,GACb,gBACA+b,IAGFxD,GAAkB,OA4DfkC,GAAc,cAACzD,GAAD,CAAY9T,QA9BV,WACnBgU,GAAc,SAAC5S,GAAD,OAAYA,QA+BzB,cAAC,GAAD,IAGA,mCACCrB,UAAWiC,KAAE,MACbwE,aAAcvB,EAAa7J,KAC3B0P,YAAY,QACZE,UAAWd,EACXa,OAAQf,EACRiB,IAAKxB,GACDkB,IAIL,mCACC5K,UAAW9G,KAAO4Q,OAClBrD,aAAcvB,EAAa4E,OAC3BiB,YAAY,SACZE,UAAWd,EACXa,OAAQf,EACRiB,IAAKtB,GACDgB,IAGL,cAACsM,GAAD,aACChS,aAAcA,EACdoQ,kBAAmBA,EACnB6B,oBAAqBA,GACjBmB,IAGL,cAAC/D,GAAD,aACCrP,aAAcA,EACdoQ,kBAAmBA,EACnBtB,WAAYA,EACZc,UAAWA,EACXC,aAAcA,EACdC,UAAWA,EACXC,aAAcA,GACVqD,KAGHd,GACD,cAACT,GAAD,CACC7R,aAAcA,EACdoQ,kBAAmBA,EACnB0B,gBAAiBA,IAInB,cAAC5D,GAAD,CAAUrW,GAAImI,EAAanI,QCjYf,SAASkc,GAAOlZ,GAAO,MAELM,oBAAS,GAFJ,mBAE9BmD,EAF8B,KAEpBC,EAFoB,KAI/ByV,EAAmB,WACxBzV,GAAY,SAACpC,GAAD,OAAYA,MAGnBJ,EAAUC,cACVpC,EAAWkC,cAGjB8B,qBAAU,WACThE,ExC2BD,uCAAO,WAAOA,GAAP,iBAAA/C,EAAA,+EAEkBG,IAAMD,IAAI,oBAAqB,CACrDE,iBAAiB,IAHb,OAECC,EAFD,OAMCqP,EAAcrP,EAASC,KAC7ByC,EAAS,CACRxE,KAAM+D,GACNoN,YAAaA,IATT,sDAYL/O,MAAM,4CAZD,8DAAP,uDwCzBoB,uCAAG,4BAAAX,EAAA,sEACED,IADF,OACfhB,EADe,OAGrBgE,EAAS8C,EAAwB9G,IAC7BA,GACHgE,EAAS+C,MALW,2CAAH,oDASnBsX,KACE,CAACra,IAGJgE,qBAAU,WACT,IAAMsW,EAAc,WACnB,IAAMC,EAAMlS,OAAOqC,SAASN,KAAK1N,MAAM,KAEvC,GAAmB,IAAf6d,EAAI3d,QAA2B,UAAX2d,EAAI,GAAgB,CAC3Cva,EAASwG,GAAkC,IAC3CxG,EAASwG,GAAsC,IAE/C,IAAMH,EAAWkU,EAAI,GACrBva,EAASwG,EAAgCH,SACnC,GACS,IAAfkU,EAAI3d,QACO,UAAX2d,EAAI,IACO,SAAXA,EAAI,GACH,CACDva,EAASwG,GAAsC,IAC/CxG,EAASwG,GAAkC,IAE3C,IAAMH,EAAWkU,EAAI,GACrBva,EAASwG,EAAgCH,SAEzCrG,EAASwG,GAAkC,IAC3CxG,EAASwG,GAAsC,IAE/CxG,EAASwG,EAAgC,QAI3C8T,IAEA,IAAMzN,EAAW1K,EAAQ2K,QAAO,WAC/BwN,OAGD,OAAO,kBAAMzN,OACX,CAAC7M,EAAUmC,IAGd,IAAMqY,EAAO,kBACZ,eAAC,IAAD,WACC,cAAC,IAAD,CAAOC,OAAK,EAAChd,KAAK,IAAIid,UAAWrQ,KACjC,cAAC,IAAD,CAAOoQ,OAAK,EAAChd,KAAK,QAAQid,UAAWzQ,KACrC,cAAC,IAAD,CAAOwQ,OAAK,EAAChd,KAAK,kBAAkBid,UAAW1L,KAC/C,cAAC,IAAD,CACCyL,OAAK,EACLhd,KAAM,CAAC,kBAAmB,oBAC1Bid,UAAWpZ,KAEZ,cAAC,IAAD,CACCmZ,OAAK,EACLhd,KAAK,0BACLid,UAAW7W,KAEZ,cAAC,IAAD,CACC4W,OAAK,EACLhd,KAAK,2BACLid,UAAW9M,KAEZ,cAAC,IAAD,CACC6M,OAAK,EACLhd,KAAK,wCACLid,UAAW3M,KAEZ,cAAC,IAAD,CAAO0M,OAAK,EAAChd,KAAK,gBAAgBid,UAAWnN,KAC7C,cAAC,IAAD,CAAOkN,OAAK,EAAChd,KAAK,aAAaid,UAAWpJ,KAC1C,cAAC,IAAD,CAAOmJ,OAAK,EAAChd,KAAK,mBAAmBid,UAAWpJ,KAChD,cAAC,IAAD,CACCmJ,OAAK,EACLhd,KAAM,CAAC,uBAAwB,6BAC/Bid,UAAWnC,KAEZ,cAAC,IAAD,CAAOmC,UAAWC,SAIpB,OAAO1Z,EAAM2Z,WACZ,gCACC,cAACpQ,GAAD,IACA,cAACgQ,EAAD,OAGD,eAAC,GAAD,CAAe9V,SAAUA,EAAUqF,cAAeqQ,EAAlD,UACC,cAAC9P,GAAD,CAASC,YAAa6P,IACtB,cAACI,EAAD,O,4DCzHGK,GAAe,CACpB5a,UAAW,KACX0M,YAAa,KACbgF,kBAAmB,KACnBnE,oBAAqB,KACrB1M,MAAO,MAuLOga,OApLf,WAA8C,IAA/BA,EAA8B,uDAAtBD,GAAcE,EAAQ,uCACtCC,EAAc,SAACla,EAAOhD,GACvBgD,GACHhD,EAAKC,MAAK,SAACd,EAAGe,GAAJ,OAAU8C,EAAM7D,EAAEgB,IAAM6C,EAAM9C,EAAEC,QAI5C,GAAI8c,EAAOvf,OAAS8D,GACnB,OAAO,2BACHwb,GADJ,IAEC7a,UAAW8a,EAAO9a,UAClB0R,kBAAmBoJ,EAAO9a,YAErB,GAAI8a,EAAOvf,OAAS+D,GAC1B,OAAO,2BACHub,GADJ,IAECnO,YAAaoO,EAAOpO,YACpBa,oBAAqBuN,EAAOpO,cAEvB,GAAIoO,EAAOvf,OAAS6D,GAAU,CACpC,IAAMY,EAAY6a,EAAM7a,UAAUgb,OAAOF,EAAO5a,MAC1CwR,EAAoBmJ,EAAMnJ,kBAAkBsJ,OAAOF,EAAO5a,MAIhE,OAHAtC,EAAcoC,GACdpC,EAAc8T,GAEP,2BACHmJ,GADJ,IAEC7a,UAAWA,EACX0R,kBAAmBA,IAEd,GAAIoJ,EAAOvf,OAASgE,GAC1B,OAAO,2BACHsb,GADJ,IAEC7a,UAAW6a,EAAM7a,UAAU2R,QAAO,SAACzR,GAAD,OAAUA,EAAKlC,KAAO8c,EAAO9c,MAC/D0O,YAAamO,EAAMnO,YAAYiF,QAC9B,SAACzR,GAAD,OAAUA,EAAKlC,KAAO8c,EAAO9c,MAE9B0T,kBAAmBmJ,EAAMnJ,kBAAkBC,QAC1C,SAACzR,GAAD,OAAUA,EAAKlC,KAAO8c,EAAO9c,MAE9BuP,oBAAqBsN,EAAMtN,oBAAoBoE,QAC9C,SAACzR,GAAD,OAAUA,EAAKlC,KAAO8c,EAAO9c,QAGzB,GAAI8c,EAAOvf,OAASiE,GAAa,CACvC,IAAMyb,EAAW,2BACbJ,EAAM7a,UAAUqG,MAAK,SAACnG,GAAD,OAAUA,EAAKlC,KAAO8c,EAAO9c,OADrC,kBAEf8c,EAAOta,WAAasa,EAAOxf,QAE7B,IAAK2f,EACJ,OAAOJ,EAGR,IAAMK,EAAmBL,EAAM7a,UAC7B2R,QAAO,SAACzR,GAAD,OAAUA,EAAKlC,KAAO8c,EAAO9c,MACpCgd,OAAOC,GACHE,EAA2BN,EAAMnJ,kBACrCC,QAAO,SAACzR,GAAD,OAAUA,EAAKlC,KAAO8c,EAAO9c,MACpCgd,OAAOC,GACTrd,EAAcsd,GACdtd,EAAcud,GAEd,IAAMC,EAAqBP,EAAMnO,YAAYiF,QAC5C,SAACzR,GAAD,OAAUA,EAAKlC,KAAO8c,EAAO9c,MAExBqd,EAA6BR,EAAMtN,oBAAoBoE,QAC5D,SAACzR,GAAD,OAAUA,EAAKlC,KAAO8c,EAAO9c,MAW9B,OARIid,EAAYrP,SACfwP,EAAmBrY,KAAKkY,GACxBI,EAA2BtY,KAAKkY,GAEhCF,EAAYF,EAAMha,MAAOua,GACzBL,EAAYF,EAAMha,MAAOwa,IAGnB,2BACHR,GADJ,IAEC7a,UAAWkb,EACXxO,YAAa0O,EACb1J,kBAAmByJ,EACnB5N,oBAAqB8N,IAEhB,GAAIP,EAAOvf,OAASkE,GAAc,CACxC,IAAMyb,EAAmBL,EAAM7a,UAC7B2R,QAAO,SAACzR,GAAD,OAAUA,EAAKlC,KAAO8c,EAAO9c,MACpCgd,OAAOF,EAAO5a,MACVib,EAA2BN,EAAMnJ,kBACrCC,QAAO,SAACzR,GAAD,OAAUA,EAAKlC,KAAO8c,EAAO9c,MACpCgd,OAAOF,EAAO5a,MAChBtC,EAAcsd,GACdtd,EAAcud,GAEd,IAAMC,EAAqBP,EAAMnO,YAAYiF,QAC5C,SAACzR,GAAD,OAAUA,EAAKlC,KAAO8c,EAAO9c,MAExBqd,EAA6BR,EAAMtN,oBAAoBoE,QAC5D,SAACzR,GAAD,OAAUA,EAAKlC,KAAO8c,EAAO9c,MAW9B,OARI8c,EAAO5a,KAAK0L,SACfwP,EAAmBrY,KAAK+X,EAAO5a,MAC/Bmb,EAA2BtY,KAAK+X,EAAO5a,MAEvC6a,EAAYF,EAAMha,MAAOua,GACzBL,EAAYF,EAAMha,MAAOwa,IAGnB,2BACHR,GADJ,IAEC7a,UAAWkb,EACXxO,YAAa0O,EACb1J,kBAAmByJ,EACnB5N,oBAAqB8N,IAEhB,GAAIP,EAAOvf,OAASmE,GAA2B,CACrD,GAAqB,UAAjBob,EAAOpa,MACV,OAAO,2BACHma,GADJ,IAECtN,oBAAqBsN,EAAMnO,cAG7B,IAAM4O,EAAW,aAAOR,EAAOpa,OAE/B,OADAqa,EAAYF,EAAMha,MAAOya,GAClB,2BACHT,GADJ,IAECtN,oBAAqB+N,IAEhB,GAAIR,EAAOvf,OAASoE,GAC1B,MAAqB,UAAjBmb,EAAOpa,MACH,2BACHma,GADJ,IAECnJ,kBAAmBmJ,EAAM7a,YAGpB,2BACH6a,GADJ,IAECnJ,kBAAmBoJ,EAAOpa,QAErB,GAAIoa,EAAOvf,OAASqE,GAAW,CACrC,IAAM0b,EAAW,aAAOT,EAAMnO,aACxB6O,EAAmB,aAAOV,EAAMtN,qBAItC,OAHAwN,EAAYD,EAAOja,MAAOya,GAC1BP,EAAYD,EAAOja,MAAO0a,GAEnB,2BACHV,GADJ,IAECha,MAAOia,EAAOja,MACd6L,YAAa4O,EACb/N,oBAAqBgO,IAEhB,GAAIT,EAAOvf,OAASsE,GAAgB,CAC1C,GAAIgb,EAAMha,MAAO,CAChB,IAAM2a,EAAQ,2BACVX,EAAMha,OADI,kBAEZia,EAAO9c,QACoBsZ,IAA3BuD,EAAMha,MAAMia,EAAO9c,IAChB6c,EAAMha,MAAMia,EAAO9c,IAAM,EACzB,IAECyd,EAAc,aAAOZ,EAAMnO,aAC3BgP,EAAsB,aAAOb,EAAMtN,qBAIzC,OAHAwN,EAAYS,EAAUC,GACtBV,EAAYS,EAAUE,GAEf,2BACHb,GADJ,IAECha,MAAO2a,EACP9O,YAAa+O,EACblO,oBAAqBmO,IAGtB,OAAOb,EAGR,OAAOA,GC/LHD,GAAe,CACpBlC,YAAY,EACZxS,YAAY,EACZgD,gBAAgB,EAChB9C,SAAU,MCTX,IAAMwU,GAAe,CACpB7e,SAAU,KACVE,MAAO,MCER,IAAM2e,GAAe,CACpBvI,SAAU,KACVsJ,aAAc,MAKTC,GAAe,SAACC,GACrB,IAD6C,EACvCC,EAAa,GACbC,EAAc,GAFyB,eAGvBF,GAHuB,IAG7C,2BAA2C,CAAC,IAAjCzJ,EAAgC,QAC1C2J,EAAYhZ,KAAZ,eAAsBqP,KAJsB,8BAmB7C,OAZA2J,EAAYC,SAAQ,SAAC5J,GAAD,OAAc0J,EAAW1J,EAAQpU,IAAMoU,KAE3D2J,EAAYC,SAAQ,SAAC5J,GACpB,GAAuB,OAAnBA,EAAQF,OAAiB,CAC5B,IAAMA,EAAS4J,EAAW1J,EAAQF,SACjCA,EAAO9Q,SAAW8Q,EAAO9Q,UAAY,IAAI2B,KAAKqP,OAGhC2J,EAAYpK,QAAO,SAACS,GAEpC,OAA0B,OAAnBA,EAAQF,WAQX+J,GAAe,SAACC,EAAUC,GAG/B,IAFA,IAAMC,EAAI,CAACD,GACLE,EAAW,CAACF,GACXC,EAAEzf,QAAQ,CAChB,IADgB,EACVqB,EAAKoe,EAAEE,MADG,eAEMJ,GAFN,IAEhB,2BAAgC,CAAC,IAAtB9J,EAAqB,QAC3BA,EAAQF,SAAWlU,IACtBoe,EAAErZ,KAAKqP,EAAQpU,IACfqe,EAAStZ,KAAKqP,EAAQpU,MALR,+BASjB,OAAOke,EAASvK,QAAO,SAACS,GAAD,OAA+C,IAAlCiK,EAAS9Z,QAAQ6P,EAAQpU,QCvC9D,IAAMue,GAAcC,aAAgB,CACnC9b,MAAO+b,GACPtW,aHCc,WAA8C,IAA/B0U,EAA8B,uDAAtBD,GAAcE,EAAQ,uCAC3D,OAAQA,EAAOvf,MACd,KAAKN,EACJ,OAAO,2BACH4f,GADJ,IAECnC,WAAYoC,EAAOxf,QAErB,KAAKJ,EACJ,OAAO,2BACH2f,GADJ,IAEC3U,WAAY4U,EAAOxf,QAErB,KAAKH,EACJ,OAAO,2BACH0f,GADJ,IAEC3R,eAAgB4R,EAAOxf,QAEzB,KAAKF,EACJ,OAAO,2BACHyf,GADJ,IAECzU,SAAU0U,EAAOnf,OAEnB,QACC,OAAOkf,IGvBTrV,KFPc,WAAgD,IAA/BlD,EAA8B,uDAAtBsY,GAAcE,EAAQ,uCAC7D,OAAQA,EAAOvf,MACd,KAAKK,EACJ,OAAO,2BACH0G,GADJ,IAECvG,SAAU+e,EAAO/e,WAEnB,KAAKF,EACJ,OAAO,2BACHyG,GADJ,IAECrG,MAAO6e,EAAO7e,QAEhB,QACC,OAAOqG,IELT+P,SDsCc,WAAgD,IAA/BwI,EAA8B,uDAAtBD,GAAcE,EAAQ,uCACvD3b,EAAS2b,EAAO3b,OACtB,OAAQ2b,EAAOvf,MACd,KAAKsW,GACJ,GAAKgJ,EAAMc,aAUJ,CACN,GAAKd,EAAMc,aAAaxc,GAcjB,CACN,IAAMwc,EAAY,2BACdd,EAAMc,cADQ,kBAEhBxc,EAFgB,uBAGb0b,EAAMc,aAAaxc,IAHN,aAIb2b,EAAOzI,aAINA,EAAQ,2BACVwI,EAAMxI,UADI,kBAEZlT,EAASyc,GAAaD,EAAaxc,MAErC,OAAO,2BACH0b,GADJ,IAECc,aAAcA,EACdtJ,SAAUA,IA3BX,OAAO,2BACHwI,GADJ,IAECc,aAAa,2BACTd,EAAMc,cADE,kBAEVxc,EAAS2b,EAAOzI,WAElBA,SAAS,2BACLwI,EAAMxI,UADF,kBAENlT,EAASyc,GAAad,EAAOzI,cApBjC,MAAO,CACNsJ,aAAa,eACXxc,EAAS2b,EAAOzI,UAElBA,SAAS,eACPlT,EAASyc,GAAad,EAAOzI,YAsClC,KAAKP,GACJ,IAAM4K,EAAoB,2BACtB7B,EAAMc,cADgB,kBAExBxc,EAAS8c,GAAapB,EAAMc,aAAaxc,GAAS2b,EAAO9c,MAGrD2e,EAAgB,2BAClB9B,EAAMxI,UADY,kBAEpBlT,EAASyc,GAAac,EAAqBvd,MAG7C,OAAO,2BACH0b,GADJ,IAECc,aAAce,EACdrK,SAAUsK,IAEZ,KAAK5K,GACJ,IAAMzJ,EAAUuS,EAAMc,aAAaxc,GAAQkH,MAC1C,SAAC+L,GAAD,OAAaA,EAAQpU,KAAO8c,EAAO9c,MAE9B4e,EAAU,2BACZtU,GADY,IAEf2J,SAAU6I,EAAO7I,SACjBgB,iBAAkB6H,EAAO1G,KACzBlB,QAAQ,IAIHrV,EAAOgd,EAAMc,aAAaxc,GAAQwS,QACvC,SAACS,GAAD,OAAaA,EAAQpU,KAAO8c,EAAO9c,MAEpCH,EAAKkF,KAAK6Z,GACV,IAAMC,EAAe,2BACjBhC,EAAMc,cADW,kBAEnBxc,EAAStB,IAELif,EAAW,2BACbjC,EAAMxI,UADO,kBAEflT,EAASyc,GAAa/d,KAGxB,OAAO,2BACHgd,GADJ,IAECc,aAAckB,EACdxK,SAAUyK,IAEZ,QACC,OAAOjC,MCnIJkC,GAAgB,CACrB1R,IAAK,OACL2R,QAASA,KACTC,gBAAiBC,KACjBC,UAAW,CAAC,QAAS,aAGhBC,GAAWC,aAAeN,GAAeR,IAElC1B,GAAQyC,aAAYF,GAAUG,aAAgBC,OAC9CC,GAAYC,aAAa7C,ICjBvB,SAAS8C,KAAM,MAESrc,mBACrC8G,OAAOwV,WAAW,4BAA4BC,SAHlB,mBAEtBC,EAFsB,KAETC,EAFS,KAO7B3V,OACEwV,WAAW,4BACX7U,iBAAiB,UAAU,WAC3BgV,EACC3V,OAAOwV,WAAW,4BAA4BC,YAIjD,IAAMG,EAAiE,IAAtDxV,KAAKX,IAAIO,OAAO6V,OAAOtjB,MAAOyN,OAAO6V,OAAOC,QAEvDC,EAAa,CAClBjX,MAAOhN,EACPmW,KAAM2N,EACNnjB,MAAO,CACNujB,OAAQ,YAIV,OAEC,aADA,CACC,IAAD,CAAUvD,MAAOA,GAAjB,SAEC,cAAC,IAAD,CAAa4C,UAAWA,GAAWY,QAAS,cAACzjB,EAAD,IAA5C,SAEC,cAAC,IAAD,UAEC,cAAC,IAAY0jB,SAAb,CAAsBhjB,MAAO6iB,EAA7B,SACEL,EAAc,cAAC5D,GAAD,CAAQS,YAAU,IAAM,cAACT,GAAD,YCxC7CqE,IAASC,OAAO,cAACb,GAAD,IAASphB,SAASkiB,eAAe,U,mBCJjDzkB,EAAOC,QAAU,CAAC,kBAAkB,oCAAoC,gBAAgB,kCAAkC,UAAY,8BAA8B,uBAAuB,yCAAyC,qBAAqB,uCAAuC,WAAW,6BAA6B,sBAAsB,wCAAwC,oBAAoB,sCAAsC,YAAY,8BAA8B,eAAe,iCAAiC,KAAO,2B,mBCAjiBD,EAAOC,QAAU,CAAC,MAAQ,yBAAyB,OAAS,0BAA0B,mBAAmB,oCAAoC,QAAU,2BAA2B,eAAe,gCAAgC,IAAM,uBAAuB,kBAAkB,mCAAmC,KAAO,wBAAwB,iBAAiB,kCAAkC,MAAQ,2B,mBCA7YD,EAAOC,QAAU,CAAC,mBAAmB,+BAA+B,MAAQ,oBAAoB,MAAQ,sB,kBCAxGD,EAAOC,QAAU,CAAC,eAAe,yBAAyB,gBAAgB,0BAA0B,MAAQ,kBAAkB,gBAAgB,0BAA0B,SAAW,qBAAqB,WAAW,qBAAqB,WAAW,qBAAqB,WAAW,qBAAqB,aAAa,uBAAuB,eAAe,yBAAyB,eAAe,yBAAyB,oBAAoB,8BAA8B,eAAe,yBAAyB,eAAe,yBAAyB,QAAU,oBAAoB,SAAW,qBAAqB,OAAS,mBAAmB,cAAc,0B,mBCAtoBD,EAAOC,QAAU,CAAC,SAAW,gCAAgC,KAAO,4BAA4B,kBAAkB,uCAAuC,UAAY,iCAAiC,uBAAuB,4CAA4C,MAAQ,6BAA6B,kBAAkB,uCAAuC,SAAW,kC,mBCAlXD,EAAOC,QAAU,CAAC,OAAS,uB,mBCA3BD,EAAOC,QAAU,CAAC,QAAU,yBAAyB,cAAc,6BAA6B,qBAAqB,oCAAoC,cAAc,+B,mBCAvKD,EAAOC,QAAU,CAAC,OAAS,yBAAyB,MAAQ,wBAAwB,eAAe,+BAA+B,kBAAkB,oC,mBCApJD,EAAOC,QAAU,CAAC,KAAO,6BAA6B,OAAS,iC,mBCA/DD,EAAOC,QAAU,CAAC,aAAa,gCAAgC,QAAU,+B,mBCAzED,EAAOC,QAAU,CAAC,UAAY,gCAAgC,KAAO,6B,mBCArED,EAAOC,QAAU,CAAC,UAAY,2BAA2B,MAAQ,yB,mBCAjED,EAAOC,QAAU,CAAC,KAAO,4BAA4B,OAAS,gC,mBCA9DD,EAAOC,QAAU,CAAC,UAAY,8BAA8B,QAAU,8B,mBCAtED,EAAOC,QAAU,CAAC,IAAM,2B,mBCAxBD,EAAOC,QAAU,CAAC,MAAQ,2B,mBCA1BD,EAAOC,QAAU,CAAC,KAAO,4B,mBCAzBD,EAAOC,QAAU,CAAC,MAAQ,0B,mBCA1BD,EAAOC,QAAU,CAAC,KAAO,wB,mBCAzBD,EAAOC,QAAU,CAAC,OAAS,uB","file":"static/js/main.f754ae76.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"vertical-center\":\"layout_vertical-center__tiQa7\",\"vertical-default\":\"layout_vertical-default__hwLvP\",\"horizontal-center\":\"layout_horizontal-center__2VCG0\",\"horizontal-default-start\":\"layout_horizontal-default-start__25X96\",\"horizontal-default\":\"layout_horizontal-default__1Fcnw\",\"horizontal-around\":\"layout_horizontal-around__pR6LL\",\"horizontal-between\":\"layout_horizontal-between__OAQ3D\",\"horizontal-end\":\"layout_horizontal-end__2EWcP\",\"inline-block\":\"layout_inline-block__fjtNF\",\"align-block-right\":\"layout_align-block-right__2zkoP\",\"relative\":\"layout_relative__XXHb2\",\"fixed-top\":\"layout_fixed-top__1yGL5\",\"no-margin\":\"layout_no-margin__2VFvl\",\"container\":\"layout_container__1sr8n\",\"full-width\":\"layout_full-width__joer5\"};","export const Colors = {\n\tprimary: \"#DE354C\", // Bright red\n\tprimaryLight: \"#FF7F7F\", // Lighter red\n\tdark: \"#932432\", // Blood red\n\taccent: \"#3C1874\", // Purple\n\tlight: \"#F3F3F3\", // Cloud\n\temphasis: \"#D3D3D3\", // Grey\n}","export default __webpack_public_path__ + \"static/media/loading-circle.22e2b20a.gif\";","export const styles = {\n\tcontainer: {\n\t\tposition: \"fixed\",\n\t\tfontSize: 30,\n\t\ttop: \"50vh\",\n\t\tleft: \"50vw\",\n\t\ttransform: \"translate(-50%, -50%)\",\n\t},\n\timage: {\n\t\twidth: 50,\n\t},\n};\n","import React from \"react\";\n\nimport loadingCircle from \"../../constants/images/loading-circle.gif\";\nimport { styles } from \"./LoadingCircleStyles\";\n\nexport default function LoadingCircle() {\n\treturn (\n\t\t<div style={styles.container}>\n\t\t\t<img src={loadingCircle} alt=\"Loading circle\" style={styles.image} />\n\t\t</div>\n\t);\n}\n","export const SET_FETCHING = \"SET_FETCHING\";\nexport const SET_IS_SONG_PAGE = \"SET_IS_SONG_PAGE\";\nexport const SET_IS_SONG_PAGE_VIEW = \"SET_IS_SONG_PAGE_VIEW\";\nexport const SET_SONG_LINK = \"SET_SONG_LINK\";\n\n// Whether lyrics are being API queried\nexport function setFetching(value) {\n\treturn {\n\t\ttype: SET_FETCHING,\n\t\tvalue: value,\n\t}\n}\n\n// Whether the user is currently on song page\nexport function setIsSongPage(value) {\n\treturn {\n\t\ttype: SET_IS_SONG_PAGE,\n\t\tvalue: value,\n\t}\n}\n\n// Whether the user is currently on the uneditable song page\nexport function setIsSongPageView(value) {\n\treturn {\n\t\ttype: SET_IS_SONG_PAGE_VIEW,\n\t\tvalue: value,\n\t}\n}\n\n// The current song link\nexport function setSongLink(link) {\n\treturn {\n\t\ttype: SET_SONG_LINK,\n\t\tlink: link,\n\t}\n}","export const SET_USERNAME = \"SET_USERNAME\";\nexport const SET_ADMIN = \"SET_ADMIN\";\n\nexport function setUsername(username) {\n\treturn {\n\t\ttype: SET_USERNAME,\n\t\tusername: username,\n\t}\n}\n\nexport function setAdmin(admin) {\n\tconst val = admin === null ? null : (admin === true || admin === \"True\");\n\treturn {\n\t\ttype: SET_ADMIN,\n\t\tadmin: val,\n\t}\n}","import axios from \"axios\";\nimport Cookie from \"universal-cookie\";\n\nconst cookie = new Cookie();\n\n// Get CSRF token\nexport function getToken() {\n\tlet cookieValue = null;\n\tconst name = \"csrftoken\";\n\n\tif (document.cookie && document.cookie !== \"\") {\n\t\tconst cookies = document.cookie.split(\";\");\n\t\tfor (var i = 0; i < cookies.length; i++) {\n\t\t\tconst cookie = cookies[i].trim();\n\t\t\tif (cookie.substring(0, name.length + 1) === name + \"=\") {\n\t\t\t\tcookieValue = decodeURIComponent(\n\t\t\t\t\tcookie.substring(name.length + 1)\n\t\t\t\t);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\treturn cookieValue;\n}\n\n// Get username of user\nexport async function getUsername() {\n\ttry {\n\t\t// Get username from cookie if it's there\n\t\tconst existingUsername = cookie.get(\"username\");\n\t\tif (existingUsername) {\n\t\t\treturn existingUsername;\n\t\t}\n\n\t\t// Make API call and set cookie and redux state\n\t\tconst response = await axios.get(\"/api/auth/user\", {\n\t\t\twithCredentials: true,\n\t\t});\n\t\tconst username = response.data.username;\n\t\tcookie.set(\"username\", username, { path: \"/\" });\n\n\t\treturn username;\n\t} catch (err) {\n\t\treturn null;\n\t}\n}\n\nexport async function getEmail() {\n\ttry {\n\t\t// Get username from cookie if it's there\n\t\tconst existingEmail = cookie.get(\"email\");\n\t\tif (existingEmail) {\n\t\t\treturn existingEmail;\n\t\t}\n\n\t\t// Make API call and set cookie and redux state\n\t\tconst response = await axios.get(\"/api/auth/email\", {\n\t\t\twithCredentials: true,\n\t\t});\n\t\tcookie.set(\"email\", response.data, { path: \"/\" });\n\n\t\treturn response.data;\n\t} catch (err) {\n\t\talert(\n\t\t\t\"There was an error determining your email. Please check that you are connected to a network.\"\n\t\t);\n\n\t\treturn null;\n\t}\n}\n\n// Sort songs by order of creation (e.g. id)\nexport function sortSongsById(list) {\n\tlist.sort((a, b) => a.id < b.id);\n}\n\n// Update song to database (since updating a song to redux isn't pushed to the database unless it's saved)\nexport function updateSongToDatabase(item) {\n\tconst songCopy = { ...item }\n\tdelete songCopy[\"creator\"];\n\taxios.patch(`/api/songs/${item.id}/`, songCopy, {\n\t\twithCredentials: true,\n\t\theaders: {\n\t\t\t\"Content-Type\": \"application/json\",\n\t\t\t\"X-CSRFToken\": getToken(),\n\t\t},\n\t});\n}\n\nexport function updateSongAttributeToDatabase(id, type, value) {\n\taxios.patch(\n\t\t`/api/songs/${id}/`,\n\t\t{\n\t\t\t[type]: value,\n\t\t},\n\t\t{\n\t\t\twithCredentials: true,\n\t\t\theaders: {\n\t\t\t\t\"Content-Type\": \"application/json\",\n\t\t\t\t\"X-CSRFToken\": getToken(),\n\t\t\t},\n\t\t}\n\t);\n}\n\n// Get the size of a list\nfunction sz(obj) {\n\treturn Object.keys(obj).length;\n}\n\n// Compare song lists by value to detect if changes have been made\nexport function compareSongsByValue(song1, song2) {\n\tif (!song1 || !song2) {\n\t\treturn true;\n\t}\n\tif (sz(song1) !== sz(song2)) {\n\t\treturn false;\n\t}\n\tfor (const item in song1) {\n\t\t// These values are automatically updated to the database\n\t\tif (item === \"name\" || item === \"artist\" || item === \"views\" || item === \"chords\") {\n\t\t\tcontinue;\n\t\t}\n\t\tif (song1[item] !== song2[item]) {\n\t\t\treturn false;\n\t\t}\n\t}\n\treturn true;\n}\n\n// Return whether the user has activated their email\nexport async function getActivationStatus(ignoreCookie = false) {\n\tif (!ignoreCookie && cookie.get(\"activated\")) {\n\t\treturn cookie.get(\"activated\") === \"true\";\n\t}\n\n\ttry {\n\t\tconst response = await axios.get(\"/api/auth/user\", {\n\t\t\twithCredentials: true,\n\t\t});\n\t\tconsole.log(response.data.confirmed_email);\n\t\tconst activated = response.data.confirmed_email;\n\t\tcookie.set(\"activated\", activated, { path: \"/\" });\n\n\t\treturn activated;\n\t} catch (err) {\n\t\tthrow err;\n\t}\n}\n\n// Increment view count for a particular song\nexport async function incrementViewCount(id) {\n\ttry {\n\t\tawait axios.post(\n\t\t\t\"/api/views/increment\",\n\t\t\t{\n\t\t\t\tsongId: id,\n\t\t\t},\n\t\t\t{\n\t\t\t\twithCredentials: true,\n\t\t\t\theaders: {\n\t\t\t\t\t\"Content-Type\": \"application/json\",\n\t\t\t\t\t\"X-CSRFToken\": getToken(),\n\t\t\t\t},\n\t\t\t}\n\t\t);\n\t} catch (err) {\n\t\tthrow err;\n\t}\n}\n","import axios from \"axios\";\nimport { getToken, sortSongsById } from \"../../util\";\n\nexport const ADD_SONG = \"ADD_SONG\";\nexport const GET_USER_SONGS = \"GET_USER_SONGS\";\nexport const GET_PUBLIC_SONGS = \"GET_PUBLIC_SONGS\";\nexport const DELETE_SONG = \"DELETE_SONG\";\nexport const UPDATE_SONG = \"UPDATE_SONG\";\nexport const REPLACE_SONG = \"REPLACE_SONG\";\nexport const SET_FILTERED_PUBLIC_SONGS = \"SET_FILTERED_PUBLIC_SONGS\";\nexport const SET_FILTERED_USER_SONGS = \"SET_FILTERED_USER_SONGS\";\nexport const SET_VIEWS = \"SET_VIEWS\";\nexport const INCREMENT_VIEW = \"INCREMENT_VIEW\";\n\nexport function copySong(song) {\n\treturn async (dispatch) => {\n\t\ttry {\n\t\t\tconst newSong = {\n\t\t\t\t...song,\n\t\t\t\tpublic: false,\n\t\t\t\tis_favourite: false,\n\t\t\t};\n\t\t\tdelete newSong[\"id\"];\n\t\t\tdelete newSong[\"creator\"];\n\n\t\t\tconst response = await axios.post(\"/api/songs/\", newSong, {\n\t\t\t\twithCredentials: true,\n\t\t\t\theaders: {\n\t\t\t\t\t\"X-CSRFToken\": getToken(),\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tdispatch({\n\t\t\t\ttype: ADD_SONG,\n\t\t\t\tsong: response.data,\n\t\t\t});\n\t\t} catch (err) {\n\t\t\talert('Song could not be copied');\n\t\t}\n\t};\n}\n\nexport function getUserSongs() {\n\treturn async (dispatch) => {\n\t\ttry {\n\t\t\tconst response = await axios.get(\"/api/songs/\", {\n\t\t\t\twithCredentials: true,\n\t\t\t});\n\n\t\t\tconst userSongs = response.data;\n\t\t\tsortSongsById(userSongs);\n\n\t\t\tdispatch({\n\t\t\t\ttype: GET_USER_SONGS,\n\t\t\t\tuserSongs: userSongs,\n\t\t\t});\n\t\t} catch (err) {\n\t\t\talert('There was an error getting your songs.')\n\t\t\tthrow err;\n\t\t}\n\t};\n}\n\nexport function getPublicSongs() {\n\treturn async (dispatch) => {\n\t\ttry {\n\t\t\tconst response = await axios.get(\"/api/songs/public\", {\n\t\t\t\twithCredentials: true,\n\t\t\t});\n\n\t\t\tconst publicSongs = response.data;\n\t\t\tdispatch({\n\t\t\t\ttype: GET_PUBLIC_SONGS,\n\t\t\t\tpublicSongs: publicSongs,\n\t\t\t});\n\t\t} catch (err) {\n\t\t\talert('There was an error getting public songs.')\n\t\t\tthrow err;\n\t\t}\n\t};\n}\n\nexport function addSong(username) {\n\treturn async (dispatch) => {\n\t\ttry {\n\t\t\tconst response = await axios.post(\n\t\t\t\t\"/api/songs/\",\n\t\t\t\t{},\n\t\t\t\t{\n\t\t\t\t\twithCredentials: true,\n\t\t\t\t\theaders: {\n\t\t\t\t\t\t\"X-CSRFToken\": getToken(),\n\t\t\t\t\t},\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tdispatch({\n\t\t\t\ttype: ADD_SONG,\n\t\t\t\tsong: response.data,\n\t\t\t});\n\n\t\t\tlocalStorage.removeItem(username);\n\t\t} catch (err) {\n\t\t\talert(\"Failed to add song.\")\n\t\t\tthrow err;\n\t\t}\n\t};\n}\n\nexport function deleteSong(id) {\n\treturn async (dispatch) => {\n\t\ttry {\n\t\t\tdispatch({\n\t\t\t\ttype: DELETE_SONG,\n\t\t\t\tid: id,\n\t\t\t});\n\n\t\t\taxios.delete(`/api/songs/${id}/`, {\n\t\t\t\twithCredentials: true,\n\t\t\t\theaders: {\n\t\t\t\t\t\"X-CSRFToken\": getToken(),\n\t\t\t\t},\n\t\t\t});\n\t\t} catch (err) {\n\t\t\talert('There was an error deleting the song.')\n\t\t\tthrow err;\n\t\t}\n\t};\n}\n\nexport function updateSong(id, type, value) {\n\treturn {\n\t\ttype: UPDATE_SONG,\n\t\tid: id,\n\t\tupdateType: type,\n\t\tvalue: value,\n\t};\n}\n\nexport function replaceSong(id, song) {\n\treturn {\n\t\ttype: REPLACE_SONG,\n\t\tid: id,\n\t\tsong: song,\n\t};\n}\n\nexport function setFilteredPublicSongs(songs) {\n\treturn {\n\t\ttype: SET_FILTERED_PUBLIC_SONGS,\n\t\tsongs: songs,\n\t};\n}\n\nexport function setFilteredUserSongs(songs) {\n\treturn {\n\t\ttype: SET_FILTERED_USER_SONGS,\n\t\tsongs: songs,\n\t};\n}\n\nexport function setViews(views) {\n\treturn {\n\t\ttype: SET_VIEWS,\n\t\tviews: views,\n\t};\n}\n\nexport function incrementView(id) {\n\treturn {\n\t\ttype: INCREMENT_VIEW,\n\t\tid: id,\n\t};\n}\n","import React from \"react\";\n\nimport styles from \"./ButtonStyle.module.css\";\n\nexport default function Button(props) {\n\tconst { className } = props;\n\n\treturn (\n\t\t<button onClick={props.onClick} className={`${styles.btn} ${className}`}>\n\t\t\t{props.children}\n\t\t</button>\n\t);\n}\n","import axios from \"axios\";\nimport React, { useState } from \"react\";\nimport Cookie from \"universal-cookie\";\nimport { useDispatch } from \"react-redux\";\nimport { useHistory } from \"react-router\";\n\nimport * as authActions from \"../../store/actions/authActions\";\nimport * as songsActions from \"../../store/actions/songsActions\";\nimport { getToken } from \"../../util\";\nimport LoadingCircle from \"../../components/LoadingCircle/LoadingCircle\";\nimport Button from \"../../components/Button/Button\";\nimport layout from \"../../styles/layout.module.css\";\nimport ui from \"../../styles/ui.module.css\";\nimport styles from \"./Auth.module.css\";\n\nconst cookie = new Cookie();\n\naxios.defaults.xsrfCookieName = \"csrftoken\";\naxios.defaults.xsrfHeaderName = \"X-CSRFToken\";\n\nexport default function Auth() {\n\tconst [username, setUsername] = useState(\"\");\n\tconst [email, setEmail] = useState(\"\");\n\tconst [password, setPassword] = useState(\"\");\n\tconst [repeatedPassword, setRepeatedPassword] = useState(\"\");\n\tconst [login, setLogin] = useState(true);\n\tconst [isLoading, setIsLoading] = useState(false);\n\n\tconst dispatch = useDispatch();\n\tconst history = useHistory();\n\n\t// Forgot password handler\n\tconst forgotPasswordHandler = () => {\n\t\thistory.push(\"/accounts/password-reset\");\n\t};\n\n\t// On switch between login and sign up\n\tconst switchModeHandler = (e) => {\n\t\te.preventDefault();\n\t\tsetLogin((state) => !state);\n\n\t\tif (login && username.indexOf(\"@\") > -1) {\n\t\t\tsetEmail(username);\n\t\t\tsetUsername(\"\");\n\t\t} else if (!login && !username && email) {\n\t\t\tsetUsername(email);\n\t\t}\n\n\t\thistory.replace(login ? \"/accounts/signup\" : \"/accounts/login\");\n\t};\n\n\t// Submit handler (login or sign up)\n\tasync function submitHandler(event) {\n\t\tevent.preventDefault();\n\t\tawait axios.get(\"/api/auth/csrf\", {\n\t\t\twithCredentials: true,\n\t\t});\n\n\t\tconst state = login ? \"login\" : \"signup\";\n\n\t\t// Check that passwords match\n\t\tif (state === \"signup\" && repeatedPassword !== password) {\n\t\t\talert(\"Your passwords don't match. Please try again.\");\n\t\t\treturn;\n\t\t}\n\n\t\t// Check that email address is valid\n\t\tif (state === \"signup\" && email.indexOf(\"@\") === -1) {\n\t\t\talert(\"Invalid email address. Please try again.\");\n\t\t\treturn;\n\t\t}\n\n\t\t// Check that username is not a keyword\n\t\tconst keywordList = [\"accounts\", \"songs\", \"help\", \"user\", \"api\"];\n\t\tif (keywordList.indexOf(username) > -1) {\n\t\t\talert(\"The given username cannot be used. Please try again.\");\n\t\t\treturn;\n\t\t}\n\n\t\ttry {\n\t\t\tsetIsLoading(true);\n\n\t\t\tconst response =\n\t\t\t\tstate === \"signup\"\n\t\t\t\t\t? await axios.post(\n\t\t\t\t\t\t\t`/api/auth/${state}`,\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tusername: username,\n\t\t\t\t\t\t\t\temail: email,\n\t\t\t\t\t\t\t\tpassword: password,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\twithCredentials: true,\n\t\t\t\t\t\t\t\theaders: {\n\t\t\t\t\t\t\t\t\t\"X-CSRFToken\": getToken(),\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t}\n\t\t\t\t\t  )\n\t\t\t\t\t: await axios.post(\n\t\t\t\t\t\t\t`/api/auth/${state}`,\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tusername: username,\n\t\t\t\t\t\t\t\tpassword: password,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\twithCredentials: true,\n\t\t\t\t\t\t\t\theaders: {\n\t\t\t\t\t\t\t\t\t\"X-CSRFToken\": getToken(),\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t}\n\t\t\t\t\t  );\n\t\t\t// Login successful or signup successful respectively; set username\n\t\t\tconsole.log(response.data);\n\t\t\tconst queriedUsername = response.data.username;\n\t\t\tconst queriedEmail = response.data.email;\n\t\t\tconst queriedAdmin = response.data.is_superuser;\n\t\t\tconst queriedActivated = response.data.confirmed_email;\n\n\t\t\tcookie.set(\"username\", queriedUsername, { path: \"/\" });\n\t\t\tcookie.set(\"email\", queriedEmail, { path: \"/\" });\n\t\t\tcookie.set(\"activated\", queriedActivated, { path: \"/\" });\n\n\t\t\tdispatch(authActions.setUsername(queriedUsername));\n\t\t\tdispatch(authActions.setAdmin(queriedAdmin));\n\n\t\t\t// Get the new user's songs\n\t\t\tdispatch(songsActions.getUserSongs());\n\t\t\tsetIsLoading(false);\n\n\t\t\tif (login) {\n\t\t\t\thistory.push(`/songs/${queriedUsername}`);\n\t\t\t} else {\n\t\t\t\thistory.push(\"/accounts/confirm-email\");\n\t\t\t}\n\t\t} catch (err) {\n\t\t\tsetIsLoading(false);\n\t\t\tlet message = \"There was an error handling your credentials.\";\n\t\t\tif (err.response && err.response.data) {\n\t\t\t\tmessage = err.response.data;\n\t\t\t}\n\t\t\talert(message);\n\t\t}\n\t}\n\n\treturn (\n\t\t<div className={layout.container}>\n\t\t\t{isLoading && <LoadingCircle />}\n\n\t\t\t<div>\n\t\t\t\t<h1 className={ui.title}>{login ? \"Login\" : \"Sign Up\"}</h1>\n\t\t\t\t<form>\n\t\t\t\t\t{/* Username */}\n\t\t\t\t\t<label className={styles.label} htmlFor=\"username\">\n\t\t\t\t\t\t{login ? \"Username/Email\" : \"Username\"}\n\t\t\t\t\t</label>\n\t\t\t\t\t<br />\n\t\t\t\t\t<input\n\t\t\t\t\t\tid=\"username\"\n\t\t\t\t\t\tclassName={styles.field}\n\t\t\t\t\t\tvalue={username}\n\t\t\t\t\t\tonChange={(e) => setUsername(e.target.value)}\n\t\t\t\t\t/>\n\t\t\t\t\t<br />\n\n\t\t\t\t\t{!login && (\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<label className={styles.label} htmlFor=\"email\">\n\t\t\t\t\t\t\t\tEmail\n\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t<br />\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\tid=\"email\"\n\t\t\t\t\t\t\t\tclassName={styles.field}\n\t\t\t\t\t\t\t\tvalue={email}\n\t\t\t\t\t\t\t\tonChange={(e) => setEmail(e.target.value)}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<br />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\n\t\t\t\t\t{/* Password */}\n\t\t\t\t\t<label className={styles.label} htmlFor=\"password\">\n\t\t\t\t\t\tPassword\n\t\t\t\t\t</label>\n\t\t\t\t\t<br />\n\t\t\t\t\t<input\n\t\t\t\t\t\ttype=\"password\"\n\t\t\t\t\t\tid=\"password\"\n\t\t\t\t\t\tclassName={styles.field}\n\t\t\t\t\t\tvalue={password}\n\t\t\t\t\t\tonChange={(e) => setPassword(e.target.value)}\n\t\t\t\t\t/>\n\t\t\t\t\t<br />\n\n\t\t\t\t\t{/* Repeated password */}\n\t\t\t\t\t{!login && (\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<label\n\t\t\t\t\t\t\t\tclassName={styles.label}\n\t\t\t\t\t\t\t\thtmlFor=\"repeated-password\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tRe-enter your password\n\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t<br />\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\ttype=\"password\"\n\t\t\t\t\t\t\t\tid=\"repeated-password\"\n\t\t\t\t\t\t\t\tclassName={styles.field}\n\t\t\t\t\t\t\t\tvalue={repeatedPassword}\n\t\t\t\t\t\t\t\tonChange={(e) =>\n\t\t\t\t\t\t\t\t\tsetRepeatedPassword(e.target.value)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<br />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\n\t\t\t\t\t{/* Buttons */}\n\t\t\t\t\t<div className={styles[\"button-container\"]}>\n\t\t\t\t\t\t<Button onClick={submitHandler}>Submit</Button>\n\t\t\t\t\t\t<Button onClick={switchModeHandler}>\n\t\t\t\t\t\t\tSwitch to {login ? \"Sign up\" : \"Login\"}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t{login && (\n\t\t\t\t\t\t<p\n\t\t\t\t\t\t\tclassName={`${ui[\"small-text\"]} ${ui.pointer}`}\n\t\t\t\t\t\t\tonClick={forgotPasswordHandler}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tForgot your password?\n\t\t\t\t\t\t</p>\n\t\t\t\t\t)}\n\t\t\t\t</form>\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n","import React, { useState, useEffect } from \"react\";\nimport { useHistory } from \"react-router\";\n\nimport LoadingCircle from \"../../components/LoadingCircle/LoadingCircle\";\nimport { getEmail, getUsername, getActivationStatus } from \"../../util\";\nimport axios from \"axios\";\nimport Button from \"../../components/Button/Button\";\nimport ui from \"../../styles/ui.module.css\";\nimport layout from \"../../styles/layout.module.css\";\n\nexport default function ConfirmEmail() {\n\tconst [email, setEmail] = useState();\n\tconst [determiningActivated, setDeterminingActivated] = useState(false);\n\n\tconst history = useHistory();\n\n\tuseEffect(() => {\n\t\tconst emailQuery = async () => {\n\t\t\tconst queriedEmail = await getEmail();\n\t\t\tsetEmail(queriedEmail);\n\t\t};\n\n\t\tif (!email) {\n\t\t\temailQuery();\n\t\t}\n\t}, [email]);\n\n\tconst activationHandler = async () => {\n\t\tsetDeterminingActivated(true);\n\t\ttry {\n\t\t\tconst activated = await getActivationStatus(true);\n\n\t\t\tif (activated) {\n\t\t\t\tconst username = await getUsername();\n\t\t\t\thistory.push(`/songs/${username}`);\n\t\t\t} else {\n\t\t\t\talert(\"Oops! Your account isn't activated yet!\");\n\t\t\t}\n\t\t} catch (err) {\n\t\t\talert(\"Could not get activated status.\");\n\t\t}\n\t\tsetDeterminingActivated(false);\n\t};\n\n\tconst resendHandler = () => {\n\t\ttry {\n\t\t\taxios.get(\"/api/auth/email/resend-activation\", {\n\t\t\t\twithCredentials: true,\n\t\t\t});\n\t\t\talert(\"Email was resent!\");\n\t\t} catch (err) {\n\t\t\talert(\"There was an error resending the email.\");\n\t\t}\n\t};\n\n\treturn (\n\t\t<div className={layout.container}>\n\t\t\t{(!email || determiningActivated) && <LoadingCircle />}\n\t\t\t<h2 className={ui.subtitle}>Your account is unactivated!</h2>\n\t\t\t<p className={ui[\"plain-h4\"]}>\n\t\t\t\tAn activation link has been sent to your inbox at&nbsp;\n\t\t\t\t<span className={ui.emphasis}>{email}</span>. Once you've\n\t\t\t\tpressed the link, click the button below to get started!\n\t\t\t</p>\n\t\t\t<div className={layout[\"horizontal-around\"]}>\n\t\t\t\t<Button onClick={activationHandler}>Done!</Button>\n\t\t\t\t<Button onClick={resendHandler}>Resend Email</Button>\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n","import React, { useState } from \"react\";\nimport styles from \"./DropMenu.module.css\";\nimport ui from \"../../styles/ui.module.css\";\nimport layout from \"../../styles/layout.module.css\";\n\nexport default function DropMenu(props) {\n\tconst [menuOpen, setMenuOpen] = useState(false);\n\n\tconst menuOpenHandler = () => {\n\t\tsetMenuOpen(true);\n\t};\n\n\tconst menuCloseHandler = () => {\n\t\tsetMenuOpen(false);\n\t};\n\n\t// Sample item:\n\t// { text: \"Blah\", onClick: () => console.log(\"Clicked\"), condition: isAdmin }\n\tconst menuOption = (item, idx) => {\n\t\treturn (\n\t\t\t<div\n\t\t\t\tkey={idx}\n\t\t\t\tonClick={item.onClick}\n\t\t\t\tclassName={\n\t\t\t\t\tprops.white\n\t\t\t\t\t\t? styles[\"white-option\"]\n\t\t\t\t\t\t: styles[\"dropdown-option\"]\n\t\t\t\t}\n\t\t\t>\n\t\t\t\t{item.text}\n\t\t\t</div>\n\t\t);\n\t};\n\n\treturn (\n\t\t<div\n\t\t\tclassName={`${layout[\"vertical-center\"]} ${layout[\"inline-block\"]} ${layout.relative}`}\n\t\t\tonMouseEnter={menuOpenHandler}\n\t\t\tonMouseLeave={menuCloseHandler}\n\t\t>\n\t\t\t<div className={`${ui[\"nav-bar-link\"]} ${ui[\"nav-bar-hover\"]}`}>\n\t\t\t\t{props.title}\n\t\t\t</div>\n\t\t\t<div className={`${layout[\"vertical-center\"]} ${styles.option}`}>\n\t\t\t\t{menuOpen &&\n\t\t\t\t\tprops.items &&\n\t\t\t\t\tprops.items.map(\n\t\t\t\t\t\t(item, idx) => item.condition && menuOption(item, idx)\n\t\t\t\t\t)}\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n","import React, { useEffect, useState } from \"react\";\nimport axios from \"axios\";\nimport Cookie from \"universal-cookie\";\nimport { useHistory } from \"react-router\";\nimport { useDispatch, useSelector } from \"react-redux\";\n\nimport * as authActions from \"../../store/actions/authActions\";\nimport DropMenu from \"../DropMenu/DropMenu\";\nimport { getToken, getUsername } from \"../../util\";\nimport styles from \"./LogoutButton.module.css\";\nimport design from \"../../styles/ui.module.css\";\nimport LoadingCircle from \"../LoadingCircle/LoadingCircle\";\nimport ui from \"../../styles/ui.module.css\";\n\nconst cookie = new Cookie();\n\nexport default function LogoutButton(props) {\n\tconst username = useSelector((state) => state.auth.username);\n\tconst [isLoggingOut, setIsLoggingOut] = useState(false);\n\n\tconst history = useHistory();\n\tconst dispatch = useDispatch();\n\n\t// Redirect to profile page\n\tconst profileRedirectHandler = () => {\n\t\thistory.push(`/user/${username}`);\n\t};\n\n\t// Get username\n\tuseEffect(() => {\n\t\tif (!username) {\n\t\t\tgetUsername();\n\t\t}\n\t}, [username]);\n\n\t// Remove values from cookies, dispatch to redux, and send to backend\n\tconst logoutHandler = async () => {\n\t\tcookie.remove(\"username\");\n\t\tcookie.remove(\"email\");\n\t\tcookie.remove(\"activated\");\n\n\t\tsetIsLoggingOut(true);\n\t\ttry {\n\t\t\tawait axios.post(\n\t\t\t\t\"/api/auth/logout\",\n\t\t\t\t{},\n\t\t\t\t{\n\t\t\t\t\twithCredentials: true,\n\t\t\t\t\theaders: {\n\t\t\t\t\t\t\"X-CSRFToken\": getToken(),\n\t\t\t\t\t},\n\t\t\t\t}\n\t\t\t);\n\t\t\tdispatch(authActions.setAdmin(null));\n\t\t\tdispatch(authActions.setUsername(null));\n\n\t\t\thistory.push(\"/accounts/login\");\n\t\t} catch (err) {\n\t\t\talert(\"There was an error logging out.\");\n\t\t\tsetIsLoggingOut(false);\n\t\t}\n\t};\n\n\tconst items = [\n\t\t{\n\t\t\ttext: <div>Logout here.</div>,\n\t\t\tonClick: () => logoutHandler(),\n\t\t\tcondition: true,\n\t\t},\n\t];\n\n\tconst welcome = () => (\n\t\t<div onClick={profileRedirectHandler}>\n\t\t\tWelcome&nbsp;&nbsp;\n\t\t\t<span className={ui.emphasis}>{username}</span>.\n\t\t</div>\n\t);\n\n\t// If horizontal navbar\n\tlet content = <DropMenu title={welcome()} items={items} />;\n\n\t// If sidebar\n\tif (!props.full) {\n\t\tcontent = (\n\t\t\t<div className={styles.container}>\n\t\t\t\t<span\n\t\t\t\t\tclassName={`${design.emphasis} ${design.pointer} ${styles.name}`}\n\t\t\t\t\tonClick={profileRedirectHandler}\n\t\t\t\t>\n\t\t\t\t\t{username}\n\t\t\t\t</span>\n\t\t\t\t<span\n\t\t\t\t\tonClick={logoutHandler}\n\t\t\t\t\tclassName={`${design.pointer} ${ui[\"plain-h4\"]}`}\n\t\t\t\t>\n\t\t\t\t\tLogout here.\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t);\n\t}\n\n\treturn (\n\t\t<div>\n\t\t\t{isLoggingOut && <LoadingCircle />}\n\t\t\t{content}\n\t\t</div>\n\t);\n}\n","import React from \"react\";\nimport axios from \"axios\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { useHistory } from \"react-router\";\n\nimport * as songsActions from \"../../store/actions/songsActions\";\nimport * as selectedSongActions from \"../../store/actions/selectedSongActions\";\nimport DropMenu from \"../DropMenu/DropMenu\";\n\nexport default function Options() {\n\tconst isSongPage = useSelector((state) => state.selectedSong.isSongPage);\n\tconst songLink = useSelector((state) => state.selectedSong.songLink);\n\n\tconst selectedSong = useSelector((state) => {\n\t\tif (state.songs.userSongs) {\n\t\t\treturn state.songs.userSongs.find((song) => song.id === +songLink);\n\t\t} else {\n\t\t\treturn [];\n\t\t}\n\t});\n\n\tconst history = useHistory();\n\tconst dispatch = useDispatch();\n\n\t// Web scrape lyrics and dispatch to redux\n\tconst getLyrics = async () => {\n\t\ttry {\n\t\t\tdispatch(selectedSongActions.setFetching(true));\n\n\t\t\tconst response = await axios.get(\n\t\t\t\t`/api/songs/${selectedSong.id}/lyrics/`\n\t\t\t);\n\t\t\tconst pulledLyrics = response.data.trim();\n\t\t\tdispatch(\n\t\t\t\tsongsActions.updateSong(\n\t\t\t\t\tselectedSong.id,\n\t\t\t\t\t\"pulled_lyrics\",\n\t\t\t\t\tpulledLyrics\n\t\t\t\t)\n\t\t\t);\n\t\t} catch (err) {\n\t\t\tconst errorText = err.response\n\t\t\t\t? err.response.data\n\t\t\t\t: \"An error occurred.\";\n\t\t\tdispatch(\n\t\t\t\tsongsActions.updateSong(\n\t\t\t\t\tselectedSong.id,\n\t\t\t\t\t\"pulled_lyrics\",\n\t\t\t\t\terrorText\n\t\t\t\t)\n\t\t\t);\n\t\t} finally {\n\t\t\tdispatch(selectedSongActions.setFetching(false));\n\t\t}\n\t};\n\n\t// On lyric transfer, push new lyrics to redux state\n\tconst transferLyricsHandler = () => {\n\t\tconst lyrics = selectedSong.pulled_lyrics;\n\t\tdispatch(songsActions.updateSong(selectedSong.id, \"lyrics\", lyrics));\n\t};\n\n\t// On help, redirect to help page\n\tconst helpRedirectHandler = () => {\n\t\thistory.push(\"/help\");\n\t};\n\n\tconst items = [\n\t\t{\n\t\t\ttext: \"Fetch Lyrics\",\n\t\t\tonClick: () => getLyrics(),\n\t\t\tcondition: isSongPage,\n\t\t},\n\t\t{\n\t\t\ttext: \"Transfer Lyrics\",\n\t\t\tonClick: () => transferLyricsHandler(),\n\t\t\tcondition: isSongPage,\n\t\t},\n\t\t{\n\t\t\ttext: \"Help\",\n\t\t\tonClick: () => helpRedirectHandler(),\n\t\t\tcondition: true,\n\t\t},\n\t];\n\n\treturn <DropMenu title=\"Options\" items={items} />;\n}\n","import React from \"react\";\nimport { Slider } from \"@material-ui/core\";\nimport { ThemeProvider, createMuiTheme } from \"@material-ui/core/styles\";\nimport { Colors } from \"../../constants/Colors\";\n\nconst theme = createMuiTheme({\n\toverrides: {\n\t\tMuiSlider: {\n\t\t\tthumb: {\n\t\t\t\tcolor: Colors.accent,\n\t\t\t},\n\t\t\ttrack: {\n\t\t\t\tcolor: Colors.primary,\n\t\t\t},\n\t\t\trail: {\n\t\t\t\tcolor: \"black\",\n\t\t\t},\n\t\t},\n\t},\n});\n\nexport default function CustomSlider(props) {\n\tconst { existingValue, onChangeCommitted } = props;\n\n\tconst sliderStyles = {\n\t\twidth: \"100%\",\n\t}\n\n\treturn (\n\t\t<ThemeProvider theme={theme}>\n\t\t\t<Slider\n\t\t\t\tonChangeCommitted={onChangeCommitted}\n\t\t\t\tstyle={sliderStyles}\n\t\t\t\tdefaultValue={existingValue ?? 3}\n\t\t\t\tstep={1}\n\t\t\t\tmarks\n\t\t\t\tmin={1}\n\t\t\t\tmax={5}\n\t\t\t/>\n\t\t</ThemeProvider>\n\t);\n}\n","import React, { useRef } from \"react\";\n\nimport CustomSlider from \"../CustomSlider/CustomSlider\";\nimport DropMenu from \"../DropMenu/DropMenu\";\n\nexport default function AutoScroll() {\n\tconst scrollTimeout = useRef();\n\tconst scrollSpeed = useRef(3);\n\n\t// On slider release, change the current speed and start scrolling\n\tconst sliderChangeHandler = (_, val) => {\n\t\tscrollSpeed.current = val;\n\t\tpageScroll();\n\t\twindow.addEventListener(\"mousemove\", clearTimeoutHandler);\n\t};\n\n\t// Recursive page scroll method\n\tconst pageScroll = () => {\n\t\twindow.scrollBy(0, 1);\n\t\tscrollTimeout.current = setTimeout(\n\t\t\tpageScroll,\n\t\t\t90 / Math.sqrt(scrollSpeed.current)\n\t\t);\n\t};\n\n\t// Clear scroll timeout\n\tconst clearTimeoutHandler = () => {\n\t\tclearTimeout(scrollTimeout.current);\n\t\twindow.removeEventListener(\"mousemove\", clearTimeoutHandler);\n\t};\n\n\tconst items = [\n\t\t{\n\t\t\ttext: (\n\t\t\t\t<CustomSlider\n\t\t\t\t\tonChangeCommitted={sliderChangeHandler}\n\t\t\t\t\texistingValue={scrollSpeed.current}\n\t\t\t\t/>\n\t\t\t),\n\t\t\tonClick: () => {},\n\t\t\tcondition: true,\n\t\t},\n\t];\n\n\treturn <DropMenu title=\"Auto Scroll\" items={items} white />;\n}\n","import React from \"react\";\nimport { Link } from \"react-router-dom\";\nimport { useSelector } from \"react-redux\";\n\nimport ui from \"../../styles/ui.module.css\";\nimport styles from \"./NavContent.module.css\";\nimport LogoutButton from \"../LogoutButton/LogoutButton\";\nimport Options from \"../Options/Options\";\nimport AutoScroll from \"../AutoScroll/AutoScroll\";\n\nexport default function NavContent(props) {\n\tconst username = useSelector((state) => state.auth.username);\n\tconst isSongPage = useSelector((state) => state.selectedSong.isSongPage);\n\tconst isAdmin = useSelector((state) => state.auth.admin);\n\tconst isSongPageView = useSelector(\n\t\t(state) => state.selectedSong.isSongPageView\n\t);\n\n\t// Prop direction-dependent styles\n\tconst containerStyle =\n\t\tstyles.container +\n\t\t\" \" +\n\t\t(props.direction === \"row\"\n\t\t\t? styles[\"container-horizontal\"]\n\t\t\t: styles[\"container-vertical\"]);\n\tconst leftDivStyle =\n\t\tstyles[\"left-div\"] +\n\t\t\" \" +\n\t\t(props.direction === \"row\"\n\t\t\t? styles[\"left-div-horizontal\"]\n\t\t\t: styles[\"left-div-vertical\"]);\n\n\tconst linkStyle =\n\t\tui[\"nav-bar-link\"] +\n\t\t\" \" +\n\t\tui[\"nav-bar-hover\"] +\n\t\t\" \" +\n\t\t(props.direction === \"row\"\n\t\t\t? styles[\"link-horizontal\"]\n\t\t\t: styles[\"link-vertical\"]);\n\n\tconst loginStyle =\n\t\tui[\"nav-bar-link\"] +\n\t\t\" \" +\n\t\t(props.direction === \"row\"\n\t\t\t? styles[\"login-row\"]\n\t\t\t: styles[\"login-column\"]);\n\n\tlet content = (\n\t\t<div className={containerStyle}>\n\t\t\t<div className={leftDivStyle}>\n\t\t\t\t{!username && (\n\t\t\t\t\t<Link to=\"/\" className={linkStyle}>\n\t\t\t\t\t\tHome\n\t\t\t\t\t</Link>\n\t\t\t\t)}\n\n\t\t\t\t{/* Only show SongList if user is logged in  */}\n\t\t\t\t{username && (\n\t\t\t\t\t<Link to={`/songs/${username}`} className={linkStyle}>\n\t\t\t\t\t\tSong List\n\t\t\t\t\t</Link>\n\t\t\t\t)}\n\n\t\t\t\t<Link to=\"/songs/public\" className={linkStyle}>\n\t\t\t\t\tPublic\n\t\t\t\t</Link>\n\n\t\t\t\t{isAdmin && (\n\t\t\t\t\t<Link to=\"/songs/all\" className={linkStyle}>\n\t\t\t\t\t\tAdmin\n\t\t\t\t\t</Link>\n\t\t\t\t)}\n\n\t\t\t\t{props.direction === \"row\" && <Options />}\n\n\t\t\t\t{/* Only show autoscroll if horizontal nav bar and the user is on a song page */}\n\t\t\t\t{(isSongPage || isSongPageView) &&\n\t\t\t\t\tprops.direction === \"row\" && <AutoScroll />}\n\t\t\t</div>\n\n\t\t\t<div>\n\t\t\t\t{username ? (\n\t\t\t\t\t<LogoutButton full={props.direction === \"row\"} />\n\t\t\t\t) : (\n\t\t\t\t\t<Link to=\"/accounts/login\" className={loginStyle}>\n\t\t\t\t\t\tLogin\n\t\t\t\t\t</Link>\n\t\t\t\t)}\n\t\t\t</div>\n\t\t</div>\n\t);\n\n\treturn isSongPageView && props.direction === \"row\" ? (\n\t\t<div>\n\t\t\t{content}\n\t\t\t<div className={styles.view}>View Only Mode</div>\n\t\t</div>\n\t) : (\n\t\tcontent\n\t);\n}\n","import React from \"react\";\nimport Sidebar from \"react-sidebar\";\n\nimport NavContent from \"../NavContent/NavContent\";\n\nexport default function CustomSideBar(props) {\n\tconst content = (\n\t\t<NavContent\n\t\t\tdirection=\"column\"\n\t\t/>\n\t);\n\n\treturn (\n\t\t<Sidebar\n\t\t\tsidebar={content}\n\t\t\topen={props.menuOpen}\n\t\t\tonSetOpen={props.changeSidebar}\n\t\t>\n\t\t\t<div>\n\t\t\t\t{props.children}\n\t\t\t</div>\n\t\t</Sidebar>\n\t);\n}\n","import React from \"react\";\n\nexport default function SongPage() {\n\treturn <p>Error finding page. Please try again later.</p>;\n}\n","import React from \"react\";\n\nimport styles from \"./Help.module.css\";\nimport layout from \"../../styles/layout.module.css\";\nimport ui from \"../../styles/ui.module.css\";\n\nexport default function Help() {\n\treturn (\n\t\t<div className={layout.container}>\n\t\t\t<h1 className={ui.title}>Help Page</h1>\n\t\t\t<h2 className={ui.subtitle}>Song List Page</h2>\n\t\t\t<div className={styles.border}>\n\t\t\t\t<div>\n\t\t\t\t\tYou can find your Song List by clicking on the&nbsp;\n\t\t\t\t\t<span className={ui.italic}>Song List</span> section of the\n\t\t\t\t\tnavigation bar. You can add a song by pressing the&nbsp;\n\t\t\t\t\t<span className={ui.italic}>ADD SONG</span> button in the top\n\t\t\t\t\tright corner, delete a song by pressing the trash can,\n\t\t\t\t\ttoggle the public visibility by pressing the eye, and start\n\t\t\t\t\tmaking your songsheet by pressing the arrow at the right!{\" \"}\n\t\t\t\t</div>\n\t\t\t\t<br />\n\t\t\t\t<div>\n\t\t\t\t\tYou can also filter your songs by pressing the mangifiying\n\t\t\t\t\tglass near the top left!\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<h2 className={ui.subtitle}>Song Page</h2>\n\t\t\t<div className={styles.border}>\n\t\t\t\t<div>\n\t\t\t\t\tThe song page can be reached by pressing the right arrow on\n\t\t\t\t\tany one of your songs! Start by typing the name and artist\n\t\t\t\t\tof your song at the top of the page. In the options dropdown\n\t\t\t\t\tmenu in the navigation bar, selecting&nbsp;\n\t\t\t\t\t<span className={ui.italic}>Fetching Lyrics</span> will fetch\n\t\t\t\t\tthe lyrics of the song and artist you've inputted. The\n\t\t\t\t\tfetched lyrics will appear in the&nbsp;\n\t\t\t\t\t<span className={ui.italic}>Pulled Lyrics</span> section of the\n\t\t\t\t\tpage. If the lyrics of your song cannot be fetched, another\n\t\t\t\t\toption is to type or copy the lyrics directly into the&nbsp;\n\t\t\t\t\t<span className={ui.italic}>Pulled Lyrics</span> section of the\n\t\t\t\t\tpage.\n\t\t\t\t</div>\n\t\t\t\t<br />\n\t\t\t\t<div>\n\t\t\t\t\tThen, use the&nbsp;\n\t\t\t\t\t<span className={ui.italic}>Transfer Lyrics</span> option to\n\t\t\t\t\tmove the pulled lyrics to the{\" \"}\n\t\t\t\t\t<span className={ui.italic}>Lyrics section</span>, where you\n\t\t\t\t\tcan then enter chords over each line.\n\t\t\t\t</div>\n\t\t\t\t<br />\n\t\t\t\t<div>\n\t\t\t\t\tBy default, you will be in regular mode. To switch, press\n\t\t\t\t\tthe copy button on the left—the second icon down. Here, you\n\t\t\t\t\tcan quickly manipulate chords by copying or deleting. To\n\t\t\t\t\tselect a chord to manipulate, simply click on its box. To\n\t\t\t\t\tselect a sequence of inputs, click on an input to denote the\n\t\t\t\t\tstarting point (highlighted in dark red), then press on the\n\t\t\t\t\tend input box while holding the ALT (on Windows) or OPTION\n\t\t\t\t\tkey (on Mac). The toolbar can be found at the bottom of the\n\t\t\t\t\tpage. To delete, simply choose the EMPTY option. To copy,\n\t\t\t\t\tchoose the COPY or COPY UNTIL END option. Then, select the\n\t\t\t\t\tfirst of the destination inputs that will receive the copied\n\t\t\t\t\tchords. For example, if you select inputs 1 to 3, select\n\t\t\t\t\tCOPY, then click the fourth input, the contents of inputs 1\n\t\t\t\t\tto 3 will be copied to inpus 4 to 6. Lastly, the CLEAR\n\t\t\t\t\toption will deselect all chord boxes.\n\t\t\t\t</div>\n\t\t\t\t<br />\n\t\t\t\t<div>\n\t\t\t\t\tThe chord inputs have been configured so that a period will\n\t\t\t\t\tmove your cursor forward four spaces, a comma will move your\n\t\t\t\t\tcursor back four spaces, and enter will save the changes\n\t\t\t\t\tyou've made.\n\t\t\t\t</div>\n\t\t\t\t<br />\n\t\t\t\t<div>\n\t\t\t\t\tUsing auto-scroll is really simple! Press the auto scroll\n\t\t\t\t\tbutton in the top bar, select a speed, and the page will\n\t\t\t\t\tstart scrolling! Simply move your mouse when you want the\n\t\t\t\t\tscroll to stop.\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<h2 className={ui.subtitle}>Public Page</h2>\n\t\t\t<div className={styles.border}>\n\t\t\t\tYou can find a public list of songsheets by clicking on\n\t\t\t\tthe&nbsp;\n\t\t\t\t<span className={ui.italic}>Public</span> section of the navigation\n\t\t\t\tbar. You can only edit a public songsheet if you are the owner\n\t\t\t\tor were explicitly granted editing privelleges.\n\t\t\t</div>\n\t\t\t<h2 className={ui.subtitle}>Bugs</h2>\n\t\t\t<div className={styles.border}>\n\t\t\t\tIf you discover a bug, please email me at sam4button@gmail.com\n\t\t\t\tor report an issue on my&nbsp;\n\t\t\t\t<a href=\"https://github.com/samliu21/lyrics-chords/issues\">\n\t\t\t\t\tGitHub page\n\t\t\t\t</a>\n\t\t\t\t.\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n","import React from \"react\";\nimport { useHistory } from \"react-router\";\n\nimport layout from \"../../styles/layout.module.css\";\nimport ui from \"../../styles/ui.module.css\";\n\nexport default function Home() {\n\tconst history = useHistory();\n\n\tconst loginHandler = () => {\n\t\thistory.push(\"/accounts/login\");\n\t};\n\n\tconst publicHandler = () => {\n\t\thistory.push(\"/songs/public\");\n\t};\n\n\tconst helpHandler = () => {\n\t\thistory.push(\"/help\");\n\t};\n\n\treturn (\n\t\t<div className={layout.container}>\n\t\t\t<h3 className={ui[\"plain-h2\"]}>\n\t\t\t\tHi, I'm <span className={ui.emphasis}>Sam</span> and welcome to\n\t\t\t\tmy website!\n\t\t\t</h3>\n\t\t\t<h3\n\t\t\t\tclassName={`${ui[\"plain-h2\"]} ${ui.emphasis} ${ui.pointer}`}\n\t\t\t\tonClick={loginHandler}\n\t\t\t>\n\t\t\t\tLOGIN/SIGNUP\n\t\t\t</h3>\n\t\t\t<p className={ui[\"plain-h3\"]}>\n\t\t\t\tAs a fervent guitarist, I've discovered the need for\n\t\t\t\tcustomizable songsheets to store lyrics, chords, and strumming\n\t\t\t\tpatterns, and so, I made this website to do exactly that!&nbsp;\n\t\t\t</p>\n\t\t\t<p className={ui[\"plain-h3\"]}>\n\t\t\t\tStart by logging in or signing up in the top right corner or\n\t\t\t\tclicking the&nbsp;\n\t\t\t\t<span\n\t\t\t\t\tclassName={`${ui.emphasis} ${ui.pointer}`}\n\t\t\t\t\tonClick={publicHandler}\n\t\t\t\t>\n\t\t\t\t\tPublic\n\t\t\t\t</span>\n\t\t\t\t&nbsp;tab in the navigation bar to look at other people's public\n\t\t\t\tsong sheets!\n\t\t\t</p>\n\t\t\t<p className={ui[\"plain-h3\"]}>\n\t\t\t\tFeel free to checkout the&nbsp;\n\t\t\t\t<span\n\t\t\t\t\tclassName={`${ui.emphasis} ${ui.pointer}`}\n\t\t\t\t\tonClick={helpHandler}\n\t\t\t\t>\n\t\t\t\t\tHelp\n\t\t\t\t</span>\n\t\t\t\t&nbsp;page if you ever need a hand or want to see the full\n\t\t\t\tpotential of this website!\n\t\t\t</p>\n\t\t</div>\n\t);\n}\n","export default \"data:image/png;base64,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\"","import React from \"react\";\nimport Options from \"../Options/Options\";\nimport { useSelector } from \"react-redux\";\n\nimport menu from \"../../constants/images/menu.png\";\nimport AutoScroll from \"../AutoScroll/AutoScroll\";\nimport styles from \"./MenuBar.module.css\";\n\nexport default function MenuBar(props) {\n\tconst isSongPage = useSelector((state) => state.selectedSong.isSongPage);\n\tconst isSongPageView = useSelector(\n\t\t(state) => state.selectedSong.isSongPageView\n\t);\n\n\treturn (\n\t\t<div>\n\t\t\t<div className={styles.container}>\n\t\t\t\t<img\n\t\t\t\t\tsrc={menu}\n\t\t\t\t\talt=\"menu\"\n\t\t\t\t\tclassName={styles.image}\n\t\t\t\t\tonClick={props.onMenuClick}\n\t\t\t\t/>\n\t\t\t\t<div>\n\t\t\t\t\t<Options />\n\t\t\t\t\t{(isSongPage || isSongPageView) && (\n\t\t\t\t\t\t<AutoScroll />\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n","import React from \"react\";\n\nimport NavContent from \"../NavContent/NavContent\";\nimport layout from \"../../styles/layout.module.css\";\n\nexport default function NavBar() {\n\treturn (\n\t\t<div className={layout[\"fixed-top\"]}>\n\t\t\t<NavContent direction=\"row\" />\n\t\t</div>\n\t);\n}\n","import React, { createRef } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport { useHistory } from \"react-router\";\n\nimport * as songsActions from \"../../store/actions/songsActions\";\nimport {\n\tAiOutlineEye,\n\tAiOutlineEyeInvisible,\n\tAiOutlineStar,\n\tAiFillStar,\n} from \"react-icons/ai\";\nimport { BsTrashFill } from \"react-icons/bs\";\nimport { getUsername, updateSongAttributeToDatabase } from \"../../util\";\nimport layout from \"../../styles/layout.module.css\";\nimport styles from \"./SongBlock.module.css\";\n\nexport default function SongBlock(props) {\n\tconst dispatch = useDispatch();\n\tconst history = useHistory();\n\n\tconst path = history.location.pathname.split(\"/\");\n\tconst location = path[path.length - 1];\n\n\tconst nameRef = createRef();\n\tconst artistRef = createRef();\n\n\t// Delete song\n\tasync function deleteHandler() {\n\t\ttry {\n\t\t\tdispatch(songsActions.deleteSong(props.item.id));\n\n\t\t\t// Reset localStorage element containing the number of songsheets to display in the profile page\n\t\t\tconst username = await getUsername();\n\t\t\tlocalStorage.removeItem(username);\n\t\t} catch (err) {\n\t\t\talert(\"There was an error deleting the song\");\n\t\t}\n\t}\n\n\t// Go to song page handler\n\tconst redirectHandler = async () => {\n\t\tif (props.item.artist === \"\" || props.item.name === \"\") {\n\t\t\talert(\"Please enter a song name and artist before proceeding!\");\n\t\t\treturn;\n\t\t}\n\t\thistory.push(\n\t\t\tprops.editable\n\t\t\t\t? `/songs/${props.item.creator}/${props.item.id}`\n\t\t\t\t: `/songs/${props.item.creator}/${props.item.id}/view`\n\t\t);\n\t};\n\n\t// Public handler\n\tconst publicHandler = () => {\n\t\tif (props.item.artist === \"\" || props.item.name === \"\") {\n\t\t\talert(\"Please enter a song name and artist before publicizing!\");\n\t\t\treturn;\n\t\t}\n\n\t\tupdateSongAttributeToDatabase(\n\t\t\tprops.item.id,\n\t\t\t\"public\",\n\t\t\t!props.item.public\n\t\t);\n\n\t\tdispatch(\n\t\t\tsongsActions.updateSong(props.item.id, \"public\", !props.item.public)\n\t\t);\n\n\t\t// Default the value to 0\n\t\tdispatch(songsActions.incrementView(props.item.id));\n\t};\n\n\t// Favourite handler\n\tconst favouriteHandler = () => {\n\t\tupdateSongAttributeToDatabase(\n\t\t\tprops.item.id,\n\t\t\t\"is_favourite\",\n\t\t\t!props.item.is_favourite\n\t\t);\n\n\t\tdispatch(\n\t\t\tsongsActions.updateSong(\n\t\t\t\tprops.item.id,\n\t\t\t\t\"is_favourite\",\n\t\t\t\t!props.item.is_favourite\n\t\t\t)\n\t\t);\n\t};\n\n\t// On title or artist blur\n\tconst inputBlur = () => {\n\t\tconst name = nameRef.current.value;\n\t\tconst artist = artistRef.current.value;\n\n\t\tconst id = props.item.id;\n\n\t\t// If nothing changed, don't make database call\n\t\tif (props.item.name === name && props.item.artist === artist) {\n\t\t\treturn;\n\t\t}\n\t\tconst choice = name !== props.item.name ? \"name\" : \"artist\";\n\t\tconst val = name !== props.item.name ? name : artist;\n\n\t\tdispatch(songsActions.updateSong(id, choice, val));\n\t\tupdateSongAttributeToDatabase(id, choice, val);\n\t};\n\n\t// Enter causes blur\n\tconst preventEnterHandler = (event) => {\n\t\tif (event.key === \"Enter\") {\n\t\t\tevent.preventDefault();\n\t\t\tevent.target.blur();\n\t\t}\n\t};\n\n\t// Star (favourite)\n\tconst Star = (starProps) =>\n\t\tprops.item.is_favourite ? (\n\t\t\t<AiFillStar {...starProps} />\n\t\t) : (\n\t\t\t<AiOutlineStar {...starProps} />\n\t\t);\n\n\t// Eye (public)\n\tconst Eye = (eyeProps) =>\n\t\tprops.item.public ? (\n\t\t\t<AiOutlineEye {...eyeProps} />\n\t\t) : (\n\t\t\t<AiOutlineEyeInvisible {...eyeProps} />\n\t\t);\n\n\tconst inputKwargs = props.editable ? {} : { readOnly: true };\n\n\treturn (\n\t\t<div className={styles[\"song-container\"]}>\n\t\t\t{/* Left part of container  */}\n\t\t\t<div className={layout[\"horizontal-default\"]}>\n\t\t\t\t{/* Control bar  */}\n\t\t\t\t{props.editable && (\n\t\t\t\t\t<div\n\t\t\t\t\t\tclassName={styles[\"button-container\"]}\n\t\t\t\t\t>\n\t\t\t\t\t\t<Star onClick={favouriteHandler} />\n\t\t\t\t\t\t<Eye onClick={publicHandler} className={styles.eye} />\n\t\t\t\t\t\t<BsTrashFill onClick={deleteHandler} />\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\n\t\t\t\t<div className={layout[\"vertical-default\"]}>\n\t\t\t\t\t{/* Title and artist  */}\n\t\t\t\t\t<input\n\t\t\t\t\t\tclassName={styles.name}\n\t\t\t\t\t\tdefaultValue={props.item.name}\n\t\t\t\t\t\tplaceholder=\"Enter a song name\"\n\t\t\t\t\t\tonBlur={inputBlur}\n\t\t\t\t\t\tonKeyDown={preventEnterHandler}\n\t\t\t\t\t\tref={nameRef}\n\t\t\t\t\t\t{...inputKwargs}\n\t\t\t\t\t/>\n\t\t\t\t\t<input\n\t\t\t\t\t\tclassName={styles.artist}\n\t\t\t\t\t\tdefaultValue={props.item.artist}\n\t\t\t\t\t\tplaceholder=\"Enter an artist\"\n\t\t\t\t\t\tonBlur={inputBlur}\n\t\t\t\t\t\tonKeyDown={preventEnterHandler}\n\t\t\t\t\t\tref={artistRef}\n\t\t\t\t\t\t{...inputKwargs}\n\t\t\t\t\t/>\n\n\t\t\t\t\t{/* Created by */}\n\t\t\t\t\t{props.public && (\n\t\t\t\t\t\t<div className={styles.creator}>\n\t\t\t\t\t\t\tCreated by&nbsp;\n\t\t\t\t\t\t\t<span className={styles[\"creator-name\"]}>\n\t\t\t\t\t\t\t\t{props.item.creator}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t.\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t{/* Right side of container  */}\n\t\t\t<div\n\t\t\t\tclassName={styles[\"image-container\"]}\n\t\t\t\tonClick={redirectHandler}\n\t\t\t>\n\t\t\t\t<img\n\t\t\t\t\tsrc=\"https://i.pinimg.com/originals/58/1d/34/581d34b9daddc9f6eec84accc93c7a0c.png\"\n\t\t\t\t\talt=\"Arrow\"\n\t\t\t\t\tclassName={styles.arrow}\n\t\t\t\t/>\n\t\t\t\t{location === \"public\" && props.views !== null && (\n\t\t\t\t\t<p className={styles.views}>{props.views}</p>\n\t\t\t\t)}\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n","import React, { useState, useEffect } from \"react\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport FuzzySearch from \"fuzzy-search\";\nimport { useHistory } from \"react-router-dom\";\n\nimport * as songsActions from \"../../store/actions/songsActions\";\nimport {\n\tAiOutlineSearch,\n\tAiFillCaretLeft,\n\tAiOutlineClose,\n} from \"react-icons/ai\";\nimport styles from \"./SearchBar.module.css\";\nimport ui from \"../../styles/ui.module.css\";\n\nexport default function SearchBar(props) {\n\tconst [open, setOpen] = useState(false);\n\tconst [searchText, setSearchText] = useState(\"\");\n\tconst filterFunction = props.public\n\t\t? (state) => state.songs.publicSongs\n\t\t: (state) => state.songs.userSongs;\n\tconst songList = useSelector(filterFunction);\n\n\tconst dispatch = useDispatch();\n\tconst history = useHistory();\n\n\t// Close\n\tuseEffect(() => {\n\t\tconst unlisten = history.listen(() => {\n\t\t\tsetOpen(false);\n\t\t\tsetSearchText(\"\");\n\t\t});\n\n\t\treturn () => unlisten();\n\t}, [history]);\n\n\t// Set search text on change\n\tconst inputChangeHandler = (e) => {\n\t\tsetSearchText(e.target.value);\n\t};\n\n\t// Reset filter\n\tconst resetFilter = () => {\n\t\tsetSearchText(\"\");\n\t\tif (props.public) {\n\t\t\tdispatch(songsActions.setFilteredPublicSongs(\"reset\"));\n\t\t} else {\n\t\t\tdispatch(songsActions.setFilteredUserSongs(\"reset\"));\n\t\t}\n\t};\n\n\t// Perform filter on publicList using fuzzy-search library\n\tconst filterList = () => {\n\t\tconst searcher = new FuzzySearch(\n\t\t\tsongList,\n\t\t\t[\"name\", \"artist\", \"creator\"],\n\t\t\t{\n\t\t\t\tcaseSensitive: false,\n\t\t\t\tsort: true,\n\t\t\t}\n\t\t);\n\t\tconst result = searcher.search(searchText);\n\n\t\tif (props.public) {\n\t\t\tdispatch(songsActions.setFilteredPublicSongs(result));\n\t\t} else {\n\t\t\tdispatch(songsActions.setFilteredUserSongs(result));\n\t\t}\n\t};\n\n\t// Handles search button click\n\tconst searchButtonHandler = () => {\n\t\tif (!open) {\n\t\t\tsetOpen(true);\n\t\t\treturn;\n\t\t}\n\t\tif (searchText === \"\") {\n\t\t\tresetFilter();\n\t\t\treturn;\n\t\t}\n\n\t\tfilterList();\n\t};\n\n\t// Close search bar\n\tconst closeSearchHandler = () => {\n\t\tsetOpen(false);\n\t};\n\n\t// Perform search upon enter press\n\tconst inputKeydownHandler = (e) => {\n\t\tif (e.key === \"Enter\") {\n\t\t\te.target.blur();\n\t\t\te.preventDefault();\n\t\t\tsearchButtonHandler();\n\t\t}\n\t};\n\n\treturn (\n\t\t<div className={ui[\"sidebar-container\"]}>\n\t\t\t{open && (\n\t\t\t\t<AiFillCaretLeft\n\t\t\t\t\tclassName={ui[\"sidebar-icon\"]}\n\t\t\t\t\tonClick={closeSearchHandler}\n\t\t\t\t/>\n\t\t\t)}\n\t\t\t{open && (\n\t\t\t\t<input\n\t\t\t\t\tvalue={searchText}\n\t\t\t\t\tclassName={styles.input}\n\t\t\t\t\tplaceholder=\"Filter here\"\n\t\t\t\t\tonChange={inputChangeHandler}\n\t\t\t\t\tonKeyDown={inputKeydownHandler}\n\t\t\t\t/>\n\t\t\t)}\n\t\t\t{open && (\n\t\t\t\t<AiOutlineClose\n\t\t\t\t\tclassName={ui[\"sidebar-icon\"]}\n\t\t\t\t\tonClick={resetFilter}\n\t\t\t\t/>\n\t\t\t)}\n\t\t\t<AiOutlineSearch\n\t\t\t\tclassName={ui[\"sidebar-icon\"]}\n\t\t\t\tonClick={searchButtonHandler}\n\t\t\t>\n\t\t\t\tSearch\n\t\t\t</AiOutlineSearch>\n\t\t</div>\n\t);\n}\n","import React, { useEffect } from \"react\";\nimport { useSelector, useDispatch } from \"react-redux\";\n\nimport SongBlock from \"../../components/SongBlock/SongBlock\";\nimport SearchBar from \"../../components/SearchBar/SearchBar\";\nimport layout from \"../../styles/layout.module.css\";\nimport ui from \"../../styles/ui.module.css\";\nimport * as songsActions from \"../../store/actions/songsActions\";\nimport LoadingCircle from \"../../components/LoadingCircle/LoadingCircle\";\nimport axios from \"axios\";\nimport { getToken } from \"../../util\";\n\nexport default function PublicList() {\n\tconst isAdmin = useSelector((state) => state.auth.admin);\n\tconst views = useSelector((state) => state.songs.views);\n\tconst filteredPublicSongs = useSelector(\n\t\t(state) => state.songs.filteredPublicSongs\n\t);\n\tconst username = useSelector((state) => state.auth.username);\n\n\tconst dispatch = useDispatch();\n\n\tuseEffect(() => {\n\t\tconst database = async () => {\n\t\t\tconst ids = filteredPublicSongs.map((song) => song.id);\n\t\t\tconst response = await axios.post(\n\t\t\t\t\"/api/views/get_views\",\n\t\t\t\t{\n\t\t\t\t\tids: ids,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\twithCredentials: true,\n\t\t\t\t\theaders: {\n\t\t\t\t\t\t\"Content-Type\": \"application/json\",\n\t\t\t\t\t\t\"X-CSRFToken\": getToken(),\n\t\t\t\t\t},\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tdispatch(songsActions.setViews(response.data));\n\t\t};\n\n\t\tif (filteredPublicSongs && !views) {\n\t\t\tdatabase();\n\t\t}\n\t}, [filteredPublicSongs, dispatch, views]);\n\n\tuseEffect(() => {\n\t\treturn () => dispatch(songsActions.setFilteredPublicSongs(\"reset\"));\n\t}, [dispatch]);\n\n\tif (!filteredPublicSongs) {\n\t\treturn <LoadingCircle />;\n\t}\n\n\treturn (\n\t\t<div className={layout.container}>\n\t\t\t<SearchBar public />\n\n\t\t\t<h1 className={ui.title}>Public Songs</h1>\n\n\t\t\t{filteredPublicSongs.map((song) => {\n\t\t\t\tconst kwargs =\n\t\t\t\t\tusername === song.creator || isAdmin\n\t\t\t\t\t\t? { editable: true }\n\t\t\t\t\t\t: {};\n\t\t\t\treturn (\n\t\t\t\t\t<SongBlock\n\t\t\t\t\t\tkey={song.id}\n\t\t\t\t\t\tid={song.id}\n\t\t\t\t\t\tviews={views ? views[song.id] : null}\n\t\t\t\t\t\titem={song}\n\t\t\t\t\t\tpublic\n\t\t\t\t\t\t{...kwargs}\n\t\t\t\t\t/>\n\t\t\t\t);\n\t\t\t})}\n\t\t</div>\n\t);\n}\n","import axios from \"axios\";\nimport React, { createRef } from \"react\";\nimport { getToken } from \"../../util\";\n\nimport styles from \"./PasswordReset.module.css\";\nimport layout from \"../../styles/layout.module.css\";\nimport ui from \"../../styles/ui.module.css\";\nimport Button from \"../../components/Button/Button\";\n\nexport default function PasswordReset() {\n\tconst input = createRef();\n\n\t// Reset password handler\n\tconst resetHandler = async () => {\n\t\tconst email = input.current.value;\n\n\t\ttry {\n\t\t\tconst response = await axios.post(\n\t\t\t\t\"/api/auth/email/password-reset\",\n\t\t\t\t{\n\t\t\t\t\temail: email,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\theaders: {\n\t\t\t\t\t\t\"Content-Type\": \"application/json\",\n\t\t\t\t\t\t\"X-CSRFToken\": getToken(),\n\t\t\t\t\t},\n\t\t\t\t}\n\t\t\t);\n\n\t\t\talert(response.data);\n\t\t} catch (err) {\n\t\t\talert(err.response.data ?? \"There was an error sending the email.\");\n\t\t}\n\t};\n\n\treturn (\n\t\t<div className={layout.container}>\n\t\t\t<h2 className={ui.title}>Password Reset</h2>\n\t\t\t<p className={ui.italic}>\n\t\t\t\tForgotten your password? Enter your email address below, and\n\t\t\t\twe'll email instructions for setting a new one.\n\t\t\t</p>\n\t\t\t<div className={layout[\"horizontal-default\"]}>\n\t\t\t\t<p className={styles.text}>Email address:</p>\n\t\t\t\t<input ref={input} className={ui[\"purple-input\"]} />\n\t\t\t</div>\n\t\t\t<Button onClick={resetHandler} className={styles.button}>\n\t\t\t\tReset my password!\n\t\t\t</Button>\n\t\t</div>\n\t);\n}\n","import axios from \"axios\";\nimport React, { createRef } from \"react\";\nimport { getToken } from \"../../util\";\nimport { useHistory } from \"react-router\";\nimport { useDispatch } from \"react-redux\";\n\nimport styles from \"./PasswordChange.module.css\";\nimport * as authActions from \"../../store/actions/authActions\";\nimport layout from \"../../styles/layout.module.css\";\nimport ui from \"../../styles/ui.module.css\";\nimport Button from \"../../components/Button/Button\";\n\nexport default function PasswordChange(props) {\n\tconst password = createRef();\n\tconst retypedPassword = createRef();\n\n\tconst history = useHistory();\n\tconst dispatch = useDispatch();\n\n\tconst changePasswordHandler = async () => {\n\t\tconst params = props.match.params;\n\t\tconst uid = params.uid;\n\t\tconst token = params.token;\n\n\t\tconst pswd = password.current.value;\n\t\tconst retypedPswd = retypedPassword.current.value;\n\t\tif (pswd !== retypedPswd) {\n\t\t\talert(\"Passwords don't match!\");\n\t\t\treturn;\n\t\t}\n\n\t\ttry {\n\t\t\tconst response = await axios.post(\n\t\t\t\t\"/api/auth/email/password-change\",\n\t\t\t\t{\n\t\t\t\t\tuid: uid,\n\t\t\t\t\ttoken: token,\n\t\t\t\t\tpassword: pswd,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\theaders: {\n\t\t\t\t\t\t\"Content-Type\": \"application/json\",\n\t\t\t\t\t\t\"X-CSRFToken\": getToken(),\n\t\t\t\t\t},\n\t\t\t\t}\n\t\t\t);\n\n\t\t\talert(response.data);\n\t\t\tdispatch(authActions.setAdmin(null));\n\t\t\tdispatch(authActions.setUsername(null));\n\n\t\t\thistory.push(\"/accounts/login\");\n\t\t} catch (err) {\n\t\t\tconsole.log(err.response);\n\t\t\talert(\n\t\t\t\terr.response.data ??\n\t\t\t\t\t\"There was an error resetting your password.\"\n\t\t\t);\n\t\t}\n\t};\n\n\treturn (\n\t\t<div className={layout.container}>\n\t\t\t<h2 className={ui.title}>Password Change</h2>\n\t\t\t<div className={layout[\"horizontal-default\"]}>\n\t\t\t\t<p className={styles.text}>Password:</p>\n\t\t\t\t<input\n\t\t\t\t\tclassName={ui[\"purple-input\"]}\n\t\t\t\t\tref={password}\n\t\t\t\t\ttype=\"password\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div className={layout[\"horizontal-default\"]}>\n\t\t\t\t<p className={styles.text}>Retype Password:</p>\n\t\t\t\t<input\n\t\t\t\t\tclassName={ui[\"purple-input\"]}\n\t\t\t\t\tref={retypedPassword}\n\t\t\t\t\ttype=\"password\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<Button onClick={changePasswordHandler} className={styles.button}>\n\t\t\t\tSubmit\n\t\t\t</Button>\n\t\t</div>\n\t);\n}\n","import React from \"react\";\n\nimport styles from \"./CapitalText.module.css\";\n\nexport default function CapitalText(props) {\n\treturn (\n\t\t<p {...props} className={styles.text}>\n\t\t\t{props.children.toUpperCase()}\n\t\t</p>\n\t);\n}\n","import React from \"react\";\n\nimport styles from \"./TextArea.module.css\";\n\nexport default function TextArea(props) {\n\treturn (\n\t\t<div>\n\t\t\t{!props.noLines && <hr />}\n\t\t\t<textarea\n\t\t\t\trows={props.lineCount ?? 4}\n\t\t\t\tclassName={styles.input}\n\t\t\t\tmaxLength={500}\n\t\t\t\tdefaultValue={props.defaultValue ?? \"\"}\n\t\t\t\tref={props.refName}\n\t\t\t/>\n\t\t\t{!props.noLines && <hr />}\n\t\t</div>\n\t);\n}\n","import React, { useEffect, useState, useRef } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { useHistory } from \"react-router\";\n\nimport styles from \"./Profile.module.css\";\nimport layout from \"../../styles/layout.module.css\";\nimport ui from \"../../styles/ui.module.css\";\nimport axios from \"axios\";\nimport CapitalText from \"../../components/CapitalText/CapitalText\";\nimport TextArea from \"../../components/TextArea/TextArea\";\nimport Button from \"../../components/Button/Button\";\nimport { getToken } from \"../../util\";\n\nexport default function Profile(props) {\n\tconst username = props.match.params.username;\n\n\tconst realUsername = useSelector((state) => state.auth.username);\n\tconst [songCount, setSongCount] = useState();\n\tconst [isLoading, setIsLoading] = useState(true);\n\tconst [active, setActive] = useState(\"About\");\n\tconst [about, setAbout] = useState();\n\tconst [imgUrl, setImgUrl] = useState();\n\n\tconst aboutRef = useRef();\n\n\tconst history = useHistory();\n\n\tuseEffect(() => {\n\t\tconst getImage = async () => {\n\t\t\ttry {\n\t\t\t\tconst response = await axios.get(\n\t\t\t\t\t`/api/auth/images/get_image/${username}`\n\t\t\t\t);\n\n\t\t\t\tconst url = response.data;\n\t\t\t\tsetImgUrl(url);\n\t\t\t} catch (err) {\n\t\t\t\tconsole.log(err.message);\n\t\t\t}\n\t\t\tsetIsLoading(false);\n\t\t};\n\n\t\tgetImage();\n\t}, [username]);\n\n\tuseEffect(() => {\n\t\tconst unlisten = history.listen(() => {\n\t\t\tsetSongCount(null);\n\t\t});\n\n\t\treturn () => unlisten();\n\t}, [history]);\n\n\tuseEffect(() => {\n\t\tconst getAbout = async () => {\n\t\t\ttry {\n\t\t\t\tconst response = await axios.get(\n\t\t\t\t\t`/api/auth/about/${username}`,\n\t\t\t\t\t{\n\t\t\t\t\t\twithCredentials: true,\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\tsetAbout(response.data);\n\t\t\t} catch (err) {\n\t\t\t\tconsole.log(err.message);\n\t\t\t}\n\t\t};\n\n\t\tgetAbout();\n\t}, [username]);\n\n\tuseEffect(() => {\n\t\tconst getCount = async () => {\n\t\t\tconst existingValue = localStorage.getItem(username);\n\n\t\t\tif (existingValue) {\n\t\t\t\tsetSongCount(existingValue);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\tconst response = await axios.get(\n\t\t\t\t\t`/api/songs/${username}/count/`\n\t\t\t\t);\n\n\t\t\t\tconst cnt = response.data;\n\t\t\t\tsetSongCount(cnt);\n\n\t\t\t\tlocalStorage.setItem(username, cnt);\n\t\t\t} catch (err) {\n\t\t\t\t// User enters a username that doesn't exist\n\t\t\t\tif (err.response && err.response.data) {\n\t\t\t\t\talert(err.response.data);\n\t\t\t\t} else {\n\t\t\t\t\talert(\"There was an error loading the page.\");\n\t\t\t\t}\n\n\t\t\t\thistory.push(`/user/${realUsername}`);\n\t\t\t}\n\t\t};\n\n\t\tgetCount();\n\t}, [username, history, realUsername]);\n\n\tconst changePasswordHandler = async () => {\n\t\tsetIsLoading(true);\n\t\tconst response = await axios.get(\n\t\t\t\"/api/auth/email/password-change-link\"\n\t\t);\n\t\tconst link = response.data;\n\t\tsetIsLoading(false);\n\n\t\thistory.push(link);\n\t};\n\n\tconst submitHandler = async () => {\n\t\tconst inputAbout = aboutRef.current.value;\n\n\t\tsetAbout(inputAbout);\n\t\ttry {\n\t\t\tawait axios.post(\n\t\t\t\t\"/api/auth/set_about\",\n\t\t\t\t{\n\t\t\t\t\tabout: inputAbout,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\twithCredentials: true,\n\t\t\t\t\theaders: {\n\t\t\t\t\t\t\"Content-Type\": \"application/json\",\n\t\t\t\t\t\t\"X-CSRFToken\": getToken(),\n\t\t\t\t\t},\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tsetActive(\"About\");\n\t\t} catch (err) {\n\t\t\tconsole.log(err.message);\n\t\t\talert(\"Biography couldn't save!\");\n\t\t}\n\t};\n\n\tconst imageChangeHandler = async (e) => {\n\t\tconst image = e.target.files[0];\n\n\t\tif (image.size > 500000) {\n\t\t\talert(\n\t\t\t\t\"Image is too large! Please upload an image less than 500KB in size.\"\n\t\t\t);\n\t\t\treturn;\n\t\t}\n\n\t\tconst validExtensions = [\"jpg\", \"png\"];\n\n\t\tconst nameArray = image.name.split(\".\");\n\t\tconst extension = nameArray[nameArray.length - 1].toLowerCase();\n\t\tif (!extension || validExtensions.indexOf(extension) === -1) {\n\t\t\talert(\"Invalid file type.\");\n\t\t\te.target.value = \"\";\n\t\t\treturn;\n\t\t}\n\n\t\tconst formData = new FormData();\n\t\tformData.append(\"image\", image);\n\n\t\ttry {\n\t\t\tconst response = await axios.post(\"/api/auth/images/\", formData, {\n\t\t\t\twithCredentials: true,\n\t\t\t\theaders: {\n\t\t\t\t\t\"X-CSRFToken\": getToken(),\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tconst url = response.data.url;\n\t\t\tsetImgUrl(url);\n\t\t} catch (err) {\n\t\t\tconsole.dir(err.response);\n\t\t}\n\t};\n\n\tif (!songCount || about === null) {\n\t\treturn <p></p>;\n\t}\n\n\tconst menuButton = (text, onClick) => {\n\t\tconst className =\n\t\t\tstyles[\"menu-button\"] +\n\t\t\t\" \" +\n\t\t\t(active === text ? styles[\"menu-button-active\"] : \"\");\n\n\t\tconst clickHandler = () => {\n\t\t\tif (onClick) {\n\t\t\t\tonClick();\n\t\t\t}\n\t\t\tsetActive(text);\n\t\t};\n\n\t\treturn (\n\t\t\t<p className={className} onClick={clickHandler}>\n\t\t\t\t{text}\n\t\t\t</p>\n\t\t);\n\t};\n\n\tif (isLoading) {\n\t\treturn <p></p>;\n\t}\n\n\treturn (\n\t\t<div className={layout.container}>\n\t\t\t<div className={`${layout[\"horizontal-end\"]}`}>\n\t\t\t\t{menuButton(\"About\")}\n\t\t\t\t{menuButton(\"Edit Profile\")}\n\t\t\t</div>\n\t\t\t<hr className={`${layout[\"no-margin\"]}`} />\n\n\t\t\t<div className={layout[\"horizontal-default-start\"]}>\n\t\t\t\t<div className={layout[\"vertical-default\"]}>\n\t\t\t\t\t<img\n\t\t\t\t\t\tsrc={\n\t\t\t\t\t\t\timgUrl ??\n\t\t\t\t\t\t\t\"https://hoursproject.com/cache/images/square_thumb/images/user/default.png\"\n\t\t\t\t\t\t}\n\t\t\t\t\t\talt=\"profile-pic\"\n\t\t\t\t\t\tclassName={styles.picture}\n\t\t\t\t\t/>\n\t\t\t\t\t{active === \"Edit Profile\" && (\n\t\t\t\t\t\t<label class={styles[\"file-upload\"]}>\n\t\t\t\t\t\t\tCUSTOM UPLOAD\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\ttype=\"file\"\n\t\t\t\t\t\t\t\tid=\"image\"\n\t\t\t\t\t\t\t\tonChange={imageChangeHandler}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</label>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t\t<div className={layout[\"full-width\"]}>\n\t\t\t\t\t<h2 className={`${ui[\"plain-h2\"]} ${ui.italic}`}>\n\t\t\t\t\t\t{username}\n\t\t\t\t\t</h2>\n\t\t\t\t\t<p>\n\t\t\t\t\t\t<span className={ui.italic}>Songsheets created:</span>\n\t\t\t\t\t\t&nbsp;&nbsp;\n\t\t\t\t\t\t{songCount}\n\t\t\t\t\t</p>\n\t\t\t\t\t<h2 className={ui.subtitle}>About</h2>\n\t\t\t\t\t{active === \"Edit Profile\" ? (\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<TextArea\n\t\t\t\t\t\t\t\trefName={aboutRef}\n\t\t\t\t\t\t\t\tlineCount={10}\n\t\t\t\t\t\t\t\tnoLines\n\t\t\t\t\t\t\t\tdefaultValue={about}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\tonClick={submitHandler}\n\t\t\t\t\t\t\t\tclassName={layout[\"align-block-right\"]}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tSave\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<p className={ui[\"white-space\"]}>\n\t\t\t\t\t\t\t{about === \"\" ? \"No biography.\" : about}\n\t\t\t\t\t\t</p>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t{username === realUsername && active === \"About\" && (\n\t\t\t\t<CapitalText onClick={changePasswordHandler}>\n\t\t\t\t\tChange Password\n\t\t\t\t</CapitalText>\n\t\t\t)}\n\t\t</div>\n\t);\n}\n","import React, { useState } from \"react\";\nimport { useDispatch } from \"react-redux\";\n\nimport * as actions from \"../../store/actions/songsActions\";\nimport CapitalText from \"../CapitalText/CapitalText\";\nimport LoadingCircle from \"../LoadingCircle/LoadingCircle\";\n\nexport default function AddSongButton() {\n\tconst [isAdding, setIsAdding] = useState(false);\n\n\tconst dispatch = useDispatch();\n\n\t// Dispatch new song to backend\n\tasync function addSongHandler() {\n\t\tsetIsAdding(true);\n\n\t\tdispatch(actions.addSong());\n\n\t\tsetTimeout(() => setIsAdding(false), 500);\n\t}\n\n\treturn (\n\t\t<div>\n\t\t\t{isAdding && <LoadingCircle />}\n\t\t\t<CapitalText onClick={addSongHandler}>Add Song</CapitalText>\n\t\t</div>\n\t);\n}\n","import React, { useState, useEffect } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport * as songsActions from \"../../store/actions/songsActions\";\nimport { useHistory } from \"react-router-dom\";\n\nimport AddSongButton from \"../../components/AddSongButton/AddSongButton\";\nimport CapitalText from \"../../components/CapitalText/CapitalText\";\nimport { getUsername, getActivationStatus } from \"../../util\";\nimport layout from \"../../styles/layout.module.css\";\nimport ui from \"../../styles/ui.module.css\";\nimport LoadingCircle from \"../../components/LoadingCircle/LoadingCircle\";\nimport SearchBar from \"../../components/SearchBar/SearchBar\";\nimport SongBlock from \"../../components/SongBlock/SongBlock\";\n\nexport default function SongList(props) {\n\tconst { username } = props.match.params;\n\n\tconst [isFavourites, setIsFavourites] = useState(false);\n\tconst isAdmin = useSelector((state) => state.auth.admin);\n\n\tconst history = useHistory();\n\n\tconst path = history.location.pathname.split(\"/\");\n\tconst all = path[2] === \"all\";\n\n\tlet condition;\n\tif (all) {\n\t\tcondition = (state) =>\n\t\t\tisFavourites && state.songs.filteredSongs\n\t\t\t\t? state.songs.filteredUserSongs.filter(\n\t\t\t\t\t\t(song) => song.is_favourite\n\t\t\t\t  )\n\t\t\t\t: state.songs.filteredUserSongs;\n\t} else {\n\t\tcondition = (state) => {\n\t\t\tif (!state.songs.filteredUserSongs) {\n\t\t\t\treturn null;\n\t\t\t} else if (isFavourites) {\n\t\t\t\treturn state.songs.filteredUserSongs.filter(\n\t\t\t\t\t(song) => song.is_favourite && song.creator === username\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\treturn state.songs.filteredUserSongs.filter(\n\t\t\t\t\t(song) => song.creator === username\n\t\t\t\t);\n\t\t\t}\n\t\t};\n\t}\n\n\tconst songList = useSelector(condition);\n\n\tconst dispatch = useDispatch();\n\n\tuseEffect(() => {\n\t\tconst activated = async () => {\n\t\t\tconst activationStatus = await getActivationStatus();\n\n\t\t\tif (!activationStatus) {\n\t\t\t\thistory.push(\"/accounts/confirm-email\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t};\n\n\t\tactivated();\n\t}, [history]);\n\n\tuseEffect(() => {\n\t\tconst unlisten = history.listen(() => {\n\t\t\tdispatch(songsActions.setFilteredUserSongs(\"reset\"));\n\t\t});\n\n\t\treturn () => unlisten();\n\t}, [dispatch, history]);\n\n\t// Get song list on component mount\n\tuseEffect(() => {\n\t\t// Get song list\n\t\tconst getSongList = async () => {\n\t\t\tconst response = await getUsername();\n\n\t\t\tif (isAdmin === false && response !== username) {\n\t\t\t\thistory.push(\n\t\t\t\t\tresponse ? `/songs/${response}` : \"/accounts/login\"\n\t\t\t\t);\n\t\t\t}\n\t\t};\n\n\t\tgetSongList();\n\t}, [username, history, dispatch, songList, isAdmin]);\n\n\t// While rendering, show temporary data\n\tif (!songList) {\n\t\treturn <LoadingCircle />;\n\t}\n\n\t// Handle favourites click\n\tconst favouritesHandler = () => {\n\t\tsetIsFavourites((state) => !state);\n\t};\n\n\treturn (\n\t\t<div className={layout.container}>\n\t\t\t<div className={layout[\"horizontal-between\"]}>\n\t\t\t\t{!all && (\n\t\t\t\t\t<CapitalText onClick={favouritesHandler}>\n\t\t\t\t\t\t{isFavourites ? \"ALL\" : \"FAVOURITES\"}\n\t\t\t\t\t</CapitalText>\n\t\t\t\t)}\n\t\t\t\t{!all && <AddSongButton />}\n\t\t\t</div>\n\t\t\t<SearchBar />\n\n\t\t\t<h1 className={ui.title}>\n\t\t\t\t{all\n\t\t\t\t\t? \"All Songs\"\n\t\t\t\t\t: \"Your \" + (isFavourites ? \"Favourite \" : \"\") + \"Songs\"}\n\t\t\t</h1>\n\n\t\t\t{songList.map((item) => (\n\t\t\t\t<SongBlock key={item.id} item={item} editable />\n\t\t\t))}\n\t\t</div>\n\t);\n}\n","import axios from \"axios\";\n\nimport { getToken } from \"../../util\";\n\nexport const ADD_COMMENTS = \"GET_COMMENTS\";\nexport const DELETE_COMMENT = \"DELETE_COMMENT\";\nexport const EDIT_COMMENT = \"EDIT_COMMENT\";\n\nexport const getComments = (id) => {\n\treturn async (dispatch) => {\n\t\ttry {\n\t\t\tconst response = await axios.get(\n\t\t\t\t`/api/comments/${id}/get_song_comments/`\n\t\t\t);\n\n\t\t\tconst comments = response.data;\n\n\t\t\tdispatch({\n\t\t\t\ttype: ADD_COMMENTS,\n\t\t\t\tsongId: id,\n\t\t\t\tcomments: comments,\n\t\t\t});\n\t\t} catch (err) {\n\t\t\talert(\"There was an error getting the comments for this song.\")\n\t\t}\n\t};\n};\n\nexport const addComment = (songId, username, contents, parent) => {\n\treturn async (dispatch) => {\n\t\ttry {\n\t\t\tconst response = await axios.post(\n\t\t\t\t\"/api/comments/\",\n\t\t\t\t{\n\t\t\t\t\tsongId: songId,\n\t\t\t\t\tuser: username,\n\t\t\t\t\tcontents: contents,\n\t\t\t\t\tparent: parent,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\twithCredentials: true,\n\t\t\t\t\theaders: {\n\t\t\t\t\t\t\"X-CSRFToken\": getToken(),\n\t\t\t\t\t\t\"Content-Type\": \"application/json\",\n\t\t\t\t\t},\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tconst comment = response.data;\n\t\t\tdispatch({\n\t\t\t\ttype: ADD_COMMENTS,\n\t\t\t\tsongId: songId,\n\t\t\t\tcomments: [comment],\n\t\t\t});\n\t\t} catch (err) {\n\t\t\talert(\"There was an error submitting your comment.\");\n\t\t\tconsole.log(err.message);\n\t\t}\n\t};\n};\n\nexport const deleteComment = (id, songId) => {\n\treturn async (dispatch) => {\n\t\ttry {\n\t\t\taxios.delete(`/api/comments/${id}/`, {\n\t\t\t\twithCredentials: true,\n\t\t\t\theaders: {\n\t\t\t\t\t\"X-CSRFToken\": getToken(),\n\t\t\t\t\t\"Content-Type\": \"application/json\",\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tdispatch({\n\t\t\t\ttype: DELETE_COMMENT,\n\t\t\t\tsongId: songId,\n\t\t\t\tid: id,\n\t\t\t});\n\t\t} catch (err) {\n\t\t\talert(\"There was an error deleting your comment.\")\n\t\t}\n\t};\n};\n\nexport const editComment = (songId, id, contents) => {\n\treturn async (dispatch) => {\n\t\ttry {\n\t\t\tconst response = await axios.patch(\n\t\t\t\t`/api/comments/${id}/`,\n\t\t\t\t{\n\t\t\t\t\tcontents: contents,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\twithCredentials: true,\n\t\t\t\t\theaders: {\n\t\t\t\t\t\t\"X-CSRFToken\": getToken(),\n\t\t\t\t\t\t\"Content-Type\": \"application/json\",\n\t\t\t\t\t},\n\t\t\t\t}\n\t\t\t);\n\t\t\tconst time = response.data.date_of_creation;\n\n\t\t\tdispatch({\n\t\t\t\ttype: EDIT_COMMENT,\n\t\t\t\tsongId: songId,\n\t\t\t\tcontents: contents,\n\t\t\t\ttime: time,\n\t\t\t\tid: id,\n\t\t\t});\n\t\t} catch (err) {\n\t\t\talert(\"There was an error updating your comment.\")\n\t\t\tconsole.log(err.message);\n\t\t}\n\t};\n};\n","import React from \"react\";\nimport Button from \"../Button/Button\";\nimport TextArea from \"../TextArea/TextArea\";\n\nimport styles from \"./NewComment.module.css\";\nimport layout from \"../../styles/layout.module.css\";\n\nexport default function NewComment(props) {\n\treturn (\n\t\t<div className={props.border ? styles.container : \"\"}>\n\t\t\t{props.title && <h3 className={styles.heading}>{props.title}</h3>}\n\t\t\t<TextArea\n\t\t\t\trefName={props.refName}\n\t\t\t\tdefaultValue={props.defaultValue}\n\t\t\t/>\n\t\t\t{props.cancelHandler ? (\n\t\t\t\t<div className={layout[\"horizontal-between\"]}>\n\t\t\t\t\t<Button onClick={props.cancelHandler}>Cancel</Button>\n\t\t\t\t\t<Button onClick={props.submitHandler}>Submit</Button>\n\t\t\t\t</div>\n\t\t\t) : (\n\t\t\t\t<Button\n\t\t\t\t\tonClick={props.submitHandler}\n\t\t\t\t\tclassName={layout[\"align-block-right\"]}\n\t\t\t\t>\n\t\t\t\t\tSubmit\n\t\t\t\t</Button>\n\t\t\t)}\n\t\t</div>\n\t);\n}\n","import React, { useState, useRef } from \"react\";\nimport { useSelector, useDispatch } from \"react-redux\";\n\nimport * as commentActions from \"../../store/actions/commentActions\";\nimport { BiTrash, BiPencil } from \"react-icons/bi\";\nimport { BsArrow90DegLeft } from \"react-icons/bs\";\nimport NewComment from \"../NewComment/NewComment\";\nimport styles from \"./CommentsBlock.module.css\";\nimport layout from \"../../styles/layout.module.css\";\nimport ui from \"../../styles/ui.module.css\";\n\nexport default function CommentsBlock(props) {\n\tconst username = useSelector((state) => state.auth.username);\n\tconst [editMode, setEditMode] = useState(false);\n\tconst [replying, setReplying] = useState(false);\n\tconst editableRef = useRef();\n\tconst replyRef = useRef();\n\n\tconst { songId, commentUsername } = props;\n\tconst { contents, date_of_creation, id, edited, children } = props.comment;\n\n\tconst dispatch = useDispatch();\n\n\tconst dateConverter = () => {\n\t\tconst dateOfCreation = new Date(date_of_creation);\n\t\tconst currentDate = new Date();\n\t\tconst msDif = currentDate - dateOfCreation; // Time elapsed in milliseconds\n\n\t\tif (dateOfCreation.getDate() === currentDate.getDate()) {\n\t\t\t// Same day\n\t\t\tconst hourDif = msDif / 3600000;\n\t\t\tif (hourDif < 1) {\n\t\t\t\t// Show minutes ago\n\t\t\t\tconst minuteDif = Math.round(hourDif * 60);\n\t\t\t\tif (minuteDif === 0) {\n\t\t\t\t\treturn \"now\";\n\t\t\t\t}\n\t\t\t\treturn minuteDif === 1\n\t\t\t\t\t? \"1 minute ago\"\n\t\t\t\t\t: `${minuteDif} minutes ago`;\n\t\t\t} else {\n\t\t\t\t// Show hours ago\n\t\t\t\treturn Math.round(hourDif) === 1\n\t\t\t\t\t? \"1 minute ago\"\n\t\t\t\t\t: `${Math.round(hourDif)} hours ago`;\n\t\t\t}\n\t\t}\n\n\t\tconst dayDif = Math.round(msDif / 3600000 / 24);\n\t\tif (dayDif <= 30) {\n\t\t\treturn dayDif === 1 ? \"1 day ago\" : `${dayDif} days ago`;\n\t\t}\n\n\t\tconst monthDif = Math.round(dayDif / 30);\n\t\tif (monthDif <= 12) {\n\t\t\treturn monthDif === 1 ? \"1 month ago\" : `${monthDif} months ago`;\n\t\t} else {\n\t\t\treturn `on ${dateOfCreation.getFullYear()}/${dateOfCreation.getMonth()}/${\n\t\t\t\tdateOfCreation.getDate\n\t\t\t}`;\n\t\t}\n\t};\n\n\tconst editHandler = () => {\n\t\tsetEditMode(true);\n\t};\n\n\tconst deleteHandler = () => {\n\t\tdispatch(commentActions.deleteComment(id, songId));\n\t};\n\n\tconst editCancelHandler = () => {\n\t\tsetEditMode(false);\n\t};\n\n\tconst editSubmitHandler = () => {\n\t\tconst val = editableRef.current.value;\n\t\tif (val === \"\") {\n\t\t\talert(\"Comment cannot be empty.\");\n\t\t\treturn;\n\t\t}\n\t\tif (contents !== val) {\n\t\t\tdispatch(commentActions.editComment(songId, id, val));\n\t\t}\n\t\tsetEditMode(false);\n\t};\n\n\tconst replyHandler = () => {\n\t\tsetReplying(true);\n\t};\n\n\tconst replyCancelHandler = () => {\n\t\tsetReplying(false);\n\t};\n\n\tconst replySubmitHandler = () => {\n\t\tdispatch(\n\t\t\tcommentActions.addComment(\n\t\t\t\tsongId,\n\t\t\t\tusername,\n\t\t\t\treplyRef.current.value,\n\t\t\t\tid\n\t\t\t)\n\t\t);\n\t\tsetReplying(false);\n\t};\n\n\tconst nestedComments = (children || []).map((comment) => (\n\t\t<CommentsBlock\n\t\t\tkey={comment.id}\n\t\t\tsongId={songId}\n\t\t\tcommentUsername={comment.username}\n\t\t\tcomment={comment}\n\t\t/>\n\t));\n\n\treturn (\n\t\t<div className={styles[\"outer-container\"]} key={id}>\n\t\t\t<div className={styles.container}>\n\t\t\t\t<div className={styles[\"horizontal-container\"]}>\n\t\t\t\t\t<div className={`${layout[\"horizontal-center\"]} ${ui[\"plain-h4\"]} ${styles.grow}`}>\n\t\t\t\t\t\t<div className={`${ui.emphasis}`}>\n\t\t\t\t\t\t\t{commentUsername}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className={styles.grow}>\n\t\t\t\t\t\t\t&nbsp; {edited ? \"edited\" : \"commented\"}&nbsp;\n\t\t\t\t\t\t\t{dateConverter()}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className={layout[\"horizontal-center\"]}>\n\t\t\t\t\t\t{username === commentUsername && (\n\t\t\t\t\t\t\t<BiPencil\n\t\t\t\t\t\t\t\tonClick={editHandler}\n\t\t\t\t\t\t\t\tclassName={`${ui.pointer}`}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{username === commentUsername && (\n\t\t\t\t\t\t\t<BiTrash\n\t\t\t\t\t\t\t\tonClick={deleteHandler}\n\t\t\t\t\t\t\t\tclassName={`${ui.pointer} ${styles.trash}`}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{username && (\n\t\t\t\t\t\t\t<BsArrow90DegLeft\n\t\t\t\t\t\t\t\tonClick={replyHandler}\n\t\t\t\t\t\t\t\tclassName={`${ui.pointer}`}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t{editMode ? (\n\t\t\t\t\t<NewComment\n\t\t\t\t\t\trefName={editableRef}\n\t\t\t\t\t\tsubmitHandler={editSubmitHandler}\n\t\t\t\t\t\tcancelHandler={editCancelHandler}\n\t\t\t\t\t\tdefaultValue={contents}\n\t\t\t\t\t/>\n\t\t\t\t) : (\n\t\t\t\t\t<div className={ui[\"plain-h4\"]}>\n\t\t\t\t\t\t<hr />\n\t\t\t\t\t\t{contents}\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t</div>\n\t\t\t<div className={styles.children}>{nestedComments}</div>\n\t\t\t{replying && (\n\t\t\t\t<div className={styles[\"reply-container\"]}>\n\t\t\t\t\t<NewComment\n\t\t\t\t\t\ttitle=\"Replying\"\n\t\t\t\t\t\trefName={replyRef}\n\t\t\t\t\t\tcancelHandler={replyCancelHandler}\n\t\t\t\t\t\tsubmitHandler={replySubmitHandler}\n\t\t\t\t\t\tborder\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t)}\n\t\t</div>\n\t);\n}\n","import React, { useState, useRef, useEffect } from \"react\";\nimport { useSelector, useDispatch } from \"react-redux\";\n\nimport * as commentActions from \"../../store/actions/commentActions\";\nimport CommentsBlock from \"../CommentsBlock/CommentsBlock\";\nimport LoadingCircle from \"../LoadingCircle/LoadingCircle\";\nimport NewComment from \"../NewComment/NewComment\";\nimport ui from \"../../styles/ui.module.css\";\n\nexport default function Comments(props) {\n\tconst username = useSelector((state) => state.auth.username);\n\tconst newCommentRef = useRef();\n\tconst [isLoading, setIsLoading] = useState(false);\n\n\tconst dispatch = useDispatch();\n\n\tconst { id } = props;\n\n\tconst comments = useSelector((state) =>\n\t\tid && state.comments.comments && state.comments.comments[id]\n\t\t\t? state.comments.comments[id]\n\t\t\t: null\n\t);\n\n\tuseEffect(() => {\n\t\tif (id && !comments) {\n\t\t\tdispatch(commentActions.getComments(id));\n\t\t}\n\t}, [dispatch, comments, id]);\n\n\tconst newCommentHandler = async () => {\n\t\tconst value = newCommentRef.current.value;\n\t\tif (value === \"\") {\n\t\t\tconsole.log(\"Comment cannot be empty!\");\n\t\t\treturn;\n\t\t}\n\n\t\tsetIsLoading(true);\n\t\tdispatch(\n\t\t\tcommentActions.addComment(\n\t\t\t\tid,\n\t\t\t\tusername,\n\t\t\t\tvalue,\n\t\t\t\tnull\n\t\t\t)\n\t\t);\n\t\tnewCommentRef.current.value = \"\";\n\t\tsetTimeout(() => setIsLoading(false), 500);\n\t};\n\n\treturn (\n\t\tcomments && (\n\t\t\t<div>\n\t\t\t\t<h2 className={ui[\"song-subtitle\"]}>Comments</h2>\n\t\t\t\t{comments.length === 0 ? (\n\t\t\t\t\t<p>No comments.</p>\n\t\t\t\t) : (\n\t\t\t\t\tcomments.map((comment) => (\n\t\t\t\t\t\t<CommentsBlock\n\t\t\t\t\t\t\tkey={comment.id}\n\t\t\t\t\t\t\tsongId={id}\n\t\t\t\t\t\t\tcommentUsername={comment.username}\n\t\t\t\t\t\t\tcomment={comment}\n\t\t\t\t\t\t/>\n\t\t\t\t\t))\n\t\t\t\t)}\n\t\t\t\t{username && (\n\t\t\t\t\t<NewComment\n\t\t\t\t\t\ttitle=\"New comment\"\n\t\t\t\t\t\trefName={newCommentRef}\n\t\t\t\t\t\tsubmitHandler={newCommentHandler}\n\t\t\t\t\t\tborder\n\t\t\t\t\t/>\n\t\t\t\t)}\n\t\t\t\t{isLoading && <LoadingCircle />}\n\t\t\t</div>\n\t\t)\n\t);\n}\n","import React, { useState, useRef, useEffect } from \"react\";\n\nimport ui from \"../../styles/ui.module.css\";\n\nexport default function SideBarWrapper(props) {\n\tconst [open, setOpen] = useState(false);\n\tconst closeSidebarTimer = useRef();\n\n\tuseEffect(() => {\n\t\treturn () => {\n\t\t\tclearInterval(closeSidebarTimer.current);\n\t\t};\n\t}, []);\n\n\t// Click handler\n\tconst clickHandler = () => {\n\t\tif (closeSidebarTimer.current) {\n\t\t\treturn;\n\t\t}\n\t\tsetOpen(true);\n\n\t\tclearInterval(closeSidebarTimer.current);\n\t\tcloseSidebarTimer.current = setInterval(() => {\n\t\t\tsetOpen(false);\n\t\t\tclearInterval(closeSidebarTimer.current);\n\t\t\tcloseSidebarTimer.current = null;\n\t\t}, props.time);\n\n\t\tprops.onClick();\n\t};\n\n\tconst Component = props.WrappedComponent;\n\n\tconst containerStyle = {\n\t\ttop: props.top,\n\t\tbackgroundColor: props.backgroundColor,\n\t};\n\n\tconst iconStyle = {\n\t\tcolor: props.color,\n\t};\n\n\treturn (\n\t\t<div\n\t\t\tclassName={ui[\"sidebar-container\"]}\n\t\t\tstyle={containerStyle}\n\t\t\tonClick={clickHandler}\n\t\t>\n\t\t\t{open && <p className={ui[\"sidebar-text\"]}>{props.text}</p>}\n\t\t\t<Component className={ui[\"sidebar-icon\"]} style={iconStyle} />\n\t\t</div>\n\t);\n}\n","import React, { useState } from \"react\";\n\nimport { IoIosCopy } from \"react-icons/io\";\nimport { Colors } from \"../../constants/Colors\";\nimport SideBarWrapper from \"../SideBarWrapper/SideBarWrapper\";\n\nexport default function CopyButton(props) {\n\tconst [isCopyMode, setIsCopyMode] = useState(false);\n\n\tconst onClick = () => {\n\t\tprops.onClick();\n\t\tsetIsCopyMode((state) => !state);\n\t};\n\n\treturn (\n\t\t<SideBarWrapper\n\t\t\tWrappedComponent={IoIosCopy}\n\t\t\ttext={isCopyMode ? \"Edit mode!\" : \"Regular mode!\"}\n\t\t\ttop={200}\n\t\t\tonClick={onClick}\n\t\t\tbackgroundColor={Colors.primary}\n\t\t\tcolor=\"white\"\n\t\t\ttime={500}\n\t\t/>\n\t);\n}\n","import React from \"react\";\nimport { useHistory } from \"react-router\";\n\nimport { BiHelpCircle } from \"react-icons/bi\";\nimport { Colors } from \"../../constants/Colors\";\nimport SideBarWrapper from \"../SideBarWrapper/SideBarWrapper\";\n\nexport default function SaveBar() {\n\tconst history = useHistory();\n\n\tconst onClick = () => {\n\t\thistory.push(\"/help\");\n\t}\n\n\treturn (\n\t\t<SideBarWrapper\n\t\t\tWrappedComponent={BiHelpCircle}\n\t\t\ttext=\"\"\n\t\t\ttop={250}\n\t\t\tonClick={onClick}\n\t\t\tbackgroundColor={Colors.dark}\n\t\t\tcolor=\"white\"\n\t\t\ttime={0}\n\t\t/>\n\t);\n}\n","import React, { useState, useRef, useEffect } from \"react\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { useHistory } from \"react-router\";\n\nimport * as songsActions from \"../../store/actions/songsActions\";\nimport LoadingCircle from \"../LoadingCircle/LoadingCircle\";\nimport design from \"../../styles/ui.module.css\";\nimport styles from \"./InfoBar.module.css\";\n\nexport default function InfoBar(props) {\n\tconst username = useSelector((state) => state.auth.username);\n\tconst songList = useSelector((state) => state.songs.userSongs);\n\tconst [isLoading, setIsLoading] = useState(false);\n\n\tconst size = useRef(songList ? songList.length : null);\n\n\tconst history = useHistory();\n\n\tuseEffect(() => {\n\t\tif (songList && songList.length !== size.current) {\n\t\t\tsize.current = songList.length;\n\n\t\t\tconst sortedList = [...songList].sort((a, b) => a.id < b.id);\n\t\t\tconst obj = sortedList[0];\n\t\t\tsetIsLoading(false);\n\n\t\t\tif (obj) {\n\t\t\t\thistory.push(`/songs/${obj.creator}/${obj.id}`);\n\t\t\t}\n\t\t}\n\t}, [songList, history]);\n\n\tconst dispatch = useDispatch();\n\n\tconst copyHandler = () => {\n\t\tsetIsLoading(true);\n\t\tdispatch(songsActions.copySong(props.selectedSong));\n\t};\n\n\tif (!props.selectedSong) {\n\t\treturn <p></p>;\n\t}\n\n\treturn (\n\t\t<div>\n\t\t\t<p className={styles.text}>\n\t\t\t\t{props.selectedSong.creator}\n\t\t\t\t&nbsp;&nbsp;&nbsp;|\n\t\t\t\t{username && (\n\t\t\t\t\t<span onClick={copyHandler} className={design.pointer}>\n\t\t\t\t\t\t&nbsp;&nbsp;&nbsp;COPY THIS SONG\n\t\t\t\t\t</span>\n\t\t\t\t)}\n\t\t\t</p>\n\t\t\t{isLoading && <LoadingCircle />}\n\t\t</div>\n\t);\n}\n","import React, { useState, useEffect, createRef } from \"react\";\nimport { useHistory } from \"react-router\";\nimport { Colors } from \"../../constants/Colors\";\nimport LoadingCircle from \"../LoadingCircle/LoadingCircle\";\n\nimport styles from \"./LyricsBlock.module.css\";\nimport ui from \"../../styles/ui.module.css\";\n\nexport default function LyricsBlock(props) {\n\tconst selectedSong = props.selectedSong;\n\tconst [lastClicked, setLastClicked] = useState();\n\tconst [clickedChords, setClickedChords] = useState([]);\n\tconst [pasteMode, setPasteMode] = useState(\"none\");\n\n\tconst { chordRefs, setChordRefs, lyricRefs, setLyricRefs } = props;\n\n\tuseEffect(() => {\n\t\tconst arrLength = selectedSong.lyrics.split(\"\\n\").length;\n\n\t\tif (!chordRefs || arrLength !== chordRefs.length) {\n\t\t\tconst newRefs = new Array(arrLength).fill().map(() => createRef());\n\t\t\tsetChordRefs(newRefs);\n\t\t}\n\t}, [selectedSong, chordRefs, setChordRefs]);\n\n\tuseEffect(() => {\n\t\tconst arrLength = selectedSong.lyrics.split(\"\\n\").length;\n\n\t\tif (!lyricRefs || arrLength !== lyricRefs.length) {\n\t\t\tconst newRefs = new Array(arrLength).fill().map(() => createRef());\n\t\t\tsetLyricRefs(newRefs);\n\t\t}\n\t}, [selectedSong, lyricRefs, setLyricRefs]);\n\n\tconst history = useHistory();\n\n\tuseEffect(() => {\n\t\tconst unlisten = history.listen(() => setClickedChords([]));\n\n\t\treturn () => unlisten();\n\t}, [history]);\n\n\t// Enter causes blur for both chords and lyrics\n\tconst preventEnterHandler = (event) => {\n\t\tprops.setUnsavedChanges(true);\n\n\t\tif (event.key === \"Enter\") {\n\t\t\tevent.preventDefault();\n\t\t\tevent.target.blur();\n\t\t} else if (event.key === \".\") {\n\t\t\tevent.preventDefault();\n\t\t\tevent.target.value += \"    \";\n\t\t} else if (event.key === \",\") {\n\t\t\tevent.preventDefault();\n\t\t\tconst val = event.target.value;\n\t\t\tevent.target.value =\n\t\t\t\tval.length <= 4 ? \"\" : val.substr(0, val.length - 4);\n\t\t}\n\t};\n\n\t// If lyric line is turned to \"\", it will be rendered as two blank lines\n\t// Change to \" \"\n\tconst lyricsBlurHandler = (e) => {\n\t\tif (e.target.innerText === \"\") {\n\t\t\te.target.innerText = \" \";\n\t\t}\n\t};\n\n\tconst addToList = (id) => {\n\t\tsetClickedChords((state) =>\n\t\t\tstate.indexOf(id) === -1\n\t\t\t\t? [...state, id]\n\t\t\t\t: state.filter((value) => value !== id)\n\t\t);\n\t};\n\n\tconst selectHandler = (e) => {\n\t\tif (!props.isCopyMode) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst id = +e.target.id;\n\n\t\t// While selecting\n\t\tif (pasteMode === \"none\") {\n\t\t\tif (e.altKey) {\n\t\t\t\tselectMultipleHandler(id);\n\t\t\t} else {\n\t\t\t\taddToList(id);\n\t\t\t}\n\n\t\t\tsetLastClicked(id);\n\t\t\treturn;\n\t\t}\n\n\t\tif (clickedChords.length === 0) {\n\t\t\tresetHandler();\n\t\t\treturn;\n\t\t}\n\n\t\t// While pasting\n\t\tconst sortedChords = [...clickedChords].sort((a, b) => a - b);\n\t\tconst start = sortedChords[0];\n\t\tconst range = sortedChords[sortedChords.length - 1] - start + 1;\n\n\t\tprops.setUnsavedChanges(true);\n\n\t\tconst chordRefsCopy = chordRefs.map((ref) => ref.current.value);\n\n\t\tif (pasteMode === \"paste\") {\n\t\t\tfor (const i of sortedChords) {\n\t\t\t\tconst newId = id + i - start;\n\t\t\t\tconst copyFrom = chordRefsCopy[i];\n\n\t\t\t\tconst copyTo = chordRefs[newId];\n\t\t\t\tif (!copyTo || copyTo.current === undefined) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcopyTo.current.value = copyFrom;\n\t\t\t}\n\t\t} else {\n\t\t\tlet multiple = 0;\n\t\t\tlet shouldBreak = false;\n\t\t\twhile (true) {\n\t\t\t\t// Same as above, except we use multiple + range to offset the new sequence\n\t\t\t\tfor (const i of sortedChords) {\n\t\t\t\t\tconst newId = id + i - start + multiple * range;\n\t\t\t\t\tconst copyFrom = chordRefsCopy[i];\n\n\t\t\t\t\tconst copyTo = chordRefs[newId];\n\t\t\t\t\tif (!copyTo || copyTo.current === undefined) {\n\t\t\t\t\t\tshouldBreak = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tcopyTo.current.value = copyFrom;\n\t\t\t\t}\n\t\t\t\tif (shouldBreak) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\t++multiple;\n\t\t\t}\n\t\t}\n\t\tresetHandler();\n\t};\n\n\tconst selectMultipleHandler = (id) => {\n\t\tif (lastClicked !== null) {\n\t\t\tif (id > lastClicked) {\n\t\t\t\tfor (let i = lastClicked + 1; i <= id; ++i) {\n\t\t\t\t\taddToList(i);\n\t\t\t\t}\n\t\t\t} else if (lastClicked > id) {\n\t\t\t\tfor (let i = lastClicked - 1; i >= id; --i) {\n\t\t\t\t\taddToList(i);\n\t\t\t\t}\n\t\t\t} else if (lastClicked === id) {\n\t\t\t\taddToList(id);\n\t\t\t}\n\t\t} else {\n\t\t\taddToList(id);\n\t\t}\n\t};\n\n\tconst resetHandler = () => {\n\t\tsetClickedChords([]);\n\t\tsetLastClicked(null);\n\t\tsetPasteMode(\"none\");\n\t};\n\n\tconst copyHandler = () => {\n\t\tsetPasteMode(\"paste\");\n\t\tsetLastClicked(null);\n\t};\n\n\tconst copyUntilEndHandler = () => {\n\t\tsetPasteMode(\"pasteUntilEnd\");\n\t\tsetLastClicked(null);\n\t};\n\n\tconst emptyHandler = () => {\n\t\tfor (const i of clickedChords) {\n\t\t\tchordRefs[i].current.value = \"\";\n\t\t}\n\t\tresetHandler();\n\t};\n\n\t// Takes in string lyrics and turns each into a string and input div\n\tconst renderItems = () => {\n\t\treturn selectedSong.lyrics.split(\"\\n\").map((item, idx) => {\n\t\t\tlet chordStyles = {};\n\t\t\tif (props.isCopyMode) {\n\t\t\t\tif (idx === lastClicked) {\n\t\t\t\t\tchordStyles = {\n\t\t\t\t\t\t// ...chordStyles,\n\t\t\t\t\t\tbackgroundColor: Colors.primary,\n\t\t\t\t\t};\n\t\t\t\t} else if (clickedChords.indexOf(idx) !== -1) {\n\t\t\t\t\tchordStyles = {\n\t\t\t\t\t\t// ...chordStyles,\n\t\t\t\t\t\tbackgroundColor: Colors.primaryLight,\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn (\n\t\t\t\t<div key={idx}>\n\t\t\t\t\t<input\n\t\t\t\t\t\tref={chordRefs[idx]}\n\t\t\t\t\t\tid={idx}\n\t\t\t\t\t\tclassName={ui[\"dashed-input\"]}\n\t\t\t\t\t\tstyle={chordStyles}\n\t\t\t\t\t\tdefaultValue={\n\t\t\t\t\t\t\tselectedSong.chords.split(\"\\n\")[idx] ?? \"\"\n\t\t\t\t\t\t}\n\t\t\t\t\t\tonKeyDown={preventEnterHandler}\n\t\t\t\t\t\tautoCorrect=\"off\"\n\t\t\t\t\t\tonClick={selectHandler}\n\t\t\t\t\t\treadOnly={!props.editable || props.isCopyMode}\n\t\t\t\t\t/>\n\t\t\t\t\t<p\n\t\t\t\t\t\tref={lyricRefs[idx]}\n\t\t\t\t\t\tclassName={styles[\"lyric-line\"]}\n\t\t\t\t\t\tcontentEditable={props.editable || props.isCopyMode}\n\t\t\t\t\t\tsuppressContentEditableWarning={\n\t\t\t\t\t\t\tprops.editable || props.isCopyMode\n\t\t\t\t\t\t}\n\t\t\t\t\t\tonKeyDown={preventEnterHandler}\n\t\t\t\t\t\tonBlur={lyricsBlurHandler}\n\t\t\t\t\t\tspellCheck={false}\n\t\t\t\t\t>\n\t\t\t\t\t\t{item}\n\t\t\t\t\t</p>\n\t\t\t\t</div>\n\t\t\t);\n\t\t});\n\t};\n\n\tconst bottomOption = (label, onClick) => {\n\t\treturn (\n\t\t\t<span className={ui.pointer} onClick={onClick}>\n\t\t\t\t&nbsp;&nbsp;&nbsp;&nbsp;{label}&nbsp;&nbsp;&nbsp;&nbsp;\n\t\t\t</span>\n\t\t);\n\t};\n\n\tif (!chordRefs || !lyricRefs) {\n\t\treturn <LoadingCircle />;\n\t}\n\n\treturn (\n\t\t<div>\n\t\t\t{props.isCopyMode && (\n\t\t\t\t<div className={styles[\"toolbar\"]}>\n\t\t\t\t\t{bottomOption(\"Clear\", resetHandler)}|\n\t\t\t\t\t{bottomOption(\"Copy\", copyHandler)}|\n\t\t\t\t\t{bottomOption(\"Copy until end\", copyUntilEndHandler)}|\n\t\t\t\t\t{bottomOption(\"Empty\", emptyHandler)}\n\t\t\t\t</div>\n\t\t\t)}\n\t\t\t<h2 className={ui[\"song-subtitle\"]}>Lyrics</h2>\n\t\t\t{selectedSong.lyrics === \"\" ? (\n\t\t\t\t<p className={styles[\"lyric-line\"]}>No lyrics found.</p>\n\t\t\t) : (\n\t\t\t\trenderItems()\n\t\t\t)}\n\t\t</div>\n\t);\n}\n","import React from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport * as songsActions from \"../../store/actions/songsActions\";\nimport LoadingCircle from \"../LoadingCircle/LoadingCircle\";\n\nimport ui from \"../../styles/ui.module.css\";\n\nexport default function PulledLyricsBlock(props) {\n\tconst { selectedSong, pulledLyricsRef } = props;\n\n\tconst dispatch = useDispatch();\n\n\tconst keyDownHandler = () => {\n\t\tprops.setUnsavedChanges(true);\n\t};\n\n\t// If the user manually types in the lyrics, the transfer will occur on the redux state, and the typed in lyrics haven't been updated to redux yet\n\t// We need to dispatch on blur\n\tconst blurHandler = (e) => {\n\t\tif (e.target.innerText === selectedSong.pulled_lyrics) {\n\t\t\treturn;\n\t\t}\n\t\tdispatch(\n\t\t\tsongsActions.updateSong(\n\t\t\t\tselectedSong.id,\n\t\t\t\t\"pulled_lyrics\",\n\t\t\t\te.target.innerText\n\t\t\t)\n\t\t);\n\t};\n\n\tif (!pulledLyricsRef) {\n\t\treturn <LoadingCircle />;\n\t}\n\n\treturn (\n\t\t<div>\n\t\t\t<h2 className={ui[\"song-subtitle\"]}>Pulled Lyrics</h2>\n\t\t\t<p\n\t\t\t\tref={pulledLyricsRef}\n\t\t\t\tclassName={ui[\"dashed-input\"]}\n\t\t\t\tcontentEditable={true}\n\t\t\t\tsuppressContentEditableWarning={true}\n\t\t\t\tonKeyDown={keyDownHandler}\n\t\t\t\tonBlur={blurHandler}\n\t\t\t\tspellCheck={false}\n\t\t\t>\n\t\t\t\t{selectedSong.pulled_lyrics\n\t\t\t\t\t? selectedSong.pulled_lyrics\n\t\t\t\t\t: \"Get started by typing the name and artist of a song above. Then, press Options --> Fetch Lyrics to scrape the web for the lyrics of your song or copy paste the lyrics here. When you're satisfied, press Options --> Transfer Lyrics to start annotating the lyrics with chords in the Lyrics section. Once you've annotated, press auto scroll in the top right corner to start playing through!\\n\\nClick the help section in the top navigation bar to learn more!\\n\\nTo get an idea of how this works, press Transfer Lyrics with the current text!\"}\n\t\t\t</p>\n\t\t</div>\n\t);\n}\n","import React from \"react\";\n\nimport { AiOutlineSave } from \"react-icons/ai\";\nimport { Colors } from \"../../constants/Colors\";\nimport SideBarWrapper from \"../SideBarWrapper/SideBarWrapper\";\n\nexport default function SaveBar(props) {\n\treturn (\n\t\t<SideBarWrapper\n\t\t\tWrappedComponent={AiOutlineSave}\n\t\t\ttext=\"Saved!\"\n\t\t\ttop={150}\n\t\t\tonClick={props.onClick}\n\t\t\tbackgroundColor={Colors.accent}\n\t\t\tcolor=\"white\"\n\t\t\ttime={2000}\n\t\t/>\n\t);\n}\n","import React from \"react\";\nimport LoadingCircle from \"../LoadingCircle/LoadingCircle\";\n\nimport ui from \"../../styles/ui.module.css\";\n\nexport default function StrummingPatternBlock(props) {\n\tconst selectedSong = props.selectedSong;\n\n\t// On strumming pattern key down, prevent default enter\n\tconst keyDownHandler = (event) => {\n\t\tif (event.key === \"Enter\") {\n\t\t\tevent.preventDefault();\n\t\t\tevent.target.blur();\n\t\t}\n\n\t\tprops.setUnsavedChanges(true);\n\t};\n\n\tif (!props.strummingPatternRef) {\n\t\treturn <LoadingCircle />;\n\t}\n\n\treturn (\n\t\t<div>\n\t\t\t<h2 className={ui[\"song-subtitle\"]}>Strumming Pattern</h2>\n\t\t\t<input\n\t\t\t\tref={props.strummingPatternRef}\n\t\t\t\tclassName={ui[\"dashed-input\"]}\n\t\t\t\tdefaultValue={selectedSong.strumming_pattern}\n\t\t\t\tonKeyDown={keyDownHandler}\n\t\t\t\tautoCorrect=\"off\"\n\t\t\t\treadOnly={!props.editable}\n\t\t\t/>\n\t\t</div>\n\t);\n}\n","import React, {\n\tuseState,\n\tuseRef,\n\tuseEffect,\n\tuseCallback,\n\tcreateRef,\n} from \"react\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { useHistory } from \"react-router\";\n\nimport * as songsActions from \"../../store/actions/songsActions\";\nimport { Colors } from \"../../constants/Colors\";\nimport Comments from \"../../components/Comments/Comments\";\nimport {\n\tcompareSongsByValue,\n\tgetUsername,\n\tincrementViewCount,\n\tupdateSongToDatabase,\n} from \"../../util\";\nimport CopyButton from \"../../components/CopyButton/CopyButton\";\nimport HelpButton from \"../../components/HelpButton/HelpButton\";\nimport InfoBar from \"../../components/InfoBar/InfoBar\";\nimport LoadingCircle from \"../../components/LoadingCircle/LoadingCircle\";\nimport LyricsBlock from \"../../components/LyricsBlock/LyricsBlock\";\nimport PulledLyricsBlock from \"../../components/PulledLyricsBlock/PulledLyricsBlock\";\nimport SaveBar from \"../../components/SaveBar/SaveBar\";\nimport StrummingPatternBlock from \"../../components/StrummingPatternBlock/StrummingPatternBlock\";\nimport styles from \"./Song.module.css\";\nimport layout from \"../../styles/layout.module.css\";\nimport ui from \"../../styles/ui.module.css\";\n\nexport default function Song(props) {\n\tconst stateReceived = useRef(false);\n\tconst hasUnsavedChanges = useRef(false);\n\tconst [isCopyMode, setIsCopyMode] = useState(false);\n\n\t// If pulled lyrics are being fetched, use Fetching... text\n\tconst isViewOnly = useSelector(\n\t\t(state) => state.selectedSong.isSongPageView\n\t);\n\tconst songLink = useSelector((state) => state.selectedSong.songLink);\n\tconst isFetching = useSelector((state) => state.selectedSong.isFetching);\n\tconst isAdmin = useSelector((state) => state.auth.admin);\n\n\t// References to chord, lyrics, strumming pattern, and pulled lyrics inputs\n\tconst [chordRefs, setChordRefs] = useState();\n\tconst [lyricRefs, setLyricRefs] = useState();\n\tconst strummingPatternRef = createRef();\n\tconst pulledLyricsRef = createRef();\n\n\tconst dispatch = useDispatch();\n\tconst history = useHistory();\n\n\t// References to title and artist inputs\n\tconst nameRef = createRef();\n\tconst artistRef = createRef();\n\n\tconst path = history.location.pathname.split(\"/\");\n\n\tconst selectedSong = useSelector((state) => {\n\t\tconst isView = path[path.length - 1] === \"view\";\n\t\tconst list = isView ? state.songs.publicSongs : state.songs.userSongs;\n\t\t// On app refresh, redux state is reset, and state reverts to its initial store\n\t\t// If state is empty, we wait for request to be issued\n\t\tif (!list) {\n\t\t\treturn null;\n\t\t} else {\n\t\t\tstateReceived.current = true;\n\t\t}\n\n\t\tconst id = +props.match.params.id;\n\t\tconst username = props.match.params.username;\n\t\treturn list.find((song) => {\n\t\t\treturn song.id === id && song.creator === username;\n\t\t});\n\t});\n\n\tconst originalSong = useRef(selectedSong);\n\n\tuseEffect(() => {\n\t\tif (selectedSong) {\n\t\t\tnameRef.current.value = selectedSong.name;\n\t\t\tartistRef.current.value = selectedSong.artist;\n\t\t}\n\t}, [selectedSong, nameRef, artistRef]);\n\n\t// Increment views\n\tuseEffect(() => {\n\t\tconst databaseCall = async () => {\n\t\t\ttry {\n\t\t\t\tconst response = await incrementViewCount(selectedSong.id);\n\n\t\t\t\tif (response.data === \"View has already been recorded for user.\") {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// If view already exists for this person, error will be thrown so this next line won't be ran\n\t\t\t\tdispatch(songsActions.incrementView(selectedSong.id));\n\t\t\t} catch (err) {\n\t\t\t\tconsole.log(err.response ? err.response.data : err.message);\n\t\t\t}\n\t\t};\n\n\t\tif (selectedSong && selectedSong.public) {\n\t\t\tdatabaseCall();\n\t\t}\n\t}, [selectedSong, dispatch]);\n\n\t// On react route change, confirm that the user wants to leave with unsaved changes\n\tuseEffect(() => {\n\t\tif (!isViewOnly) {\n\t\t\tconst unblock = history.block(() => {\n\t\t\t\tconst ogSong = originalSong.current;\n\n\t\t\t\tif (\n\t\t\t\t\thasUnsavedChanges.current ||\n\t\t\t\t\t!compareSongsByValue(ogSong, selectedSong)\n\t\t\t\t) {\n\t\t\t\t\t// Prompt the user for confirmation\n\t\t\t\t\tconst response = window.confirm(\n\t\t\t\t\t\t\"You have unsaved changes! Are you sure you want to leave?\"\n\t\t\t\t\t);\n\n\t\t\t\t\t// Replace redux state with most recent form\n\t\t\t\t\tif (response) {\n\t\t\t\t\t\tdispatch(songsActions.replaceSong(ogSong.id, ogSong));\n\t\t\t\t\t}\n\t\t\t\t\treturn response;\n\t\t\t\t}\n\n\t\t\t\treturn true;\n\t\t\t});\n\n\t\t\treturn () => unblock();\n\t\t}\n\t}, [selectedSong, history, dispatch, isViewOnly, originalSong]);\n\n\t// Show are you sure you want to leave upon refresh or closing the page (not for react routing)\n\t// We don't need to dispatch originalSong.current to the redux state because the redux state is being reset anyways after refresh\n\tconst componentCleanup = useCallback(\n\t\t(event) => {\n\t\t\tif (\n\t\t\t\thasUnsavedChanges.current ||\n\t\t\t\t!compareSongsByValue(selectedSong, originalSong.current)\n\t\t\t) {\n\t\t\t\tevent.preventDefault();\n\t\t\t\tevent.returnValue = \"\";\n\t\t\t}\n\t\t},\n\t\t[selectedSong]\n\t);\n\n\t// On page refresh or x, confirm that the user wants to leave with unsaved changes\n\tuseEffect(() => {\n\t\tif (!isViewOnly) {\n\t\t\twindow.addEventListener(\"beforeunload\", componentCleanup);\n\n\t\t\treturn () =>\n\t\t\t\twindow.removeEventListener(\"beforeunload\", componentCleanup);\n\t\t}\n\t}, [componentCleanup, isViewOnly]);\n\n\t// Check that the user is authenticated\n\tuseEffect(() => {\n\t\tconst validateUsername = async () => {\n\t\t\t// Double check (important!! if you press song -> back button -> same song again)\n\t\t\tif (path[path.length - 1] === \"view\") {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst linkUsername = props.match.params.username;\n\n\t\t\tconst username = await getUsername();\n\t\t\t// Redirect to view only if usernames don't line up\n\t\t\tif (linkUsername !== username) {\n\t\t\t\tconst id = props.match.params.id;\n\n\t\t\t\thistory.push(`/songs/${linkUsername}/${id}/view`);\n\t\t\t}\n\t\t};\n\n\t\tif (!isAdmin && !isViewOnly) {\n\t\t\tvalidateUsername();\n\t\t}\n\t}, [\n\t\tprops.match.params.username,\n\t\thistory,\n\t\tsongLink,\n\t\tisAdmin,\n\t\tisViewOnly,\n\t\tpath,\n\t\tprops.match.params.id,\n\t]);\n\n\t// When the page is reloaded (e.g. a new URL is entered), validate URL\n\tuseEffect(() => {\n\t\tconst songExists = async () => {\n\t\t\t// If song doesn't exist in view only page as well\n\t\t\tif (path[path.length - 1] === \"view\") {\n\t\t\t\tif (!selectedSong && stateReceived.current) {\n\t\t\t\t\thistory.push(\"/songs/public\");\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// If the songs are still being fetched, an undefined selectedSong should not trigger a redirect\n\t\t\t// Only if songs have been fetched and there still is no match for the URL parameters, should we redirect\n\t\t\tif (!selectedSong && stateReceived.current) {\n\t\t\t\tconst linkUsername = props.match.params.username;\n\t\t\t\tconst id = props.match.params.id;\n\n\t\t\t\t// Attempt to redirect to view page (if the user wants to share and displays a public link), but if song truly doesn't exist, will be handled there\n\t\t\t\thistory.push(`/songs/${linkUsername}/${id}/view`);\n\t\t\t} else if (selectedSong && !originalSong.current) {\n\t\t\t\toriginalSong.current = selectedSong;\n\t\t\t}\n\t\t};\n\n\t\t// If name was switched, the info must be validated\n\t\tsongExists();\n\t}, [\n\t\tselectedSong,\n\t\tdispatch,\n\t\thistory,\n\t\tsongLink,\n\t\tprops.match.params.username,\n\t\tprops.match.params.id,\n\t\tpath,\n\t]);\n\n\t// Allows components to change hasUnsavedChanges\n\tconst setUnsavedChanges = (value) => {\n\t\tif (hasUnsavedChanges.current !== value) {\n\t\t\thasUnsavedChanges.current = value;\n\t\t}\n\t};\n\n\t// Update original song to be the most recently saved version\n\tconst dispatchSong = () => {\n\t\t// Get lyrics and chords\n\t\tlet newLyrics = \"\";\n\t\tlet newChords = \"\";\n\t\tif (selectedSong.lyrics === \"\") {\n\t\t\tnewLyrics = \"\";\n\t\t\tnewChords = \"\";\n\t\t} else {\n\t\t\tconst len = selectedSong.lyrics.split(\"\\n\").length;\n\t\t\tfor (let i = 0; i < len; ++i) {\n\t\t\t\tconst lyricsInput = lyricRefs[i].current;\n\t\t\t\tnewLyrics += lyricsInput.innerText;\n\t\t\t\tnewLyrics += i === len - 1 ? \"\" : \"\\n\";\n\n\t\t\t\tconst chordsInput = chordRefs[i].current;\n\t\t\t\tnewChords += chordsInput.value;\n\t\t\t\tnewChords += i === len - 1 ? \"\" : \"\\n\";\n\t\t\t}\n\t\t}\n\n\t\t// Get title and artist\n\t\tconst newName = nameRef.current.value;\n\t\tconst newArtist = artistRef.current.value;\n\n\t\t// Get strumming pattern\n\t\tconst newStrummingPattern = strummingPatternRef.current.value;\n\t\t// Get pulled lyrics\n\t\tconst newPulledLyrics = pulledLyricsRef.current.innerText;\n\n\t\toriginalSong.current = {\n\t\t\t...selectedSong,\n\t\t\tlyrics: newLyrics,\n\t\t\tchords: newChords,\n\t\t\tname: newName,\n\t\t\tartist: newArtist,\n\t\t\tstrumming_pattern: newStrummingPattern,\n\t\t\tpulled_lyrics: newPulledLyrics,\n\t\t};\n\n\t\t// Update to database and update redux state\n\t\tupdateSongToDatabase(originalSong.current);\n\t\tdispatch(songsActions.updateSong(selectedSong.id, \"lyrics\", newLyrics));\n\t\tdispatch(songsActions.updateSong(selectedSong.id, \"chords\", newChords));\n\t\tdispatch(songsActions.updateSong(selectedSong.id, \"name\", newName));\n\t\tdispatch(songsActions.updateSong(selectedSong.id, \"artist\", newArtist));\n\t\tdispatch(\n\t\t\tsongsActions.updateSong(\n\t\t\t\tselectedSong.id,\n\t\t\t\t\"strumming_pattern\",\n\t\t\t\tnewStrummingPattern\n\t\t\t)\n\t\t);\n\t\tdispatch(\n\t\t\tsongsActions.updateSong(\n\t\t\t\tselectedSong.id,\n\t\t\t\t\"pulled_lyrics\",\n\t\t\t\tnewPulledLyrics\n\t\t\t)\n\t\t);\n\t\tsetUnsavedChanges(false);\n\t};\n\n\t// Enter causes blur\n\tconst preventEnterHandler = (event) => {\n\t\tsetUnsavedChanges(true);\n\n\t\tif (event.key === \"Enter\") {\n\t\t\tevent.preventDefault();\n\t\t\tevent.target.blur();\n\t\t}\n\t};\n\n\t// On title or artist blur\n\tconst inputBlur = () => {\n\t\tconst name = nameRef.current.value;\n\t\tconst artist = artistRef.current.value;\n\n\t\tconst id = selectedSong.id;\n\n\t\t// If nothing changed, don't make database call\n\t\tif (selectedSong.name === name && selectedSong.artist === artist) {\n\t\t\treturn;\n\t\t}\n\t\tconst choice = name !== selectedSong.name ? \"name\" : \"artist\";\n\t\tconst val = name !== selectedSong.name ? name : artist;\n\n\t\tdispatch(songsActions.updateSong(id, choice, val));\n\t};\n\n\tconst copyHandler = () => {\n\t\tsetIsCopyMode((state) => !state);\n\t};\n\n\tif (!selectedSong) {\n\t\treturn <LoadingCircle />;\n\t}\n\n\tlet editableKwargs = { editable: false, isCopyMode: false };\n\tif (!isViewOnly) {\n\t\teditableKwargs[\"editable\"] = true;\n\t}\n\tif (isCopyMode) {\n\t\teditableKwargs[\"isCopyMode\"] = true;\n\t}\n\tconst inputKwargs = isViewOnly ? { readOnly: true } : {};\n\n\tconst containerStyles = {\n\t\tbackgroundColor: isCopyMode ? Colors.emphasis : \"\",\n\t};\n\n\treturn (\n\t\t<div className={layout.container} style={containerStyles}>\n\t\t\t{isFetching && <LoadingCircle />}\n\n\t\t\t{/* Information about creator  */}\n\t\t\t<InfoBar selectedSong={selectedSong} />\n\n\t\t\t{/* Save bar  */}\n\t\t\t{!isViewOnly && <SaveBar onClick={dispatchSong} />}\n\t\t\t{!isViewOnly && <CopyButton onClick={copyHandler} />}\n\n\t\t\t<HelpButton />\n\n\t\t\t{/* Title  */}\n\t\t\t<input\n\t\t\t\tclassName={ui[\"title\"]}\n\t\t\t\tdefaultValue={selectedSong.name}\n\t\t\t\tplaceholder=\"Title\"\n\t\t\t\tonKeyDown={preventEnterHandler}\n\t\t\t\tonBlur={inputBlur}\n\t\t\t\tref={nameRef}\n\t\t\t\t{...inputKwargs}\n\t\t\t/>\n\n\t\t\t{/* Artist  */}\n\t\t\t<input\n\t\t\t\tclassName={styles.artist}\n\t\t\t\tdefaultValue={selectedSong.artist}\n\t\t\t\tplaceholder=\"Artist\"\n\t\t\t\tonKeyDown={preventEnterHandler}\n\t\t\t\tonBlur={inputBlur}\n\t\t\t\tref={artistRef}\n\t\t\t\t{...inputKwargs}\n\t\t\t/>\n\n\t\t\t<StrummingPatternBlock\n\t\t\t\tselectedSong={selectedSong}\n\t\t\t\tsetUnsavedChanges={setUnsavedChanges}\n\t\t\t\tstrummingPatternRef={strummingPatternRef}\n\t\t\t\t{...editableKwargs}\n\t\t\t/>\n\n\t\t\t<LyricsBlock\n\t\t\t\tselectedSong={selectedSong}\n\t\t\t\tsetUnsavedChanges={setUnsavedChanges}\n\t\t\t\tisCopyMode={isCopyMode}\n\t\t\t\tchordRefs={chordRefs}\n\t\t\t\tsetChordRefs={setChordRefs}\n\t\t\t\tlyricRefs={lyricRefs}\n\t\t\t\tsetLyricRefs={setLyricRefs}\n\t\t\t\t{...editableKwargs}\n\t\t\t/>\n\n\t\t\t{!isViewOnly && (\n\t\t\t\t<PulledLyricsBlock\n\t\t\t\t\tselectedSong={selectedSong}\n\t\t\t\t\tsetUnsavedChanges={setUnsavedChanges}\n\t\t\t\t\tpulledLyricsRef={pulledLyricsRef}\n\t\t\t\t/>\n\t\t\t)}\n\n\t\t\t<Comments id={selectedSong.id} />\n\t\t</div>\n\t);\n}\n","import React, { useState, useEffect } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport { useHistory } from \"react-router\";\nimport { Route, Switch } from \"react-router-dom\";\n\nimport * as selectedSongActions from \"../../store/actions/selectedSongActions\";\nimport * as authActions from \"../../store/actions/authActions\";\nimport * as songsActions from \"../../store/actions/songsActions\";\nimport Auth from \"../../screens/Auth/Auth\";\nimport ConfirmEmail from \"../../screens/ConfirmEmail/ConfirmEmail\";\nimport CustomSidebar from \"../CustomSideBar/CustomSidebar\";\nimport ErrorScreen from \"../Error/Error\";\nimport { getUsername } from \"../../util\";\nimport Help from \"../../screens/Help/Help\";\nimport Home from \"../../screens/Home/Home\";\nimport MenuBar from \"../MenuBar/MenuBar\";\nimport NavBar from \"../NavBar/NavBar\";\nimport PublicList from \"../../screens/PublicList/PublicList\";\nimport PasswordReset from \"../../screens/PasswordReset/PasswordReset\";\nimport PasswordChange from \"../../screens/PasswordChange/PasswordChange\";\nimport Profile from \"../../screens/Profile/Profile\";\nimport SongList from \"../../screens/SongList/SongList\";\nimport Song from \"../../screens/Song/Song\";\n\nexport default function Router(props) {\n\t// For side menu bar in portrait mode\n\tconst [menuOpen, setMenuOpen] = useState(false);\n\n\tconst menuClickHandler = () => {\n\t\tsetMenuOpen((state) => !state);\n\t};\n\n\tconst history = useHistory();\n\tconst dispatch = useDispatch();\n\n\t// Every time the page is refreshed, reclaim redux state\n\tuseEffect(() => {\n\t\tdispatch(songsActions.getPublicSongs());\n\n\t\tconst queryUsername = async () => {\n\t\t\tconst username = await getUsername();\n\n\t\t\tdispatch(authActions.setUsername(username));\n\t\t\tif (username) {\n\t\t\t\tdispatch(songsActions.getUserSongs());\n\t\t\t}\n\t\t};\n\n\t\tqueryUsername();\n\t}, [dispatch]);\n\n\t// On router navigation, update song page redux states\n\tuseEffect(() => {\n\t\tconst updateRedux = () => {\n\t\t\tconst URL = window.location.href.split(\"/\");\n\t\t\t// E.g. [\"http:\", \"\", \"localhost:3000\", \"#\", \"songs\", 1, \"adele-hello\"]\n\t\t\tif (URL.length === 7 && URL[4] === \"songs\") {\n\t\t\t\tdispatch(selectedSongActions.setIsSongPage(true));\n\t\t\t\tdispatch(selectedSongActions.setIsSongPageView(false));\n\n\t\t\t\tconst songLink = URL[6];\n\t\t\t\tdispatch(selectedSongActions.setSongLink(songLink));\n\t\t\t} else if (\n\t\t\t\tURL.length === 8 &&\n\t\t\t\tURL[4] === \"songs\" &&\n\t\t\t\tURL[7] === \"view\"\n\t\t\t) {\n\t\t\t\tdispatch(selectedSongActions.setIsSongPageView(true));\n\t\t\t\tdispatch(selectedSongActions.setIsSongPage(false));\n\n\t\t\t\tconst songLink = URL[6];\n\t\t\t\tdispatch(selectedSongActions.setSongLink(songLink));\n\t\t\t} else {\n\t\t\t\tdispatch(selectedSongActions.setIsSongPage(false));\n\t\t\t\tdispatch(selectedSongActions.setIsSongPageView(false));\n\n\t\t\t\tdispatch(selectedSongActions.setSongLink(null));\n\t\t\t}\n\t\t};\n\n\t\tupdateRedux();\n\n\t\tconst unlisten = history.listen(() => {\n\t\t\tupdateRedux();\n\t\t});\n\n\t\treturn () => unlisten();\n\t}, [dispatch, history]);\n\n\t// Routes\n\tconst Body = () => (\n\t\t<Switch>\n\t\t\t<Route exact path=\"/\" component={Home} />\n\t\t\t<Route exact path=\"/help\" component={Help} />\n\t\t\t<Route exact path=\"/user/:username\" component={Profile} />\n\t\t\t<Route\n\t\t\t\texact\n\t\t\t\tpath={[\"/accounts/login\", \"/accounts/signup\"]}\n\t\t\t\tcomponent={Auth}\n\t\t\t/>\n\t\t\t<Route\n\t\t\t\texact\n\t\t\t\tpath=\"/accounts/confirm-email\"\n\t\t\t\tcomponent={ConfirmEmail}\n\t\t\t/>\n\t\t\t<Route\n\t\t\t\texact\n\t\t\t\tpath=\"/accounts/password-reset\"\n\t\t\t\tcomponent={PasswordReset}\n\t\t\t/>\n\t\t\t<Route\n\t\t\t\texact\n\t\t\t\tpath=\"/accounts/password-change/:uid/:token\"\n\t\t\t\tcomponent={PasswordChange}\n\t\t\t/>\n\t\t\t<Route exact path=\"/songs/public\" component={PublicList} />\n\t\t\t<Route exact path=\"/songs/all\" component={SongList} />\n\t\t\t<Route exact path=\"/songs/:username\" component={SongList} />\n\t\t\t<Route\n\t\t\t\texact\n\t\t\t\tpath={[\"/songs/:username/:id\", \"/songs/:username/:id/view\"]}\n\t\t\t\tcomponent={Song}\n\t\t\t/>\n\t\t\t<Route component={ErrorScreen} />\n\t\t</Switch>\n\t);\n\n\treturn props.horizontal ? (\n\t\t<div>\n\t\t\t<NavBar />\n\t\t\t<Body />\n\t\t</div>\n\t) : (\n\t\t<CustomSidebar menuOpen={menuOpen} changeSidebar={menuClickHandler}>\n\t\t\t<MenuBar onMenuClick={menuClickHandler} />\n\t\t\t<Body />\n\t\t</CustomSidebar>\n\t);\n}\n","import {\n\tADD_SONG,\n\tDELETE_SONG,\n\tSET_FILTERED_PUBLIC_SONGS,\n\tSET_FILTERED_USER_SONGS,\n\tUPDATE_SONG,\n\tREPLACE_SONG,\n\tGET_USER_SONGS,\n\tGET_PUBLIC_SONGS,\n\tSET_VIEWS,\n\tINCREMENT_VIEW,\n} from \"../actions/songsActions\";\nimport { sortSongsById } from \"../../util\";\n\nconst initialStore = {\n\tuserSongs: null,\n\tpublicSongs: null,\n\tfilteredUserSongs: null,\n\tfilteredPublicSongs: null,\n\tviews: null,\n};\n\nfunction store(store = initialStore, action) {\n\tconst sortByViews = (views, list) => {\n\t\tif (views) {\n\t\t\tlist.sort((a, b) => views[a.id] < views[b.id]);\n\t\t}\n\t};\n\n\tif (action.type === GET_USER_SONGS) {\n\t\treturn {\n\t\t\t...store,\n\t\t\tuserSongs: action.userSongs,\n\t\t\tfilteredUserSongs: action.userSongs,\n\t\t};\n\t} else if (action.type === GET_PUBLIC_SONGS) {\n\t\treturn {\n\t\t\t...store,\n\t\t\tpublicSongs: action.publicSongs,\n\t\t\tfilteredPublicSongs: action.publicSongs,\n\t\t};\n\t} else if (action.type === ADD_SONG) {\n\t\tconst userSongs = store.userSongs.concat(action.song); // Concat leaves original array untouched, respecting Redux's immutability requirement\n\t\tconst filteredUserSongs = store.filteredUserSongs.concat(action.song);\n\t\tsortSongsById(userSongs);\n\t\tsortSongsById(filteredUserSongs);\n\n\t\treturn {\n\t\t\t...store,\n\t\t\tuserSongs: userSongs,\n\t\t\tfilteredUserSongs: filteredUserSongs,\n\t\t};\n\t} else if (action.type === DELETE_SONG) {\n\t\treturn {\n\t\t\t...store,\n\t\t\tuserSongs: store.userSongs.filter((song) => song.id !== action.id),\n\t\t\tpublicSongs: store.publicSongs.filter(\n\t\t\t\t(song) => song.id !== action.id\n\t\t\t),\n\t\t\tfilteredUserSongs: store.filteredUserSongs.filter(\n\t\t\t\t(song) => song.id !== action.id\n\t\t\t),\n\t\t\tfilteredPublicSongs: store.filteredPublicSongs.filter(\n\t\t\t\t(song) => song.id !== action.id\n\t\t\t),\n\t\t};\n\t} else if (action.type === UPDATE_SONG) {\n\t\tconst updatedSong = {\n\t\t\t...store.userSongs.find((song) => song.id === action.id),\n\t\t\t[action.updateType]: action.value,\n\t\t};\n\t\tif (!updatedSong) {\n\t\t\treturn store;\n\t\t}\n\n\t\tconst updatedUserSongs = store.userSongs\n\t\t\t.filter((song) => song.id !== action.id)\n\t\t\t.concat(updatedSong);\n\t\tconst updatedFilteredUserSongs = store.filteredUserSongs\n\t\t\t.filter((song) => song.id !== action.id)\n\t\t\t.concat(updatedSong);\n\t\tsortSongsById(updatedUserSongs);\n\t\tsortSongsById(updatedFilteredUserSongs);\n\n\t\tconst updatedPublicSongs = store.publicSongs.filter(\n\t\t\t(song) => song.id !== action.id\n\t\t);\n\t\tconst updatedFilteredPublicSongs = store.filteredPublicSongs.filter(\n\t\t\t(song) => song.id !== action.id\n\t\t);\n\n\t\tif (updatedSong.public) {\n\t\t\tupdatedPublicSongs.push(updatedSong);\n\t\t\tupdatedFilteredPublicSongs.push(updatedSong);\n\n\t\t\tsortByViews(store.views, updatedPublicSongs);\n\t\t\tsortByViews(store.views, updatedFilteredPublicSongs);\n\t\t}\n\n\t\treturn {\n\t\t\t...store,\n\t\t\tuserSongs: updatedUserSongs,\n\t\t\tpublicSongs: updatedPublicSongs,\n\t\t\tfilteredUserSongs: updatedFilteredUserSongs,\n\t\t\tfilteredPublicSongs: updatedFilteredPublicSongs,\n\t\t};\n\t} else if (action.type === REPLACE_SONG) {\n\t\tconst updatedUserSongs = store.userSongs\n\t\t\t.filter((song) => song.id !== action.id)\n\t\t\t.concat(action.song);\n\t\tconst updatedFilteredUserSongs = store.filteredUserSongs\n\t\t\t.filter((song) => song.id !== action.id)\n\t\t\t.concat(action.song);\n\t\tsortSongsById(updatedUserSongs);\n\t\tsortSongsById(updatedFilteredUserSongs);\n\n\t\tconst updatedPublicSongs = store.publicSongs.filter(\n\t\t\t(song) => song.id !== action.id\n\t\t);\n\t\tconst updatedFilteredPublicSongs = store.filteredPublicSongs.filter(\n\t\t\t(song) => song.id !== action.id\n\t\t);\n\n\t\tif (action.song.public) {\n\t\t\tupdatedPublicSongs.push(action.song);\n\t\t\tupdatedFilteredPublicSongs.push(action.song);\n\n\t\t\tsortByViews(store.views, updatedPublicSongs);\n\t\t\tsortByViews(store.views, updatedFilteredPublicSongs);\n\t\t}\n\n\t\treturn {\n\t\t\t...store,\n\t\t\tuserSongs: updatedUserSongs,\n\t\t\tpublicSongs: updatedPublicSongs,\n\t\t\tfilteredUserSongs: updatedFilteredUserSongs,\n\t\t\tfilteredPublicSongs: updatedFilteredPublicSongs,\n\t\t};\n\t} else if (action.type === SET_FILTERED_PUBLIC_SONGS) {\n\t\tif (action.songs === \"reset\") {\n\t\t\treturn {\n\t\t\t\t...store,\n\t\t\t\tfilteredPublicSongs: store.publicSongs,\n\t\t\t};\n\t\t}\n\t\tconst sortedSongs = [...action.songs];\n\t\tsortByViews(store.views, sortedSongs);\n\t\treturn {\n\t\t\t...store,\n\t\t\tfilteredPublicSongs: sortedSongs,\n\t\t};\n\t} else if (action.type === SET_FILTERED_USER_SONGS) {\n\t\tif (action.songs === \"reset\") {\n\t\t\treturn {\n\t\t\t\t...store,\n\t\t\t\tfilteredUserSongs: store.userSongs,\n\t\t\t};\n\t\t}\n\t\treturn {\n\t\t\t...store,\n\t\t\tfilteredUserSongs: action.songs,\n\t\t};\n\t} else if (action.type === SET_VIEWS) {\n\t\tconst sortedSongs = [...store.publicSongs];\n\t\tconst sortedFilteredSongs = [...store.filteredPublicSongs];\n\t\tsortByViews(action.views, sortedSongs);\n\t\tsortByViews(action.views, sortedFilteredSongs);\n\n\t\treturn {\n\t\t\t...store,\n\t\t\tviews: action.views,\n\t\t\tpublicSongs: sortedSongs,\n\t\t\tfilteredPublicSongs: sortedFilteredSongs,\n\t\t};\n\t} else if (action.type === INCREMENT_VIEW) {\n\t\tif (store.views) {\n\t\t\tconst newViews = {\n\t\t\t\t...store.views,\n\t\t\t\t[action.id]:\n\t\t\t\t\tstore.views[action.id] !== undefined\n\t\t\t\t\t\t? store.views[action.id] + 1\n\t\t\t\t\t\t: 0,\n\t\t\t};\n\t\t\tconst newPublicSongs = [...store.publicSongs];\n\t\t\tconst newFilteredPublicSongs = [...store.filteredPublicSongs];\n\t\t\tsortByViews(newViews, newPublicSongs);\n\t\t\tsortByViews(newViews, newFilteredPublicSongs);\n\n\t\t\treturn {\n\t\t\t\t...store,\n\t\t\t\tviews: newViews,\n\t\t\t\tpublicSongs: newPublicSongs,\n\t\t\t\tfilteredPublicSongs: newFilteredPublicSongs,\n\t\t\t};\n\t\t} else {\n\t\t\treturn store;\n\t\t}\n\t} else {\n\t\treturn store;\n\t}\n}\n\nexport default store;\n","import {\n\tSET_FETCHING,\n\tSET_IS_SONG_PAGE,\n\tSET_IS_SONG_PAGE_VIEW,\n\tSET_SONG_LINK,\n} from \"../actions/selectedSongActions\";\n\nconst initialStore = {\n\tisFetching: false,\n\tisSongPage: false,\n\tisSongPageView: false,\n\tsongLink: null,\n};\n\nexport default function store(store = initialStore, action) {\n\tswitch (action.type) {\n\t\tcase SET_FETCHING:\n\t\t\treturn {\n\t\t\t\t...store,\n\t\t\t\tisFetching: action.value,\n\t\t\t};\n\t\tcase SET_IS_SONG_PAGE:\n\t\t\treturn {\n\t\t\t\t...store,\n\t\t\t\tisSongPage: action.value,\n\t\t\t};\n\t\tcase SET_IS_SONG_PAGE_VIEW:\n\t\t\treturn {\n\t\t\t\t...store,\n\t\t\t\tisSongPageView: action.value,\n\t\t\t};\n\t\tcase SET_SONG_LINK:\n\t\t\treturn {\n\t\t\t\t...store,\n\t\t\t\tsongLink: action.link,\n\t\t\t};\n\t\tdefault:\n\t\t\treturn store;\n\t}\n}\n","import { SET_ADMIN, SET_USERNAME } from \"../actions/authActions\";\n\nconst initialStore = {\n\tusername: null,\n\tadmin: null,\n};\n\nexport default function reducer(state = initialStore, action) {\n\tswitch (action.type) {\n\t\tcase SET_USERNAME:\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tusername: action.username,\n\t\t\t}\n\t\tcase SET_ADMIN:\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tadmin: action.admin,\n\t\t\t}\n\t\tdefault:\n\t\t\treturn state;\n\t}\n}\n","import {\n\tADD_COMMENTS,\n\tDELETE_COMMENT,\n\tEDIT_COMMENT,\n} from \"../actions/commentActions\";\n\nconst initialStore = {\n\tcomments: null,\n\tflatComments: null,\n};\n\n// Turns flat structure into tree with children property that can be recursively traversed\n// Deep copies the original flatList\nconst nestComments = (commentListOriginal) => {\n\tconst commentMap = {};\n\tconst commentList = [];\n\tfor (const comment of commentListOriginal) {\n\t\tcommentList.push({ ...comment });\n\t}\n\n\tcommentList.forEach((comment) => (commentMap[comment.id] = comment));\n\n\tcommentList.forEach((comment) => {\n\t\tif (comment.parent !== null) {\n\t\t\tconst parent = commentMap[comment.parent];\n\t\t\t(parent.children = parent.children || []).push(comment);\n\t\t}\n\t}); // Each comment will be placed in the children block of its parent\n\tconst filtered = commentList.filter((comment) => {\n\t\t// Only parentless comments are left at top\n\t\treturn comment.parent === null;\n\t});\n\treturn filtered;\n};\n\n// Delete comment and all its children\n// Look for all comments with parent rootId, add those ids to the queue, and repeat\n// Filter function leaves original array untouched\nconst deleteHelper = (flatList, rootId) => {\n\tconst q = [rootId];\n\tconst toRemove = [rootId];\n\twhile (q.length) {\n\t\tconst id = q.pop();\n\t\tfor (const comment of flatList) {\n\t\t\tif (comment.parent === id) {\n\t\t\t\tq.push(comment.id);\n\t\t\t\ttoRemove.push(comment.id);\n\t\t\t}\n\t\t}\n\t}\n\treturn flatList.filter((comment) => toRemove.indexOf(comment.id) === -1);\n};\n\nexport default function reducer(store = initialStore, action) {\n\tconst songId = action.songId;\n\tswitch (action.type) {\n\t\tcase ADD_COMMENTS:\n\t\t\tif (!store.flatComments) {\n\t\t\t\t// Store is uninitialized\n\t\t\t\treturn {\n\t\t\t\t\tflatComments: {\n\t\t\t\t\t\t[songId]: action.comments,\n\t\t\t\t\t},\n\t\t\t\t\tcomments: {\n\t\t\t\t\t\t[songId]: nestComments(action.comments),\n\t\t\t\t\t},\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\tif (!store.flatComments[songId]) {\n\t\t\t\t\t// Store is initialized, but no comments yet for songId\n\t\t\t\t\t// Is not part of store\n\t\t\t\t\treturn {\n\t\t\t\t\t\t...store,\n\t\t\t\t\t\tflatComments: {\n\t\t\t\t\t\t\t...store.flatComments,\n\t\t\t\t\t\t\t[songId]: action.comments,\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcomments: {\n\t\t\t\t\t\t\t...store.comments,\n\t\t\t\t\t\t\t[songId]: nestComments(action.comments),\n\t\t\t\t\t\t},\n\t\t\t\t\t};\n\t\t\t\t} else {\n\t\t\t\t\tconst flatComments = {\n\t\t\t\t\t\t...store.flatComments,\n\t\t\t\t\t\t[songId]: [\n\t\t\t\t\t\t\t...store.flatComments[songId],\n\t\t\t\t\t\t\t...action.comments,\n\t\t\t\t\t\t],\n\t\t\t\t\t};\n\n\t\t\t\t\tconst comments = {\n\t\t\t\t\t\t...store.comments,\n\t\t\t\t\t\t[songId]: nestComments(flatComments[songId]),\n\t\t\t\t\t};\n\t\t\t\t\treturn {\n\t\t\t\t\t\t...store,\n\t\t\t\t\t\tflatComments: flatComments,\n\t\t\t\t\t\tcomments: comments,\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\tcase DELETE_COMMENT:\n\t\t\tconst filteredFlatComments = {\n\t\t\t\t...store.flatComments,\n\t\t\t\t[songId]: deleteHelper(store.flatComments[songId], action.id),\n\t\t\t};\n\n\t\t\tconst filteredComments = {\n\t\t\t\t...store.comments,\n\t\t\t\t[songId]: nestComments(filteredFlatComments[songId]),\n\t\t\t};\n\n\t\t\treturn {\n\t\t\t\t...store,\n\t\t\t\tflatComments: filteredFlatComments,\n\t\t\t\tcomments: filteredComments,\n\t\t\t};\n\t\tcase EDIT_COMMENT:\n\t\t\tconst current = store.flatComments[songId].find(\n\t\t\t\t(comment) => comment.id === action.id\n\t\t\t);\n\t\t\tconst newComment = { // Get new comment with edited contents\n\t\t\t\t...current,\n\t\t\t\tcontents: action.contents,\n\t\t\t\tdate_of_creation: action.time,\n\t\t\t\tedited: true,\n\t\t\t};\n\n\t\t\t// Filter original list and add new comment\n\t\t\tconst list = store.flatComments[songId].filter(\n\t\t\t\t(comment) => comment.id !== action.id\n\t\t\t);\n\t\t\tlist.push(newComment);\n\t\t\tconst newFlatComments = {\n\t\t\t\t...store.flatComments,\n\t\t\t\t[songId]: list,\n\t\t\t};\n\t\t\tconst newComments = {\n\t\t\t\t...store.comments,\n\t\t\t\t[songId]: nestComments(list),\n\t\t\t};\n\n\t\t\treturn {\n\t\t\t\t...store,\n\t\t\t\tflatComments: newFlatComments,\n\t\t\t\tcomments: newComments,\n\t\t\t};\n\t\tdefault:\n\t\t\treturn store;\n\t}\n}\n","import { createStore, combineReducers, applyMiddleware } from \"redux\";\nimport thunk from \"redux-thunk\";\nimport storage from \"redux-persist/lib/storage\";\nimport { persistStore, persistReducer } from \"redux-persist\";\nimport autoMergeLevel1 from \"redux-persist/es/stateReconciler/autoMergeLevel1\";\n\nimport songsReducer from \"./reducers/songsReducer\";\nimport selectedSongReducer from \"./reducers/selectedSongReducer\";\nimport authReducer from \"./reducers/authReducer\";\nimport commentReducers from \"./reducers/commentReducers\";\n\nconst rootReducer = combineReducers({\n\tsongs: songsReducer,\n\tselectedSong: selectedSongReducer,\n\tauth: authReducer,\n\tcomments: commentReducers,\n});\n\nconst persistConfig = {\n\tkey: \"root\",\n\tstorage: storage,\n\tstateReconciler: autoMergeLevel1,\n\tblacklist: [\"songs\", \"comments\"],\n};\n\nconst pReducer = persistReducer(persistConfig, rootReducer);\n\nexport const store = createStore(pReducer, applyMiddleware(thunk));\nexport const persistor = persistStore(store);\n\n// export default store;\n","import React, { useState } from \"react\";\nimport { IconContext } from \"react-icons\";\nimport { PersistGate } from \"redux-persist/integration/react\";\nimport { Provider } from \"react-redux\";\nimport { HashRouter } from \"react-router-dom\";\n\nimport { Colors } from \"./constants/Colors\";\nimport LoadingCircle from \"./components/LoadingCircle/LoadingCircle\";\nimport Router from \"./components/Router/Router\";\nimport { persistor, store } from \"./store/store\";\n\nexport default function App() {\n\t// Orientation state\n\tconst [orientation, setOrientation] = useState(\n\t\twindow.matchMedia(\"(orientation: landscape)\").matches\n\t);\n\n\t// Listen to changes in orientation\n\twindow\n\t\t.matchMedia(\"(orientation: landscape)\")\n\t\t.addEventListener(\"change\", () => {\n\t\t\tsetOrientation(\n\t\t\t\twindow.matchMedia(\"(orientation: landscape)\").matches\n\t\t\t);\n\t\t});\n\n\tconst iconSize = Math.min(window.screen.width, window.screen.height) * 0.02;\n\n\tconst iconValues = {\n\t\tcolor: Colors.primary,\n\t\tsize: iconSize,\n\t\tstyle: {\n\t\t\tcursor: \"pointer\",\n\t\t},\n\t};\n\n\treturn (\n\t\t// Redux provider\n\t\t<Provider store={store}>\n\t\t\t{/* Redux persistor  */}\n\t\t\t<PersistGate persistor={persistor} loading={<LoadingCircle />}>\n\t\t\t\t{/* Redux router  */}\n\t\t\t\t<HashRouter>\n\t\t\t\t\t{/* Default icon values  */}\n\t\t\t\t\t<IconContext.Provider value={iconValues}>\n\t\t\t\t\t\t{orientation ? <Router horizontal /> : <Router />}\n\t\t\t\t\t</IconContext.Provider>\n\t\t\t\t</HashRouter>\n\t\t\t</PersistGate>\n\t\t</Provider>\n\t);\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"link-horizontal\":\"NavContent_link-horizontal__6PlLg\",\"link-vertical\":\"NavContent_link-vertical__1Gu7b\",\"container\":\"NavContent_container__3CUXL\",\"container-horizontal\":\"NavContent_container-horizontal__2_D8Q\",\"container-vertical\":\"NavContent_container-vertical__oovCS\",\"left-div\":\"NavContent_left-div__n8LtB\",\"left-div-horizontal\":\"NavContent_left-div-horizontal__2Mzej\",\"left-div-vertical\":\"NavContent_left-div-vertical__brZyj\",\"login-row\":\"NavContent_login-row__1rSzI\",\"login-column\":\"NavContent_login-column__1YpZj\",\"view\":\"NavContent_view__E5e6L\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"arrow\":\"SongBlock_arrow__OZq3H\",\"artist\":\"SongBlock_artist__268cz\",\"button-container\":\"SongBlock_button-container__2i7UG\",\"creator\":\"SongBlock_creator__1Bd_c\",\"creator-name\":\"SongBlock_creator-name__3DABZ\",\"eye\":\"SongBlock_eye__3Gc2b\",\"image-container\":\"SongBlock_image-container__11f-t\",\"name\":\"SongBlock_name__2NW_f\",\"song-container\":\"SongBlock_song-container__356On\",\"views\":\"SongBlock_views__gRMen\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"button-container\":\"Auth_button-container__1rgxm\",\"field\":\"Auth_field__3jxUi\",\"label\":\"Auth_label__1Ho8t\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"nav-bar-link\":\"ui_nav-bar-link__WZfHC\",\"nav-bar-hover\":\"ui_nav-bar-hover__172Zv\",\"title\":\"ui_title__3IFjf\",\"song-subtitle\":\"ui_song-subtitle__17slJ\",\"subtitle\":\"ui_subtitle__1GEJE\",\"plain-h2\":\"ui_plain-h2__19n4Q\",\"plain-h3\":\"ui_plain-h3__2nQ6f\",\"plain-h4\":\"ui_plain-h4__3Hp8N\",\"small-text\":\"ui_small-text__3MIn_\",\"dashed-input\":\"ui_dashed-input__N3bem\",\"purple-input\":\"ui_purple-input__2sQ0c\",\"sidebar-container\":\"ui_sidebar-container__1YC0I\",\"sidebar-icon\":\"ui_sidebar-icon__3C57-\",\"sidebar-text\":\"ui_sidebar-text__2VZBa\",\"pointer\":\"ui_pointer__9i5FT\",\"emphasis\":\"ui_emphasis__2mJqj\",\"italic\":\"ui_italic__Wsqb1\",\"white-space\":\"ui_white-space__2gTcx\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"children\":\"CommentsBlock_children__3m1ip\",\"grow\":\"CommentsBlock_grow__2-Ij0\",\"outer-container\":\"CommentsBlock_outer-container__3a5On\",\"container\":\"CommentsBlock_container__2C-Vm\",\"horizontal-container\":\"CommentsBlock_horizontal-container__2-Lve\",\"trash\":\"CommentsBlock_trash__g9llf\",\"reply-container\":\"CommentsBlock_reply-container__2CrD2\",\"username\":\"CommentsBlock_username__1bl8o\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"border\":\"Help_border__1Jaje\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"picture\":\"Profile_picture__1ObJj\",\"menu-button\":\"Profile_menu-button__2jS5w\",\"menu-button-active\":\"Profile_menu-button-active__2B7Fw\",\"file-upload\":\"Profile_file-upload__sWBr2\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"option\":\"DropMenu_option__3yem8\",\"hover\":\"DropMenu_hover__jp3S7\",\"white-option\":\"DropMenu_white-option__3bqmw\",\"dropdown-option\":\"DropMenu_dropdown-option__2FQv1\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"text\":\"PasswordChange_text__3XDge\",\"button\":\"PasswordChange_button__2mRpy\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"lyric-line\":\"LyricsBlock_lyric-line__2PssJ\",\"toolbar\":\"LyricsBlock_toolbar__1qeRJ\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"LogoutButton_container__2eBWo\",\"name\":\"LogoutButton_name__2u8ZK\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"MenuBar_container__EYpdn\",\"image\":\"MenuBar_image__bljwB\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"text\":\"PasswordReset_text__2u7J4\",\"button\":\"PasswordReset_button__1MWdJ\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"NewComment_container__17Brb\",\"heading\":\"NewComment_heading__3mJxf\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"btn\":\"ButtonStyle_btn__T6xn3\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"input\":\"SearchBar_input__35An9\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"text\":\"CapitalText_text__2p702\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"input\":\"TextArea_input__1PU5S\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"text\":\"InfoBar_text__ZHoJV\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"artist\":\"Song_artist__3jwwy\"};"],"sourceRoot":""}